<?xml version="1.0" encoding="UTF-8"?>
<rss
    xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"


>
    <channel>
        <title>
            <![CDATA[開源中國-軟件更新資訊]]>
        </title>
        <link>https://www.oschina.net/news/project</link>
        <atom:link href="http://rsshub.app/oschina/news/project" rel="self" type="application/rss+xml" />
        <description>
            <![CDATA[開源中國-軟件更新資訊 - Made with love by RSSHub(https://github.com/DIYgod/RSSHub)]]>
        </description>
        <generator>RSSHub</generator>
        <webMaster>i@diygod.me (DIYgod)</webMaster>
        <language>zh-cn</language>
        <lastBuildDate>Tue, 12 Mar 2024 13:40:00 GMT</lastBuildDate>
        <ttl>120</ttl>
        <item>
            <title>
                <![CDATA[酷瓜雲課堂（內網版）v1.1.2 發佈，局域網在線教育平台]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p><img alt="酷瓜雲課堂-局域網學習平台" src="https://portal-1255691183.file.myqcloud.com/img/content/624528cd8be23.png" referrerpolicy="no-referrer"></p><h3>更新內容</h3><ul><li>增加彈幕管理</li><li>增加圖文背景水印</li><li>增加內容審核開關</li><li>單元測評增加題型過濾</li><li>增加 post 方式傳遞 csrf_token</li><li>Response 增加 unauthorized() 返回</li><li>刪除 chapter 中 resource_count,consult_count 屬性</li><li>刪除 resource 表 chapter_id 屬性</li><li>刪除 Article 中多餘的 settings 屬性</li><li>重新統計 course 中 resource_count</li><li>修正 home 模塊編輯器圖片上傳</li><li>修正直播回放獲取播放地址參數問題</li><li>圖文和文章增加 markdown 支持</li><li>精簡 CsrfToken 白名單</li><li>拆解優化創建表腳本</li><li>優化 Storage.php</li></ul><h3>系統介紹</h3><p>酷瓜雲課堂內網版，採用 C 擴展框架 Phalcon 開發，使用本地基礎服務，無營銷相關功能，主要適用於公司、集團、機關、學校等內部網絡環境使用。</p><h3>系統功能</h3><p>實現了點播、直播、專欄、問答、積分等。</p><p>友情提示：</p><ul><li>演示系統配置低，帶寬有限，切莫壓測</li><li>課程數據來源於網絡（無實質內容）</li><li>管理後台已禁止數據提交，私密配置已過濾</li></ul><p>系統演示：</p><ul><li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Flan-edu.koogua.com" target="_blank">前台演示</a></li><li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Flan-edu.koogua.com%2Fadmin" target="_blank">後台演示</a></li></ul><p>演示賬號：100015@163.com / 123456 （前後台通用）</p><h3>項目組件</h3><ul><li>後台框架：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fphalcon.io" target="_blank">phalcon 3.4.5</a></li><li>前端框架：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Flayui.dev" target="_blank">layui 2.9.3</a></li><li>全文檢索：<a href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fwww.xunsearch.com" target="_blank">xunsearch 1.4.9</a></li><li>基礎依賴：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fphp.net" target="_blank">php7.3</a>， <a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fmysql.com" target="_blank">mysql5.7</a>， <a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fredis.io" target="_blank">redis5.0</a></li></ul><h3>項目文檔</h3><ul><li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.koogua.com%2Fpage%2Fwiki" target="_blank">運行環境搭建</a></li><li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.koogua.com%2Fpage%2Fwiki" target="_blank">系統服務配置</a></li><li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.koogua.com%2Fpage%2Fwiki" target="_blank">客戶終端配置</a></li></ul><h3>產品試用</h3><p>申請地址：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.koogua.com%2Fpage%2Ftrial" target="_blank">點擊申請</a></p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 11:25:43 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282772</guid>
            <link>https://www.oschina.net/news/282772</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[PDManer [元數建模]-v4.9.2 發佈：一款簡單好用的數據庫建模平台]]>
            </title>
            <description>
                <![CDATA[<div class="content"><h1>特別説明</h1><hr><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fwww.pdmaas.cn" target="_blank"><strong>平台公雲版及企業私雲版已經發布，增加多人團隊協作支持，點擊這裏瞭解</strong></a></p><hr><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>[PDManer 元數建模 - v4]</strong>，歷時五年，持續升級，工匠精神，做一款簡單好用的數據庫建模平台。</p><blockquote><p style="margin-left:0; margin-right:0">元數建模平台，使用 React+Electron+Java 技術體系構建。</p></blockquote><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">[PDMan-v2] --&gt; [CHINER-v3] --&gt; [PDManer-v4]，連續五年，一直保持很好的傳承和延續。</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">PDManer 元數建模軟件 (v4 版本）介紹：<a href="https://my.oschina.net/skymozn/blog/5515012">PDManer [元數建模]-v4.0.0 發佈：一款簡單好用的數據庫建模平台</a></p><h1>4.9.2 版本升級內容清單</h1><hr><ul><li>1.[新增功能] 新增數據庫設計規範檢查功能</li><li>2.[缺陷修復] 修復關係圖某些場景下無法搜索的問題</li><li>3.[缺陷修復] 修復修改數據域後數據類型沒有更新的問題</li><li>4.[缺陷修復] 修復創建視圖時選擇數據表時搜索失效的問題</li></ul><h2>此前 4.9.1 升級內容</h2><ul><li><ol><li>[新增功能] 物理表設計擴展字段增加多種格式支持，如下拉框，數字框，單選等</li></ol></li><li><ol><li>[缺陷修復] 修正 ORACLE 數據庫通過 all_tables 讀取數據庫元數據信息</li></ol></li><li><ol><li>[新增功能] DM (達夢）數據庫通過 all_tables 讀取數據庫元數據信息</li></ol></li><li><ol><li>[新增功能] DB2 數據庫通過 sysibm.systables 讀取數據庫元數據信息</li></ol></li><li><ol><li>[新增功能] 瀚高數據庫支持，增加 DDL 以及通過 pg_tables 讀取元數據</li></ol></li><li><ol><li>[缺陷修復] 修正 MySQL，Oracle，SQLServer，PosgreSQL，DB2，達夢，瀚高等數據庫的自增數據類型模板</li></ol></li></ul><hr><h1>新功能説明</h1><h2>1. 數據庫設計規範檢查</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">規範配置：<br><img alt="" src="https://oscimg.oschina.net/oscnet/up-dec7b1efb26e135d58e7bb409a95cff7506.png" referrerpolicy="no-referrer"><br> 規範檢查:<br><img alt="" src="https://oscimg.oschina.net/oscnet/up-4fd7d3924d0edb640d57543acbe3e89fbd5.png" referrerpolicy="no-referrer"></p><h1>源代碼 &amp; 下載</h1><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">我們將長期持續維護 PDManer 元數建模的升級，並及時採納合理的用戶建議。</p><ul><li>開源免費客戶端版本，下載安裝:<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fwww.pdmaner.com%2Fdownload%2Fv4.9.2" target="_blank">安裝文件下載</a></li><li><a href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fwww.pdmaas.cn" target="_blank">平台公雲版及企業私雲版，點擊這裏瞭解</a></li><li>軟件下載鏈接：<a href="https://gitee.com/robergroup/pdmaner/releases">Gitee 發行版</a></li><li>[源代碼 - 客戶端] 託管於碼雲 Gitee，(<a href="https://gitee.com/robergroup/pdmaner">https://gitee.com/robergroup/pdmaner</a>)</li><li>[源代碼 - Java 端] 託管於碼雲 Gitee，(<a href="https://gitee.com/robergroup/chiner-java">https://gitee.com/robergroup/chiner-java</a>)</li></ul><h1>社區用戶 - 特別價值貢獻 (語雀文檔)</h1><ul><li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.yuque.com%2Fpdmaner%2Fdocs%2Fpdmaner-manual" target="_blank">PDManer 元數建模 - v4 - 操作手冊</a></li></ul><h1>歷史版本發佈日誌</h1><h2>v4.9 版本 (2024 年)</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">01-27，<a href="https://www.oschina.net/news/276757">PDManer [元數建模]-v4.9.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v4.8 版 (2024 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">01-17，<a href="https://www.oschina.net/news/275971">PDManer [元數建模]-v4.8.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v4.7 版 (2023 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">11-26，<a href="https://my.oschina.net/skymozn/blog/10260837">PDManer [元數建模]-v4.7.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v4.6 版 (2023 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">08-20，<a href="https://www.oschina.net/news/254560/pdmaner-4-6-3-released">PDManer [元數建模]-v4.6.3 發佈：一款簡單好用的數據庫建模平台</a><br> 07-23，<a href="https://www.oschina.net/news/250521/pdmaner-4-6-2-release">PDManer [元數建模]-v4.6.1 發佈：一款簡單好用的數據庫建模平台</a><br> 07-17，<span>&nbsp;</span><a href="https://gitee.com/robergroup/pdmaner/releases/tag/v4.6.1">PDManer [元數建模]-v4.6.1 發佈：一款簡單好用的數據庫建模平台</a><br> 06-05，<a href="https://my.oschina.net/skymozn/blog/9868228">PDManer [元數建模]-v4.6.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v4.5 版 (2023 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">03-27，<a href="https://my.oschina.net/skymozn/blog/8590982">PDManer [元數建模]-v4.5.1 發佈：一款簡單好用的數據庫建模平台</a><span>&nbsp;</span>03-19，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/8582726">PDManer [元數建模]-v4.5.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v4.3 版 (2023 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">02-25，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/8240850">PDManer [元數建模]-v4.4.0 發佈：一款簡單好用的數據庫建模平台</a><br> 01-07，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5930631">PDManer [元數建模]-v4.3.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v4.0 版 (2022 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">11-27，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5599770">PDManer [元數建模]-v4.2.2 發佈：一款簡單好用的數據庫建模平台</a><br> 10-15，<span>&nbsp;</span><a href="https://www.oschina.net/news/213704/pdmaner-4-2-0-released">PDManer [元數建模]-v4.2.0 發佈：一款簡單好用的數據庫建模平台</a><br> 09-17，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5578581">PDManer [元數建模]-v4.1.5 發佈：一款簡單好用的數據庫建模平台</a><br> 08-16，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5565965">PDManer [元數建模]-v4.1.4 發佈：一款簡單好用的數據庫建模平台</a><br> 08-16，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5565965">PDManer [元數建模]-v4.1.4 發佈：一款簡單好用的數據庫建模平台</a><br> 07-17，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5555061">PDManer [元數建模]-v4.1.3 發佈：一款簡單好用的數據庫建模平台</a><br> 05-17，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5526958">PDManer [元數建模]-v4.1.1 發佈：一款簡單好用的數據庫建模平台</a><br> 05-09，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5523590">PDManer [元數建模]-v4.1.0 發佈：一款簡單好用的數據庫建模平台</a><br> 04-17，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5515012">PDManer [元數建模]-v4.0.0 發佈：一款簡單好用的數據庫建模平台</a></p><h2>v3.5 版 (2021 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">12-12，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5358921">CHINER [元數建模]-v3.5.7 發佈：最好用的國產開源數據庫建模平台</a><br> 11-27，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5329462">CHINER [元數建模]-v3.5.6 發佈：最好用的國產開源數據庫建模平台</a><br> 11-07，<span>&nbsp;</span><a href="https://my.oschina.net/skymozn/blog/5300548">CHINER [元數建模]-v3.5.5 發佈：最好用的國產開源數據庫建模平台</a><br> 10-31，<a href="https://my.oschina.net/skymozn/blog/5292026">CHINER [元數建模]-v3.5.4 發佈：最好用的國產開源數據庫建模平台</a><br> 10-24，<a href="https://my.oschina.net/skymozn/blog/5286281">CHINER [元數建模]-v3.5.3 發佈：最好用的國產開源數據庫建模平台</a><br> 10-17，<a href="https://my.oschina.net/skymozn/blog/5281261">CHINER [元數建模]-v3.5.2 發佈：最好用的國產開源數據庫建模平台</a><br> 10-06，<a href="https://my.oschina.net/skymozn/blog/5274141">CHINER [元數建模]- 國慶版 - 補丁修正版 v3.5.1：最好用的國產開源數據庫建模平台</a><br> 09-30，<a href="https://my.oschina.net/skymozn/blog/5272352">CHINER [元數建模]- 國慶版發佈 - 升級至 v3.5.0：最好用的國產開源數據庫建模平台</a></p><h2>v3.3 版 (2021 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">9 月 15 日，<a href="https://my.oschina.net/skymozn/blog/5262033">CHINER [元數建模] 升級至 v3.3.0：最好用的國產開源數據庫建模平台</a></p><h2>v3.2 版 (2021 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">8 月 22 日，<a href="https://my.oschina.net/skymozn/blog/5196704">PDMan 的最新版 - CHINER [元數建模] 升級至 v3.2：最好用的國產開源數據庫建模平台</a><br> 9 月 07 日，<a href="https://my.oschina.net/skymozn/blog/5236977">PDMan 的最新版 - CHINER [元數建模] 升級至 v3.2.1：最好用的國產開源數據庫建模平台</a></p><h2>v3.1 版 (2021 年):</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">8 月 8 日，<a href="https://my.oschina.net/skymozn/blog/5170023">PDMan 的最新版 - CHINER [元數建模] 升級至 v3.1：最好用的國產開源數據庫建模平台</a></p><h2>v3.0 版 (2021 年)：</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">7 月 17 日，<a href="https://my.oschina.net/skymozn/blog/5134881">PDMan 升級換代至 -&gt;CHINER [元數建模] v3.0：最好用的國產開源數據庫建模平台</a></p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 09:41:23 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282753/pdmaner-4-9-2-released</guid>
            <link>https://www.oschina.net/news/282753/pdmaner-4-9-2-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[Redisson 3.27.2 發佈，官方推薦的 Redis 客戶端]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p>Redisson 3.27.2&nbsp;現已發佈，這是一個 Java 編寫的 Redis 客戶端，具備駐內存數據網格（In-Memory Data Grid）功能，並獲得了 Redis 的官方推薦。</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">此版本更新內容如下：</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong style="color:#333333"><span style="background-color:#ffffff; color:#1f2328">Feature</span></strong></p><ul><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">實現了 RShardedTopic.countSubscribers() 方法</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">RedissonMultiLock 實現了 isHeldByThread() 和 isHeldByCurrentThread() 方法</span></li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong style="color:#333333"><span style="background-color:#ffffff; color:#1f2328">Fixed</span></strong></p><ul><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">多次鎖定 RLock 會將 remainTimeToLive 重置為配置默認值</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">日誌中未顯示 natMapper 引發的異常</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">OSGi jdk.net 包導入應為可選項</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">ServiceManager.resolveAll() 方法拋出 NPE</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">RObject.addListenerAsync() 方法引發 UnsupportedOperationException</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">StatusListener 無法與 RShardedTopic 一起工作</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">如果添加了從節點，在集羣模式下會拋出 NPE</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">在集羣模式下持續重新連接已移除的從節點</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">刪除 TrackingListener 時的錯誤處理</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">FlushListener 接收重複事件</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">SlotsDecoder 在結果為空時拋出 NPE</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">RedissonCache 與 Spring (6.1+) 緩存接口方法之間的衝突</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">RedissonClient.shutdown() 方法在調用 serviceManager.getShutdownLatch() 時掛起</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">PingConnectionHandler 導致的「Failed to submit a listener notification task. Event loop shut down?」</span></li><li style="text-align:left"><span style="background-color:#ffffff; color:#1f2328">JsonCodecWrapper 未正確緩存</span></li></ul><p>更新説明：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fredisson%2Fredisson%2Freleases%2Ftag%2Fredisson-3.27.2" target="_blank">https://github.com/redisson/redisson/releases/tag/redisson-3.27.2</a></p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 08:01:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282729/redisson-3-27-2-released</guid>
            <link>https://www.oschina.net/news/282729/redisson-3-27-2-released</link>
            <author>
                <![CDATA[來源: OSCHINA]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[【店滴雲】增加關注公眾號登錄後台管理系統]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="text-align:center">【店滴雲】增加關注公眾號登錄後台管理系統</p><p><span style="background-color:#ffffff; color:#40485b">店滴雲，讓經營場所，更智能。圍繞茶室、酒店、健身房、公寓、出租房等經營性場所進行物聯網改造。同時支持多種物聯網通信協議，開放智能門鎖，智能開關，智能手環的 sdk 供開發者使用。</span></p><p>1、增加微信公眾號通過第三方平台生成二維碼，包括臨時和永久二維碼</p><p>2、增加掃碼綁定賬號和掃碼關注公眾號登錄系統功能</p><p>3、增加為微信公眾號中直接通過網頁授權登錄系統的功能</p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 07:51:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282726</guid>
            <link>https://www.oschina.net/news/282726</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[outline.js 3.33.0 已經發布，自動生成文章導讀導航]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p>outline.js 3.33.0 已經發布，自動生成文章導讀導航</p><p>此版本更新內容包括：</p><h3>Features</h3><ul><li>文章大綱導航的滾動條會隨文章正文滾動位置同步滾動，使大綱導航的當前章節始終可見；</li></ul><p>詳情查看：<a href="https://gitee.com/yaohaixiao/outline.js/releases/3.33.0">https://gitee.com/yaohaixiao/outline.js/releases/3.33.0</a></p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 06:09:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282698/outline-js-3-33-0-released</guid>
            <link>https://www.oschina.net/news/282698/outline-js-3-33-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[GNU Linux-libre 6.8 發佈]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p>在 <a href="https://www.oschina.net/news/282502/linux-kernel-6-8">Linux Kernel 6.8</a> 版本發佈後，自由軟件基金會的拉美團隊（FSFLA）照例跟進<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.fsfla.org%2Fikiwiki%2Fselibre%2Flinux-libre%2F%23news" target="_blank">發佈</a>了 GNU Linux-libre 6.8 內核。值得一提的是，上個月&nbsp;GNU Linux-libre 剛慶祝了項目誕生 16 週年。</p><p><img alt="" height="278" src="https://oscimg.oschina.net/oscnet/up-01f8bd4d6be86f550135c5e017c512d202c.png" width="500" referrerpolicy="no-referrer"></p><p>一些更新內容包括：</p><p><strong>Cleaning up changes</strong></p><ul><li>刪除了對 atmel、hermes、orinoco_usb、libertas_cs 和 zd1201 驅動程序的清理，因為它們已經在上游被移除。</li><li>清理了 Intel qat_420xx、Imagination PowerVR、Intel Xe、Chips and Media Wave5、Intel VSC、Aquantia PHY 和 Realtek rtw8922a 的新驅動程序。</li><li>coda 驅動程序移到了上游"source"樹中，因此對其清理工作進行了調整。</li><li>清理了 ARM 和 AArch64 devicetree 文件中的新 blob 名稱。</li><li>上游修改了 .deb 打包腳本，基於此修改進行了調整，並藉此機會改進了 wording。</li></ul><p><span style="color:#000000">此外，項目團隊還在嘗試修復 Intel i915 驅動程序的問題。</span></p><blockquote><p><span style="color:#000000">去年，我們瞭解到在某些 i915 硬件變體上出現了無限循環，因為它們試圖回退到我們已清理為難以區分的名稱的早期 blob 變體。</span></p><p><span style="color:#000000">我們修復了這一問題，甚至向上遊提供了補丁。 但我們的補丁並沒有被採納，而是針對我們的補丁做了其他修改，導致驅動程序在我們的情況下噪音更大。</span></p><p><span style="color:#000000">我們已經解決了額外噪音的問題，但這些上游更改並不是導致驅動程序再次損壞的原因。 我們仍然不知道是什麼原因造成的，但症狀與之前的故障類似：一些裝有英特爾顯卡的系統出現 freeze。</span></p><p><span style="color:#000000">使用 i915.enable_guc=0 啓動將避免受此問題影響的系統出現明顯的 freeze 現象。</span></p></blockquote><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fwww.fsfla.org%2Fikiwiki%2Fselibre%2Flinux-libre%2F" target="_blank">GNU Linux-libre</a>&nbsp;<span style="color:#000000">項目致力於為那些遵循自由軟件基金會的《GNU 自由操作系統發行版指南》（GNU Free System Distribution Guidelines）的人們提供上游 Linux 內核的 100% 自由版本。</span></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><span style="color:#000000">GNU Linux-libre 從 Linux 內核中刪除了那些不含源代碼、源代碼被混淆或遮蔽、使用非自由軟件許可證、不允許用戶修改軟件使其達到用戶要求、誘導或要求用戶安裝額外的非自由軟件的軟件。</span></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">更多詳情可查看<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.fsfla.org%2Fpipermail%2Flinux-libre%2F2024-March%2F003538.html" target="_blank">此處</a>。</p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 06:07:54 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282696/gnu-linux-libre-6-8-released</guid>
            <link>https://www.oschina.net/news/282696/gnu-linux-libre-6-8-released</link>
            <author>
                <![CDATA[來源: OSCHINA]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[OpenAPI Generator v7.4.0 發佈，OpenAPI 規範自動生成代碼]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p><span style="color:#333333"><span style="background-color:#ffffff"><span style="color:#333333"><span style="color:#0f1419"><span style="background-color:#ffffff">OpenAPI Generator v6.6.0 現已發佈，此</span></span></span></span><span style="background-color:#ffffff"><span style="color:#1f2328">版本包含了 90 多項增強功能和錯誤修復，以及 1 個</span></span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpulls%3Fq%3Dis%253Apr%2Bmilestone%253A7.4.0%2Bis%253Aclosed%2Blabel%253A%2522Breaking%2Bchange%2B%2528with%2Bfallback%2529%2522" target="_blank">&nbsp;breaking change (with fallback)</a>&nbsp;<span style="background-color:#ffffff"><span style="color:#333333"><span style="color:#0f1419"><span style="background-color:#ffffff">。</span></span></span></span><span style="background-color:#ffffff"><span style="color:#000000">OpenAPI Generator 可用於在給定 OpenAPI 規範（v2, v3）的情況下自動生成 API 客戶端庫、server stubs、文檔以及配置。</span></span></span></p><p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#1f2328">一些更新亮點如下：</span></p><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">General</span></span></strong></p><ul><li>當設置 inputSpecRootDirectory 時，inputSpec 不應該是強制性的&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F18000" target="_blank">#18000</a></li><li>修復 ClassCastException in OpenAPINormalizer on composed schemas&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17912" target="_blank">#17912</a></li><li>將 FILTER 添加到 openapi normalizer&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17859" target="_blank">#17859</a></li><li>修復 allOf 和 $ref 中的屬性&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17836" target="_blank">#17836</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">C</span></span></strong></p><ul><li>[C][Client] 修復默認枚舉值為 -1&nbsp;的問題&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F18040" target="_blank">#18040</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">C#</span></span></strong></p><ul><li>[C#] 修復 anyof、oneof mixed primitive object 解析錯誤&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17986" target="_blank">#17986</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">C++</span></span></strong></p><ul><li>[cpp-qt-client] 允許參數為空&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17805" target="_blank">#17805</a></li><li>防止枚舉項名稱成為保留關鍵字<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17804" target="_blank">#17804</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Dart</span></span></strong></p><ul><li>[Dart] 減少對 intl 包的依賴&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17862" target="_blank">#17862</a></li></ul><p style="text-align:start"><strong>Go</strong></p><ul><li>[Go] 修復 isNil 檢查&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17870" target="_blank">#17870</a></li><li>Generate API 文件作為 go-gin 服務器的接口&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17784" target="_blank">#17784</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Java</span></span></strong></p><ul><li>[java] 在提供的情況下用 modelNameMappings&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F18025" target="_blank">#18025</a></li><li>[Java][apache-httpclient] 使用 EntityUtils#toString 代替 Scanner 進行反序列化<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17998" target="_blank">#17998</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Jetbrains HTTP Client</span></span></strong></p><ul><li>Jetbrains HTTP Client 重大升級。移至測試版&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F15779" target="_blank">#15779</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Kotlin</span></span></strong></p><ul><li>[kotlin] 枚舉應該匹配規範&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F18062" target="_blank">#18062</a>&nbsp;- Breaking change (with fallback)</li><li>[kotlin-spring] 修復 API 中的 cookie 參數代碼生成&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17959" target="_blank">#17959</a></li><li>[kotlin-spring] 修復 BigDecimal 默認值編譯失敗的問題&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17956" target="_blank">#17956</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">PHP</span></span></strong></p><ul><li>fix(php)：更新 toString 方法中的類型提示<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17838" target="_blank">#17838</a></li><li>fix(php)：在 psr-18 實現中正確調用 selectHeaders&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17832" target="_blank">#17832</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Python</span></span></strong></p><ul><li>[python] 修復 inherited discriminators 上的&nbsp;Circular imports&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17886" target="_blank">#17886</a></li><li>將 python-fastapi 依賴項更新為新版本&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17871" target="_blank">#17871</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Ruby</span></span></strong></p><ul><li>fix(ruby)：使用 faraday 檢測表單數據文件上傳中的內容類型（<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fissues%2F17851" target="_blank">＃17851</a>）<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17853" target="_blank">＃17853</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">Rust</span></span></strong></p><ul><li>[Rust] [Axum] 修復 clippy warning：to_string_trait_impl&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17995" target="_blank">#17995</a></li><li>fix(rust)：用作 api 參數的模型路徑錯誤<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17968" target="_blank">#17968</a></li><li>feat(rust)：支持在客戶端中禁用 boxed models 的能力&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17931" target="_blank">#17931</a></li><li>fix(rust)：客戶端的 oneOf generation&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17915" target="_blank">#17915</a></li></ul><p style="text-align:start"><strong><span style="color:#1f2328"><span style="background-color:#ffffff">TypeScript</span></span></strong></p><ul><li>[typescript-fetch] 使用 == 檢查屬性是否為 null 或未定義<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17972" target="_blank">#17972</a></li><li>使用 exists() 檢查屬性<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Fpull%2F17798" target="_blank">#17798</a></li></ul><p>詳情可查看更新説明：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FOpenAPITools%2Fopenapi-generator%2Freleases%2Ftag%2Fv7.4.0" target="_blank">https://github.com/OpenAPITools/openapi-generator/releases/tag/v7.4.0</a></p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 02:16:09 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282666/openapi-generator-7-4-0-released</guid>
            <link>https://www.oschina.net/news/282666/openapi-generator-7-4-0-released</link>
            <author>
                <![CDATA[來源: OSCHINA]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[拋棄 mybatis 無限 plus 系列的內卷，國產 ORM 框架 sqltoy-orm 5.6.0 發版]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>開源地址：</strong></p><ul><li>github:&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fchenrenfei%2Fsagacity-sqltoy" target="_blank">https://github.com/sagframe/sagacity-sqltoy</a></li><li>gitee:&nbsp;<a href="https://gitee.com/sagacity/sagacity-sqltoy">https://gitee.com/sagacity/sagacity-sqltoy</a></li><li>idea 插件 (可直接在 idea 中檢索安裝):&nbsp;&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fthreefish%2Fsqltoy-idea-plugins" target="_blank">https://github.com/threefish/sqltoy-idea-plugins</a></li><li>sqltoy 腳手架項目：https://gitee.com/momoljw/sss-rbac-admin</li><li>sqltoy lambda 項目:&nbsp;https://gitee.com/gzghde/sqltoy-plus</li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>更新內容</strong></p><p>1、拆分 sqltoy-orm-core\sqltoy-orm-spring\sqltoy-orm-spring-starter 三個子項目，剝離對 spring 的依賴<br> 2、分 5.6.x 和 5.6.x.jre8 兩個分支版本，5.6.x 以 jdk17、springboot3.x 為起點</p><pre><code class="language-xml">&lt;!-- 其他非 spring 框架可以基於 sagacity-sqltoy 進行擴展 --&gt;
&lt;dependency&gt;
&nbsp;&nbsp; &nbsp;&lt;groupId&gt;com.sagframe&lt;/groupId&gt;
&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;sagacity-sqltoy&lt;/artifactId&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- jdk8 對應的版本號為：5.6.0.jre8 --&gt;
&nbsp;&nbsp; &nbsp;&lt;version&gt;5.6.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- 純粹 springboot 項目只需引入 sagacity-sqltoy-spring-starter 依賴即可 &nbsp;--&gt;
&lt;dependency&gt;
&nbsp;&nbsp; &nbsp;&lt;groupId&gt;com.sagframe&lt;/groupId&gt;
&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;sagacity-sqltoy-spring-starter&lt;/artifactId&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- jdk8 對應的版本號為：5.6.0.jre8 --&gt;
&nbsp;&nbsp; &nbsp;&lt;version&gt;5.6.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>sqltoy-orm 是 JPA 和超強查詢的融合體</strong></p><h3><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fsagframe%2Fsagacity-sqltoy%23jpa%25E9%2583%25A8%25E5%2588%2586" target="_blank">JPA 部分</a></h3><ul><li>類似 JPA 的對象化 CRUD、對象級聯加載和新增、更新</li><li>強化 update 操作，提供彈性字段修改能力，不同於 hibernate 先 load 後修改，而是一次數據庫交互完成修改，確保了高併發場景下數據的準確性</li><li>改進了級聯修改，提供了先刪除或者先置無效，再覆蓋的操作選項</li><li>增加了 updateFetch、updateSaveFetch 功能，強化針對強事務高併發場景的處理，類似庫存台賬、資金台賬，實現一次數據庫交互，完成鎖查詢、不存在則插入、存在則修改，並返回修改後的結果</li><li>增加了樹結構封裝，便於統一不同數據庫樹型結構數據的遞歸查詢</li><li>支持分庫分表、支持多種主鍵策略 (額外支持基於 redis 的產生特定規則的業務主鍵)、加密存儲、數據版本校驗</li><li>提供了公共屬性賦值 (創建人、修改人、創建時間、修改時間、租戶)、擴展類型處理等</li><li>提供了多租戶統一過濾和賦值、提供了數據權限參數帶入和越權校驗</li></ul><h3><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fsagframe%2Fsagacity-sqltoy%23%25E6%259F%25A5%25E8%25AF%25A2%25E9%2583%25A8%25E5%2588%2586" target="_blank">查詢部分</a></h3><ul><li>極為直觀的 sql 編寫方式，便於從客戶端 &lt;--&gt; 代碼，雙向快速遷移，便於後期變更維護</li><li>支持緩存翻譯、反向緩存匹配 key 代替 like 模糊查詢</li><li>提供了跨數據庫支持能力：不同數據庫的函數自動轉換適配，多方言 sql 根據實際環境自動匹配、多數據庫同步測試，大幅提升了產品化能力</li><li>提供了取 top 記錄、隨機記錄等特殊場景的查詢功能</li><li>提供了最強大的分頁查詢機制：1) 自動優化 count 語句；2) 提供基於緩存的分頁優化，避免每次都執行 count 查詢；3) 提供了獨具特色的快速分頁；4) 提供了並行分頁</li><li>提供了分庫分表能力</li><li>提供了在管理類項目中極為價值的：分組彙總計算、行列轉換 (行轉列、列轉行)、同比環比、樹形排序、樹形彙總，相關算法自然集成</li><li>提供了基於查詢的層次化數據結構封裝</li><li>提供了大量輔助功能：數據脫敏、格式化、條件參數預處理等</li></ul><h3><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fsagframe%2Fsagacity-sqltoy%23%25E6%2594%25AF%25E6%258C%2581%25E5%25A4%259A%25E7%25A7%258D%25E6%2595%25B0%25E6%258D%25AE%25E5%25BA%2593" target="_blank">支持多種數據庫</a></h3><ul><li>常規的 mysql、oracle、db2、postgresql、 sqlserver、dm、kingbase、sqlite、h2、 oceanBase、polardb、guassdb、tidb</li><li>支持分佈式 olap 數據庫: clickhouse、StarRocks、greenplum、impala (kudu)</li><li>支持 elasticsearch、mongodb</li><li>所有基於 sql 和 jdbc 各類數據庫查詢</li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>sqltoy 特點介紹：</strong></p><ul><li><strong>sqltoy 的核心構建思想</strong></li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:start"><img alt="" height="868" src="https://oscimg.oschina.net/oscnet/up-a385d72ceb030d705e8e5803ca3cd4c09a1.png" width="1136" referrerpolicy="no-referrer"></p><ul><li><strong>sqltoy 的對比 mybatis (plus) 的核心點：查詢語句編寫、可閲讀性、可維護性</strong></li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="" height="923" src="https://oscimg.oschina.net/oscnet/up-05295a7a1813978134a5e49a7cff0f0e1ab.png" width="1873" referrerpolicy="no-referrer"></p><ul><li><strong>對象化 crud 是基礎，但 sqltoy 有針對性的改進：update、updateSaveFetch、updateFetch 等</strong></li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:start"><img alt="" height="845" src="https://oscimg.oschina.net/oscnet/up-6b8e8204061eec3d2096a50e9899548351e.png" width="1745" referrerpolicy="no-referrer"></p><ul><li><strong>sqltoy 的緩存翻譯，大幅減少表關聯簡化 sql，讓你的查詢性能成幾何級提升</strong></li></ul><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="闡述 sqltoy 為什麼秒殺 mybatis(plus)" src="https://p3-tt.byteimg.com/origin/pgc-image/85287e14aa3e428fbabe297472596455?from=pc" referrerpolicy="no-referrer"></p><ul><li><strong>極致的分頁，同樣幫助你實現查詢的性能大幅提升</strong></li></ul><ol><li>快速分頁:@fast () 實現先取單頁數據然後再關聯查詢，極大提升速度</li><li>分頁優化器:page-optimize 讓分頁查詢由兩次變成 1.3~1.5 次 (用緩存實現相同查詢條件的總記錄數量在一定週期內無需重複查詢</li><li>sqltoy 的分頁取總記錄的過程不是簡單的 select count (1) from (原始 sql)；而是智能判斷是否變成:select count (1) from 'from 後語句 '， 並自動剔除最外層的 order by</li><li>sqltoy 支持並行查詢：parallel="true"，同時查詢總記錄數和單頁數據，大幅提升性能</li></ol><div><img alt="闡述 sqltoy 為什麼秒殺 mybatis(plus)" src="https://p6-tt.byteimg.com/origin/pgc-image/3d5f7094da154671985dd390f56f6302?from=pc" referrerpolicy="no-referrer"></div><div>
 &nbsp;
</div><ul><li><strong>便利的跨數據庫統計計算：數據旋轉</strong></li></ul><div><img alt="闡述 sqltoy 為什麼秒殺 mybatis(plus)" src="https://p1-tt.byteimg.com/origin/pgc-image/949bc75b5c53441c98284dae2bed11fe?from=pc" referrerpolicy="no-referrer"></div><ul><li><strong>便利的跨數據庫統計計算：無限極分組統計 (含彙總求平均)</strong></li></ul><div><img alt="闡述 sqltoy 為什麼秒殺 mybatis(plus)" src="https://p1-tt.byteimg.com/origin/pgc-image/f5edc52adbbe4a1ca327d9a9b0c5d64c?from=pc" referrerpolicy="no-referrer"></div><ul><li><strong>便利的跨數據庫統計計算：同比環比</strong></li></ul><div><img alt="闡述 sqltoy 為什麼秒殺 mybatis(plus)" src="https://p3-tt.byteimg.com/origin/pgc-image/b9d435e2852644c9a4c9e062cc3d46d7?from=pc" referrerpolicy="no-referrer"></div><div>
 5、樹形表排序彙總
</div><div><p style="margin-left:0; margin-right:0"><img height="274" src="https://oscimg.oschina.net/oscnet/up-1773cce82b98a943d42caaa62f60d80f3d0.png" width="1002" referrerpolicy="no-referrer"></p><p style="margin-left:0; margin-right:0"><img height="403" src="https://oscimg.oschina.net/oscnet/up-8717f1c442767b08f2406019ae9b63721cb.png" width="409" referrerpolicy="no-referrer"></p><p style="margin-left:0; margin-right:0">6、擴展集成</p><p style="margin-left:0; margin-right:0"><img height="961" src="https://oscimg.oschina.net/oscnet/up-6603ed15ec936dea45c4f6fb7318f4a062b.png" width="1965" referrerpolicy="no-referrer"></p></div></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 01:37:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282659/sqltoy-orm-5-6-0-released</guid>
            <link>https://www.oschina.net/news/282659/sqltoy-orm-5-6-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[vxe-table 4.5.21 已經發布，vue 表格解決方案]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p>vxe-table 4.5.21 已經發布，vue 表格解決方案</p><p>此版本更新內容包括：</p><ul><li>table 
  <ul><li>修復插入臨時數據位置錯誤問題題</li><li>增加參數 sort-config.iconLayout</li></ul></li><li>column 
  <ul><li>增加參數 titleSuffix</li></ul></li><li>icon 
  <ul><li>增加圖標 asc、sort-desc</li></ul></li></ul><p>詳情查看：<a href="https://gitee.com/xuliangzhan_admin/vxe-table/releases/4.5.21">https://gitee.com/xuliangzhan_admin/vxe-table/releases/4.5.21</a></p></div>
                                    ]]>
            </description>
            <pubDate>Tue, 12 Mar 2024 00:19:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282652/vxe-table-4-5-21-released</guid>
            <link>https://www.oschina.net/news/282652/vxe-table-4-5-21-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[JDBC 連接池 BeeCP-4.0.0 從新出發]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p><strong><span><span><span><span><span>&nbsp;</span>一：基本介紹&nbsp; </span></span></span></span></strong></p><p><span><span><span><span><strong><span>BeeCP</span></strong>是一款簡單易用的</span></span></span></span><span><span><span><span>JDBC 連接池，具有性能高，代碼輕，穩定性好特點，已獲得不少用戶的青睞，因此推薦它給更多企業和個人使用。時至今日，它已在默默無聞中悄然走過了 7 個年頭，為了在未來更好的服務於全球用戶，本次新版（BeeCP-4.0.0）發佈中，我們做了兩處大的調整：更換了項目 LICENSE（<span style="background-color:#16a085">LGPL2.1---&gt;Apache LICENSE 2.0</span>）；調整項目源碼頂級目錄 (<span style="background-color:#16a085">cn ---&gt; org.stone</span>)；此外並將 BeeCP 項目源碼整合進 stone 項目中（注：stone 是一個 J2EE 工具包項目，目前它收集了四款彼此獨立的 Java 工具，分別為：JDBC 連接池，Java 對象池，任務處理池，同步等待池，其中連接池與對象池已經歷多個版本迭代，且有多年的實用經歷，另外兩款處於孵化中，未來也許會整合更多小型組件工具，項目地址：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FChris2018998%2Fstone" target="_blank">https://github.com/Chris2018998/stone</a>，項目寓意：以<strong>晶鑽般</strong>的品質服務於全人類，如果此話讓您感覺到不適，那就請忽略此句吧^-^），用戶可以根據自身需求下載單一包或整合包。</span></span></span></span></p><p><strong><span><span><span><span>二：相關截圖</span></span></span></span></strong></p><p><img height="467" src="https://oscimg.oschina.net/oscnet/up-91db3099a359411061d963e75d188792935.png" width="1036" referrerpolicy="no-referrer"></p><p><em>圖 1：性能對比圖（<span style="color:#333333">CPU:&nbsp; I3-7100，內存: 8G，操作系統：Win7_64&nbsp;</span>）</em></p><p><img alt="圖片" src="https://user-images.githubusercontent.com/32663325/163173015-2ce906f3-1b83-419d-82aa-a42b5c8d92b8.png" referrerpolicy="no-referrer"></p><p><em>圖 2：項目代碼質量圖</em></p><p><img height="244" src="https://oscimg.oschina.net/oscnet/up-318214b6655357935988da6864d041fd0cd.png" width="1050" referrerpolicy="no-referrer"></p><p><em>圖 3：數據源監控界面（Springboot2)</em></p><p><strong>三：軟件包下載</strong></p><p>Maven 座標（Java7 及以上）</p><pre><code class="language-xml">&lt;dependency&gt;
   &lt;groupId&gt;com.github.chris2018998&lt;/groupId&gt;
   &lt;artifactId&gt;beecp&lt;/artifactId&gt;
   &lt;version&gt;4.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre><pre><code class="language-xml">&lt;dependency&gt;
   &lt;groupId&gt;com.github.chris2018998&lt;/groupId&gt;
   &lt;artifactId&gt;beecp-spring-boot-starter&lt;/artifactId&gt;
   &lt;version&gt;1.8.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p>beecp-spring-boot-starter 為 beecp 數據源管理工具，它支持以配置的方式維護一個或多個數據源（無代碼開發），並提供 Web 監控界面（上圖 3）<em>，參考例子：</em><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FChris2018998%2Fbeecp-starter%2Ftree%2Fmaster%2Fdoc%2Fdemo" target="_blank">https://github.com/Chris2018998/beecp-starter/tree/master/doc/demo</a></p><p><strong>四：修改內容</strong></p><ul><li><em>增加用於自定義判定驅逐接口 ( 其他兩種方式：errorCode 和 SQLState 的配置）</em></li></ul><ul><li><em>增加創建線程的中斷阻塞的處理方法（外部調用觸發）</em></li></ul><ul><li><em>配置項改名：createTimeout ---&gt; connctTimeout</em></li></ul><p>&nbsp;&nbsp;&nbsp; 關於細節，請到項目站點查看介紹資料</p><p><strong>五：項目地址</strong></p><ul><li>gitee：&nbsp;&nbsp; <a href="https://gitee.com/Chris2018998/BeeCP">https://gitee.com/Chris2018998/BeeCP</a></li><li>github：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FChris2018998%2FBeeCP" target="_blank">&nbsp;https://github.com/Chris2018998/BeeCP</a></li><li>github：<a href="https://www.oschina.net/action/GoToLink?url=http%3A%2F%2Fgithub.com%2FChris2018998%2Fstone" target="_blank">&nbsp;https://github.com/Chris2018998/stone</a></li></ul><p><strong>六：作品承若</strong></p><p><strong>我們莊重承若：在不破壞版權的前提下，已經開源的相關作品可永久免費使用，無論您是商用還是個人使用（不包括違法用途），因為這是我們多年開源的初衷，因此請大家放心使用。</strong><strong>您的支持，便是我們前進的動力，讓我們一起來加油！謝謝！</strong></p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 16:18:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282643/beecp-4-0-0-released</guid>
            <link>https://www.oschina.net/news/282643/beecp-4-0-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[新增移動端支持，嵌入式能力優化，DataEase 開源數據可視化分析平台 v2.4.0 發佈]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="color:#000000; text-align:start">2024 年 3 月 11 日，DataEase 開源數據可視化分析平台正式發佈 v2.4.0 版本。</p><p style="color:#000000; text-align:start">這一版本的功能升級包括：新增<strong><span style="color:#0a7be0">移動端</span></strong>支持，方便用戶在移動端查看收藏的儀錶板等可視化數據，隨時隨地掌握業務的動態變化；新增<strong><span style="color:#0a7be0">引擎設置</span></strong>模塊，用戶可以修改默認引擎，將 API 數據和 Excel 數據存放在指定數據庫中；新增<strong><span style="color:#0a7be0">掃碼登錄</span></strong>功能，企業微信、飛書、釘釘的用戶可通過此功能掃碼登錄至 DataEase 平台；新增<strong><span style="color:#0a7be0">外觀配置</span></strong>模塊，用戶可以在此模塊中設置平台主題、Logo、背景圖、Slogan、頁腳等信息。</p><p style="color:#000000; text-align:start">需要説明的是，在 v2.4.0 版本中，DataEase 的<strong><span style="color:#0a7be0">嵌入式能力</span></strong>得到了進一步優化，同時對錶格、富文本、嵌入式、數據大屏、同步管理等功能進行了增強。</p><h1>新增功能</h1><p style="color:#000000; text-align:start"><strong><span style="color:#0a7be0">■ 移動端：增加適配移動端功能，方便用戶在移動端查看儀錶板等</span></strong></p><p style="color:#000000; text-align:start">在 v2.4.0 版本中，DataEase 新增了對移動端的支持。用戶通過移動設備訪問 DataEase 平台時，DataEase 後端服務會判斷訪問設備的類型，自動跳轉至訪問設備對應的展示界面。在 DataEase 移動端中，用戶可以方便地查看收藏的儀錶板等可視化數據，隨時隨地掌握業務的動態變化。</p><p style="color:#000000; text-align:start"><img alt="" height="886" src="https://oscimg.oschina.net/oscnet/up-b302aa6ec51110f18d0806983a639cdbbcf.png" width="792" referrerpolicy="no-referrer"></p><p><span>▲ 圖 1 移動端總體概覽以及移動端儀錶板展示</span></p><p style="color:#000000; text-align:start"><strong><span style="color:#0a7be0">■ 系統設置：支持引擎設置</span></strong></p><p style="color:#000000; text-align:start">DataEase v2.4.0 版本新增了「引擎設置」功能模塊，用戶可以修改默認引擎，將 DataEase 中的 API 數據和 Excel 數據存放在其中。</p><p style="color:#000000; text-align:start">在以往版本中，DataEase 默認將 API 數據源的數據和 Excel 數據源的數據都存放在 DataEase 運行數據庫中。支持了引擎設置後，用戶可以將這部分業務數據單獨指定存放到自己的數據倉庫裏，不僅可以做到平台數據與業務數據的分離，也能進一步保證數據的安全性。</p><p style="color:#000000; text-align:start"><img alt="" height="1028" src="https://oscimg.oschina.net/oscnet/up-7652690be9d36225aec14d0d31d9c7d553b.png" width="1955" referrerpolicy="no-referrer"></p><p><span>▲ 圖 2 DataEase 新增「引擎配置」功能界面</span></p><p style="color:#000000; text-align:start"><strong><span style="color:#0a7be0">■ 嵌入式：嵌入式能力優化</span></strong></p><p style="color:#000000; text-align:start">DataEase 支持以 iframe 的方式將所有模塊以及儀錶板、數據大屏、圖表、編輯器等嵌入到其他系統中。DataEase 支持用戶按需嵌入多個視圖，並且可以方便地調整視圖大小，同時大幅優化了嵌入式模式下的前端加載速度。</p><p style="color:#000000; text-align:start">此外，DataEase 官方已經推出嵌入式 BI 演示系統（<em>https://embedded-bi.dataease.cn/</em>），便於 ISV（獨立軟件開發商）、SI（系統集成商）體驗 DataEase 的嵌入式 BI 能力。</p><p style="color:#000000; text-align:start"><img alt="" src="https://oscimg.oschina.net/oscnet/up-3dcc830ab59f7ac9b4031b8075e77ad0264.png" referrerpolicy="no-referrer"></p><p style="color:#000000; text-align:start"><span>▲ 圖 3 DataEase 嵌入式版演示環境主界面</span></p><p style="color:#000000; text-align:start"><strong><span style="color:#0a7be0">■ X-Pack 增強包：新增掃碼登錄功能（支持企業微信、飛書和釘釘）</span></strong></p><p style="color:#000000; text-align:start">DataEase v2.4.0 版本新增掃碼登錄功能，支持用戶以企業微信、飛書、釘釘掃碼的方式登錄到 DataEase，滿足了更多企業用戶的訪問登錄需求。</p><p style="color:#000000; text-align:start"><img alt="" height="1028" src="https://oscimg.oschina.net/oscnet/up-4b33ec83e27c2d4ed3172a55cc9427b51ae.jpg" width="1955" referrerpolicy="no-referrer"></p><p><span>▲ 圖 4 DataEase 掃碼登錄頁面</span></p><p><img alt="" height="1028" src="https://oscimg.oschina.net/oscnet/up-133c9fda18863886baad3799ca1c2c76ea9.png" width="1955" referrerpolicy="no-referrer"></p><p><span>▲ 圖 5 DataEase「平台對接」管理頁面</span></p><p style="color:#000000; text-align:start"><strong><span style="color:#0a7be0">■ X-Pack 增強包：支持外觀配置</span></strong></p><p style="color:#000000; text-align:start">DataEase v2.4.0 版本新增「外觀配置」功能模塊，用戶可以根據自己的需要，自定義平台主題、Logo、Slogan、名稱、背景圖、導航、頁腳等信息，進一步滿足了用戶操作界面定製化的相關需求。</p><p style="color:#000000; text-align:start"><img alt="" height="1027" src="https://oscimg.oschina.net/oscnet/up-a4363b442b7f1d7dfeb45081dcb32921611.png" width="1955" referrerpolicy="no-referrer"></p><p><span>▲ 圖 6 DataEase「外觀配置」功能界面</span></p><p style="color:#000000; text-align:start">除了上述新增功能外，DataEase v2.4.0 版本還包含了很多其他的功能更新和優化，歡迎進入 DataEase 的官方文檔及 GitHub 倉庫的 Release 頁面查看更加詳細的更新日誌。</p><h1>功能優化</h1><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（數據大屏）：「保存」按鈕新增防止重複提交的設置；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（數據大屏）：圖形組件新增 SVG 矢量圖形；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（數據大屏）：圖形組件默認樣式變更；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（數據大屏）：富文本組件新增支持撤銷操作；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（數據大屏）：在調整位置屬性的頁面中可以手動設置圖表寬高邏輯，適配保持寬高比例；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（系統設置）：更新 Flyway 水印管理權限；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（圖表）：優化圖表的默認標籤配置；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor（圖表）：優化圖表的默認圖例配置；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor：Calcite SQL 新增適配自定義函數；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor：優化 Calcite 自定義函數的性能；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor：優化 uninstall.sh 卸載腳本的提示（#7955）；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>refactor：優化<em>dectl</em>腳本邏輯；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>chore（X-Pack）：將 TinyMCE 依賴切換到 Core；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>perf（X-Pack）：優化 Flyway 中聲明的字符集以及排序相關語句；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>style（同步管理）：優化更新任務執行中狀態圖標的樣式；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>style：優化大屏製作時右側抽屜頁面（編輯表單、過濾條件所屬頁面）底部的樣式；</p><p style="color:#000000; text-align:start"><span style="color:#0a7be0">■</span><span>&nbsp;</span>style：優化登錄頁面頁腳的樣式。</p><h1>Bug 修復</h1><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（儀錶板）：修復 Icon 的背景圓角與下方列表圓角不一致的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（儀錶板）：修復富文本組件因與 X-Pack 功能衝突而導致不可用的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（儀錶板）：修復富文本組件中華文仿宋等部分字體無法加粗的問題（#8174）；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（儀錶板）：修復了在 DataEase 社區版中，因儀錶板不支持水印設置而導致的控制枱報錯問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（儀錶板）：修改顏色選擇彈出窗口內置的默認顏色；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（工作台）：將模板中心錯誤的大屏展示間距更正為 16px；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（工作台）：新增點擊 Logo 即可返回工作台的設置；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（數據大屏）：修復保持寬高比時，部分圖表的拖拽點被拖拽的同時出現異常位移的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（數據大屏）：修復保持寬高比時，圖表大幅度移動會出現比例改變的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（數據大屏）：修復對標線未顯示的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（數據大屏）：修復組件角落處的移動點，在保持寬高比時被拖動會出現閃動的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（圖表）：修復明細表分頁狀態下只能導出當前頁數據的問題（#7972）；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（圖表）：修復指標卡名稱修改不生效的問題（#8122）；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（圖表）：修復橫向柱狀圖的橫軸在圖表格式化後不顯示的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix（圖表）：修復表格添加序號列後，拖拽表格會導致設置的序號列列寬無法保存的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix：修復了從其他頁面切換至導航主菜單時，閃現其他空狀態圖片的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix：修復</span><em><span>dectl</span></em><span>腳本在停止服務時，無法停止同步管理服務的問題；</span></p><p style="color:#000000; text-align:start"><span><span style="color:#0a7be0">■</span><span>&nbsp;</span>fix：升級 Calcite 版本，修復日期格式錯亂的問題（#8032）。</span></p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 16:06:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282640/dataease-2-4-0-released</guid>
            <link>https://www.oschina.net/news/282640/dataease-2-4-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[🔥🔥🔥 Sigma v1.2.0 發佈 - 一個極容易部署和維護的鏡像倉庫]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p>Sigma 是一個極容易部署和維護的鏡像倉庫，並且自主完整實現了&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fopencontainers%2Fdistribution-spec%2Ftree%2Fv1.1.0" target="_blank">OCI Distribution Specification 1.1</a> 的協議，除了支持 docker 客戶端以外，還支持其他類型的各種客戶端，例如 oras，apptainer，helm，nerdctl 等。在部署層面上完全可以做到 all-in-one 的部署，啓動單個容器即可將整體的鏡像倉庫的所有服務啓動起來，在搞可用層面也可以將各個模塊分別單獨靈活部署。</p><pre><code class="language-bash">docker run -d --name sigma -p 3000:3000 tosone/sigma:nightly-alpine</code></pre><h2>架構圖</h2><p><img height="2246" src="https://oscimg.oschina.net/oscnet/up-7e22efc5daa649c84774a539ee9b0367b36.png" width="5881" referrerpolicy="no-referrer"></p><h2>更新日誌</h2><ul><li>增加 webhook 的功能，支持在 namespace 創建的時候觸發 webhook，支持在 gc 過程中觸發 webhook。</li><li>修復 gc 過程中對 artifact 的清理邏輯。</li><li>暴露 sigma 中的一些 metric，在線的 metric 可以看這裏：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgrafana.sigma.tosone.cn%2Fpublic-dashboards%2Febf12be7e7f44b59bfe4096f0f51ab88" target="_blank">https://grafana.sigma.tosone.cn/public-dashboards/ebf12be7e7f44b59bfe4096f0f51ab88</a></li><li>對於靜態資源發揮 etag。</li><li>修改 namespace 中角色權限校驗部分的邏輯。</li></ul><h2>項目地址</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">gitee:&nbsp;<a href="https://gitee.com/xtosone/sigma">https://gitee.com/xtosone/sigma</a></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">github:&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">https://github.com/go-sigma/sigma</a></p><h2><strong>Sigma 詳細介紹</strong></h2><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">在雲原生的時代，絕大多數 DevOps 的系統中，軟件交付的製品已經從軟件本身轉換到了 OCI-Native 的鏡像，且其已經是必不可少的一個重要組件，它的最大優勢是幫助減少製品交付的複雜度，那麼就需要 OCI-Native 的鏡像倉庫從角色權限的角度維護製品版本，注重製品交付的安全性，保證容器部署的速度。</p><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">開發<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>的最初的想法是是降低<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgoharbor%2Fharbor" target="_blank">Harbor</a><span>&nbsp;</span>組件部署的複雜度，並且在高可用的角度又不失其架構優勢。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>希望在製品元數據管理、權限管理、製品分發、部署和維護容易程度這四個方面作出最大努力，並且在一開始設計<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>的時候就對這幾方面做出思考。</p><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">在個人開發者的使用場景裏需要製品元數據管理友好、UI 易用、部署和維護簡單的鏡像倉庫，並且在鏡像倉庫中能夠加入類似<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fhub.docker.com%2F" target="_blank">docker hub</a><span>&nbsp;</span>的鏡像構建功能將會是一個很受大家期待的功能。在企業團隊中，會對鏡像倉庫的穩定性和兼容性提出更高要求，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>希望可以更深入的參與到整個 DevOps 流程，接入已有的 DevOps 系統，而不單單是一個倉庫存儲的角色。</p><h3><strong>sigma 的優勢</strong></h3><h4><strong>部署架構</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>在部署層面上最簡化可以做到單文件單個啓動命令，將前端、鏡像清理和鏡像構建等異步任務服務以及鏡像元數據管理等服務啓動起來，並且僅依賴文件系統即可。 在高可用部署的情況下，可以將前端、鏡像元數據管理、鏡像清理和鏡像構建等異步任務服務等分別作為單獨的服務運行，api-server 與鏡像元數據管理服務分別單獨部署，主要在於鏡像元數據管理服務會參與到鏡像的拉取和推送服務中，涉及到的流量較大，這樣便不會影響到 api-server 的穩定性，依賴的中間件將會有對象存儲、Redis、PostgreSQL/MySQL。具體部署細節可以參考<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>chart 中的實現：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma%2Ftree%2Fmain%2Fdeploy%2Fsigma" target="_blank">https://github.com/go-sigma/sigma/tree/main/deploy/sigma</a>。</p><h4><strong>鏡像元數據管理</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">鏡像元數據管理這裏採用和<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fhub.docker.com%2F" target="_blank">docker hub</a><span>&nbsp;</span>比較類似的展示方式，在 repository 層級之下展示 tag，而不是像<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgoharbor%2Fharbor" target="_blank">Harbor</a><span>&nbsp;</span>和 ghcr 一樣展示 artifact，用戶其實對於 artifact hash 值的展示不是那麼理解，而 tag 是用戶自己定義的東西，更容易理解一些，在對架構鏡像的展示方式和 docker hub 保持一致。 在多架構鏡像這裏，會有類似 sbom 的 artifact 的內容推送到 artifact list 內，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>的前端將會僅展示 image、imageIndex、chart 等類型的 artifact，但是在<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fopencontainers%2Fdistribution-spec" target="_blank">distribution-spec</a><span>&nbsp;</span>標準接口上，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>還是會返回所有的 artifact。</p><p><img alt="" src="https://fs.tosone.cn/sigma/20231225/tags.jpg" referrerpolicy="no-referrer"></p><h4><strong>路由匹配</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fopencontainers%2Fdistribution-spec" target="_blank">distribution-spec</a><span>&nbsp;</span>定義的鏡像倉庫實現的 API 上，在 repository 層級這裏是允許有斜線存在的（例如：/v2/library/alpine/manifests/latest），在<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdistribution%2Fdistribution" target="_blank">distribution</a><span>&nbsp;</span>的實現上是利用正則來匹配路由的，在絕大多數的 web 框架都是將斜線當作是資源層級分隔符，導致這裏比較難以實現，或者説不利用正則很難有好的實現方式。在<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>中首先使得<span>&nbsp;</span><code>/v2/</code><span>&nbsp;</span>的請求進入到統一的一個路由，再使用字符串匹配切割的方式檢測路由的匹配情況。例如 manifests 相關的路由實現代碼如下：</p><pre><code><span><span style="color:#c678dd">func</span>&nbsp;<span>(f&nbsp;factory)</span>&nbsp;<span style="color:#61aeee">Initialize</span><span>(c&nbsp;echo.Context)</span>&nbsp;<span style="color:#61aeee">error</span></span>&nbsp;{
&nbsp;&nbsp;method&nbsp;:=&nbsp;c.Request().Method
&nbsp;&nbsp;uri&nbsp;:=&nbsp;c.Request().RequestURI
&nbsp;&nbsp;urix&nbsp;:=&nbsp;uri[:strings.LastIndex(uri,&nbsp;<span style="color:#98c379">"/"</span>)]
&nbsp;&nbsp;manifestHandler&nbsp;:=&nbsp;handlerNew()
&nbsp;&nbsp;<span style="color:#c678dd">if</span>&nbsp;strings.HasSuffix(urix,&nbsp;<span style="color:#98c379">"/manifests"</span>)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">switch</span>&nbsp;method&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">case</span>&nbsp;http.MethodGet:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;manifestHandler.GetManifest(c)
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">case</span>&nbsp;http.MethodHead:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;manifestHandler.HeadManifest(c)
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">case</span>&nbsp;http.MethodPut:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;manifestHandler.PutManifest(c)
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">case</span>&nbsp;http.MethodDelete:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;manifestHandler.DeleteManifest(c)
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">default</span>:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;c.String(http.StatusMethodNotAllowed,&nbsp;<span style="color:#98c379">"Method&nbsp;Not&nbsp;Allowed"</span>)
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}&nbsp;<span style="color:#c678dd">else</span>&nbsp;<span style="color:#c678dd">if</span>&nbsp;strings.HasSuffix(urix,&nbsp;<span style="color:#98c379">"/referrers"</span>)&nbsp;&amp;&amp;&nbsp;method&nbsp;==&nbsp;http.MethodGet&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;manifestHandler.GetReferrer(c)
&nbsp;&nbsp;}
&nbsp;&nbsp;<span style="color:#c678dd">return</span>&nbsp;distribution.Next&nbsp;<em>//&nbsp;進入到下一個路由匹配規則中</em>
}
</code></pre><h4><strong>鏡像存儲</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">與<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdistribution%2Fdistribution" target="_blank">distribution</a><span>&nbsp;</span>項目不相同的是在鏡像的 manifest 和 blob 文件存儲上是完全不同的，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdistribution%2Fdistribution" target="_blank">distribution</a><span>&nbsp;</span>在鏡像的存儲上主要依賴存儲上的結構，將 tag 與 artifact 組成關聯關係，artifact 與 blob 組成關聯關係，這樣就可以讓<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdistribution%2Fdistribution" target="_blank">distribution</a><span>&nbsp;</span>不依賴任何的數據庫就可以達到管理鏡像元數據和鏡像 blob 的目的，從這一點上來看是很不錯的。但是在鏡像 gc 的時候會產生很大的麻煩，因為鏡像清理要涉及到 blob 的清理，但是反向的關聯在文件系統上比較難實現，這也是導致<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgoharbor%2Fharbor" target="_blank">Harbor</a><span>&nbsp;</span>在很早之前的版本上只能做到在鏡像清理的時候停止鏡像倉庫的推送功能，這是完全不能接受的。</p><p style="color:#000000; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>在存儲這些關聯關係的時候不再使用文件系統來實現，而是直接使用數據庫，文件系統層級將僅僅存儲 blob 數據，存儲 blob 的目錄結構與<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdistribution%2Fdistribution" target="_blank">distribution</a><span>&nbsp;</span>上保持一致，artifact 與 tag 直接存儲在數據庫內。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>的鏡像清理在實現層面上是多線程的，將沒有關聯關係的 blob 直接從文件系統層級上刪除，並且不會影響到前端的鏡像推送功能（需要説明的是，在刪除和新的 blob 推送上在相同的 blob 這裏是有一個毫秒級的鎖在的，用戶對此無法感知），具體實現可以看這裏：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma%2Fblob%2Fmain%2Fpkg%2Fdaemon%2Fgc%2Fgc_blob.go" target="_blank">https://github.com/go-sigma/sigma/blob/main/pkg/daemon/gc/gc_blob.go</a>。</p><h4><strong>鏡像構建</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">鏡像構建主要依賴 Dockerfile，但是 Dockerfile 構建的時候大多數需要依賴代碼倉庫，所以<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>目前對接了 GitHub 和 GitLab，可以將其中的代碼倉庫列表獲取到讓用戶選擇代碼倉庫填寫相關參數進行構建。</p><p><img alt="" src="https://fs.tosone.cn/sigma/20231225/build-conf.jpg" referrerpolicy="no-referrer"></p><p><img alt="" src="https://fs.tosone.cn/sigma/20231225/build-log.jpg" referrerpolicy="no-referrer"></p><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">用戶可以選擇指定的代碼倉庫和代碼倉庫的分支，填寫 Dockerfile 相關的構建參數，例如：構建架構，build args 等。 其中也支持定時任務的構建，也支持代碼倉庫的 hook event 觸發構建，例如：push event，tag event 等。 sigma 在構建的時候隨時可以對任務進行停止操作，在構建過程中會有實時的日誌展示到前端。在<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>構建完成的時候會將構建過程中得到的緩存文件打包緩存到<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>對接的文件系統或對象存儲中，到下次構建前會將緩存加載進來再做構建，構建任務完成之前還會對鏡像使用<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fsigstore%2Fcosign" target="_blank">cosign</a><span>&nbsp;</span>進行簽名，簽名使用的私鑰為<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>啓動時生成的私鑰，存儲在數據庫中。</p><h4><strong><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fopencontainers%2Fdistribution-spec" target="_blank">distribution-spec</a><span>&nbsp;</span>1.1 的支持</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdistribution%2Fdistribution" target="_blank">distribution</a><span>&nbsp;</span>目前尚未支持<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fopencontainers%2Fdistribution-spec" target="_blank">distribution-spec</a><span>&nbsp;</span>1.1 定義的內容，目前<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgoharbor%2Fharbor" target="_blank">Harbor</a><span>&nbsp;</span>和<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fproject-zot%2Fzot" target="_blank">zot</a><span>&nbsp;</span>都是實現了的，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>也對<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fopencontainers%2Fdistribution-spec" target="_blank">distribution-spec</a><span>&nbsp;</span>1.1 做了實現，並且在鏡像清理中會檢查 referrer 的內容，當 artifact 被刪除的時候會連同之前其 artifact 的其他 artifact 全部刪除。</p><h4><strong>quota</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>支持在 namespace 和 repository 設置 size 和 tag 上限，但其中遵循 namespace 和 repository 的從屬容量限制關係。 在 namespace 頁面上可以方便查看當前的容量使用情況，未來會支持當存儲容量接近上限的時候發出對應的 hook event。如下圖：</p><p><img alt="" src="https://fs.tosone.cn/sigma/20231225/quota.jpg" referrerpolicy="no-referrer"></p><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">目前<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>支持在鏡像推送達到存儲容量或者 tag 容量上限的時候，在客戶端給出相應的提示信息。</p><p><img alt="" src="https://fs.tosone.cn/sigma/20231225/quota-push.jpg" referrerpolicy="no-referrer"></p><h4><strong>鏡像掃描</strong></h4><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">目前在鏡像類型的製品在推送完成之後就會在後端異步的執行<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Faquasecurity%2Ftrivy" target="_blank">trivy</a><span>&nbsp;</span>鏡像掃描的任務，並且鏡像掃描的任務將會和<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Faquasecurity%2Ftrivy" target="_blank">trivy</a><span>&nbsp;</span>的漏洞庫做關聯，當漏洞庫有更新時，用戶可以選擇是否重新進行進行鏡像掃描，後續 sigma 會支持當鏡像有嚴重漏洞的時候禁止鏡像的拉取操作。</p><p><img alt="" src="https://fs.tosone.cn/sigma/20231225/vuln.png" referrerpolicy="no-referrer"></p><h3><strong>未來規劃</strong></h3><ul><li><p>在存儲層將會支持更多的對象存儲的 driver，目前僅支持 filesystem，s3，cos，如果對應的對象存儲支持 s3 協議則可以無縫對接。</p></li><li><p>在鏡像分發的可分發性上做出一些開關，當鏡像被發現一些嚴重的漏洞的時候將不允許被分發，當鏡像沒有做簽名的時候不允許被分發。</p></li><li><p>完善更多的鏡像 Proxy 策略，對接更多的鏡像倉庫，可以緩存 ghcr.io 的鏡像等等。完善更多的鏡像複製策略，在做 proxy 的時候可以在 repository 層級上做更多的設置。</p></li><li><p>實現多地域 sigma 實例鏡像同步的功能。</p></li><li><p>實現事件觸發的 hook event，例如鏡像構建完成，鏡像 tag 推送完成等事件。</p></li><li><p>未來在鏡像分發方面將會做更多努力，將會支持 P2P 和 lazy pull 特性。</p></li><li><p>對接更多的第三方登錄的方式，優化權限管理，在權限粒度上設置的更精細一些，支持多租戶的管理。</p></li></ul><h3><strong>最後</strong></h3><p style="color:#000000; margin-left:0; margin-right:0; text-align:left">在 2023 年 12 月底發佈 v1.0.0 正式開源，歡迎各位開發者體驗試用，更歡迎大家一起建設<span>&nbsp;</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fgo-sigma%2Fsigma" target="_blank">sigma</a><span>&nbsp;</span>的未來，參與到項目中來。</p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 14:48:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282630/go-sigma-1-2-0-released</guid>
            <link>https://www.oschina.net/news/282630/go-sigma-1-2-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[Jeepay v2.3.0 正式發佈：支付系統支持一鍵部署]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><span style="background-color:#ffffff; color:#333333">Jeepay 是一套適合互聯網企業使用的開源支付系統，支持多渠道服務商和普通商戶模式。已對接</span><code>微信支付</code><span style="background-color:#ffffff; color:#333333">，</span><code>支付寶</code><span style="background-color:#ffffff; color:#333333">，</span><code>雲閃付</code><span style="background-color:#ffffff; color:#333333">官方接口，支持聚合碼支付。<br><br> v2.3.0 版本升級內容：</span></p><div><ol><li>優化：升級 wxjava/hutool 到最新版本， 適配最新版本微信支付接口</li><li>新增：添加項目下的 Dockerfile 文件</li><li>新增：一鍵部署安裝、卸載腳本</li><li>修復： FastJSON 開啓安全模式，解決安全檢測漏洞</li></ol></div><p style="color:#333333; margin-left:0; margin-right:0; text-align:start">更多升級日誌：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.jeequan.com%2Fdev%2Fupdate%2Fcategory_1016.html" target="_blank">https://www.jeequan.com/dev/update/category_1016.html</a><br><br> 項目特點</p><ul><li>支持多渠道對接，支付網關自動路由</li><li>已對接<code>微信</code>服務商和普通商戶接口，支持<span>&nbsp;</span><code>V2</code><span>&nbsp;</span>和<span>&nbsp;</span><code>V3</code><span>&nbsp;</span>接口</li><li>已對接<code>支付寶</code>服務商和普通商戶接口，支持 RSA 和 RSA2 簽名</li><li>已對接<code>雲閃付</code>服務商接口，可選擇多家支付機構</li><li>提供 http 形式接口，提供各語言的<span>&nbsp;</span><code>sdk</code><span>&nbsp;</span>實現，方便對接</li><li>接口請求和響應數據採用簽名機制，保證交易安全可靠</li><li>系統安全，支持<code>分佈式</code>部署，<code>高併發</code></li><li>管理端包括<code>運營平台</code>和<code>商戶系統</code></li><li>管理平台操作界面簡潔、易用</li><li>支付平台到商戶系統的訂單通知使用 MQ 實現，保證了高可用，消息可達</li><li>支付渠道的接口參數配置界面自動化生成</li><li>使用<span>&nbsp;</span><code>spring security</code><span>&nbsp;</span>實現權限管理</li><li>前後端分離架構，方便二次開發</li><li>由原<span>&nbsp;</span><code>XxPay</code><span>&nbsp;</span>團隊開發，有着多年支付系統開發經驗</li></ul><blockquote><p style="margin-left:0; margin-right:0">Jeepay 運營平台功能</p></blockquote><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="Jeepay 運營平台功能" src="https://static.oschina.net/uploads/img/202207/08190720_WljY.png" referrerpolicy="no-referrer"></p><blockquote><p style="margin-left:0; margin-right:0">Jeepay 商戶系統功能</p></blockquote><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="Jeepay 商戶系統功能" src="https://static.oschina.net/uploads/img/202207/08190720_luZt.png" referrerpolicy="no-referrer"></p><h2>🍯 系統截圖</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><code>以下截圖是從實際已完成功能界面截取,截圖時間為：2021-07-06 08:59</code></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="Jeepay 演示界面" src="https://static.oschina.net/uploads/img/202207/08190720_qjBV.png" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="Jeepay 演示界面" src="https://static.oschina.net/uploads/img/202207/08190721_IaeV.png" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="Jeepay 演示界面" src="https://static.oschina.net/uploads/img/202207/08190721_jxZD.png" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="Jeepay 演示界面" src="https://static.oschina.net/uploads/img/202207/08190721_AAZk.png" referrerpolicy="no-referrer"></p><p>&nbsp;</p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 11:53:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282607/jeepay-2-3-0-released</guid>
            <link>https://www.oschina.net/news/282607/jeepay-2-3-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[Apache Doris 2.1.0 版本發佈：開箱盲測性能大幅優化，複雜查詢性能提升 100%]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>親愛的社區小夥伴們，我們很高興地向大家宣佈，在 3 月 8 日我們引來了 </span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fapache%2Fdoris%2Freleases" target="_blank"><span>Apache Doris 2.1.0 版本</span></a></span><span>的正式發佈，歡迎大家下載使用。</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>在查詢性能方面， 2.1 系列版本我們着重提升了開箱盲測性能，力爭不做調優的情況下取得較好的性能表現，包含了對複雜 SQL 查詢性能的進一步提升，在 TPC-DS 1TB 測試數據集上獲得超過 100% 的性能提升，查詢性能居於業界領先地位。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在數據湖分析場景，我們進行了大量性能方面的改進、相對於 Trino 和 Spark 分別有 4-6 倍的性能提升，並引入了多 SQL 方言兼容、便於用戶可以從原有系統無縫切換至 Apache Doris。在面向數據科學以及其他形式的大規模數據讀取場景，我們引入了基於 Arrow Flight 的高速讀取接口，數據傳輸效率提升 100 倍。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在半結構化數據分析場景，我們引入了全新的 Variant 和 IP 數據類型，完善了一系列分析函數，面向複雜半結構化數據的存儲和分析處理更加得心應手。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在 2.1.0 版本中我們也引入了基於多表的異步物化視圖以提升查詢性能，支持透明改寫加速、自動刷新、外表到內表的物化視圖以及物化視圖直查，基於這一能力物化視圖也可用於數據倉庫分層建模、作業調度和數據加工。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在存儲方面，我們引入了自增列、自動分區、MemTable 前移以及服務端攢批的能力，使得大規模數據實時寫入的效率更高。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在負載管理方面，我們進一步完善了 Workload Group 資源組的隔離能力，並增加了運行時查看 SQL 資源用量的能力，進一步提升了多負載場景下的穩定性。</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 2.1.0 版本的研發過程中，</span><span><strong><span>有 237 位貢獻者為 Apache Doris 帶來了接近 6000 個 Commits。</span></strong></span><span> 同時 2.1.0 版本也同樣經過了近百家社區用戶的大規模打磨，在測試過程中向我們反饋了許多有價值的優化項，在此向所有參與版本研發、測試和需求反饋的貢獻者們表示最衷心的感謝。後續我們將會持續敏捷發版來響應所有用戶對功能和穩定性的更高追求，歡迎大家在使用過程中給予我們更多反饋。</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>GitHub 下載：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fapache%2Fdoris%2Freleases" target="_blank"><span>https://github.com/apache/doris/releases</span></a></span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>官網下載：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fapache%2Fdoris%2Freleases" target="_blank"><span>https://doris.apache.org/download</span></a></span></p></li></ul><h2><span>複雜查詢性能提升 100%，TPC-DS 業界領先</span></h2><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.1 版本中，我們着重優化了面向海量數據和複雜數據分析場景下的分析性能，使得 Apache Doris 在真實業務場景中擁有更加優異的性能表現。在此我們以 TPC-DS 1TB 作為性能測試對比的基準，重點對比最新 2.1.0 版本與 2.0.5 版本的性能提升。集羣規模均為 1FE、3BE，其中 BE 節點的服務器配置為 48C 192G。從以下測試結果中可以看到：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>2.1.0 版本的總查詢耗時為 245.7 秒，相較於 2.0.5 版本的 489.6 秒，</span><span><strong><span>性能提升達到 100 %；</span></strong></span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在全部 99 個 SQL 中，有近三分之一的 SQL 查詢性能提升達到 2 倍以上，超過 80 個 SQL 都獲得顯著性能提升；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>不論是基礎的過濾、排序、聚合，或者複雜的多表關聯查詢、子查詢以及窗口函數計算，2.1.0 版本都有更為明顯的性能優勢；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>2.0.5 版本或 2.1.0 版本，都可以完整執行 TPC-DS 的 99 個查詢。</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="複雜查詢性能提升 100%，TPC-DS 業界領先" src="https://cdn.selectdb.com/static/2_1_Doris_TPC_DS_best_performance_915521542b.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>以上詳細測試結果我們將在後續提交到 Apache Doris 官網文檔中，也歡迎所有用戶在完成最新版本的部署後進行測試復現。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>與此同時，我們也對業內多個 OLAP 系統在同等硬件資源和多個測試數據規模下進行了性能測試，不論大寬表場景或多表關聯場景，Apache Doris 都具備着極為明顯的性能優勢。毫無疑問，</span><span><strong><span>Apache Doris 已在業界同類產品中性能居於最領先地位</span></strong></span><span>！</span></p><h3><span>優化器更智能</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.0 版本中我們引入了全新查詢優化器，在絕大多數場景無需任何調優即可實現極致的查詢性能。而在最新發布的 Apache Doris 2.1 版本中，查詢優化器在整體代際更新的基礎上，進行了優化規則的擴展和枚舉框架的完善，面向複雜分析場景更加得心應手：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>優化器基礎設施完善</span></strong></span><span>：在多種優化器基礎設施方面進行了補充和增強，例如對統計信息推導和代價模型方面的持續改進，使之能夠收集更多的特徵信息為複雜優化提供基礎；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>優化規則持續擴展</span></strong></span><span>：得益於豐富的實際場景反饋，新版本中查詢優化器增強了包括算子下壓在內的許多經典規則，結合上述基礎設施擴充而引入的新優化規則，使得新版本的查詢優化器能覆蓋更廣泛的使用場景；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>枚舉框架進一步優化</span></strong></span><span>：在查詢優化器 Cascades 和 DPhyper 兩大融合框架的基礎上，繼續深耕框架能力、優化框架性能，確立了更為清晰的枚舉策略，兼顧計劃質量和枚舉效率，為高性能引擎提供堅實基礎。例如將 Cascades 默認枚舉表上限從 5 提升到了 8、有效擴大了高質量計劃的覆蓋範圍，同時進一步優化 DPhyper 枚舉效率、使之能夠枚舉出更優計劃。</span></p></li></ul><h3><span>無統計信息優化</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>針對海量數據規模以及數據湖分析場景下，針對統計信息收集難度高、收集時間久的問題，在 2.1 版本中查詢優化器利用多種啓發式技術，大大提升了</span><span><strong><span>無統計信息場景下</span></strong></span><span>的計劃質量，使得在沒有統計信息的場景下也可獲得較好的查詢計劃。同時擴展了 Runtime Filter 的下壓場景和自適應能力，在執行過程中能夠自適應地動態調整部分表達式謂詞，使得 Apache Doris 在不依賴統計信息的情況下也具有優異的性能表現。</span></p><h3><span>Parallel Adaptive Scan 並行自適應掃描</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在複雜數據分析場景下，每次查詢都需要掃描大量的數據進行計算，因此 IO 瓶頸很大程度上決定了查詢性能的上限。為了提升 Scan IO 的性能，Apache Doris 採取了並行讀取的技術，每個掃描線程讀取 1 個或者多個 Tablet（即用戶建表時指定的 Bucket），但如若用戶建表時指定的 Bucket 數目不合理、那麼磁盤掃描線程就無法並行工作，直接影響查詢性能。 為此，在 2.1 版本中我們引入了 Tablet 內的並行掃描技術，可以將多個 Tablet 進行池化，在磁盤掃描端可以根據行數來拆分多個線程並行掃描（最多支持 48 個線程），從而有效避免分桶數不合理導致的查詢性能問題。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="Parallel Adaptive Scan 並行自適應掃描" src="https://cdn.selectdb.com/static/2_1_doris_parallel_adaptive_scan_8a203d3d9b.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>因此在 2.1 版本以後，我們建議用戶</span><span><strong><span>在建表時設置的分桶數=整個集羣磁盤的數量</span></strong></span><span>，在 IO 層面能將整個集羣所有的 IO 資源全部利用起來。</span></p><blockquote><p style="margin-left:0; margin-right:0"><span>注：當前 2.1.0 版本的 Parallel Adaptive Scan 只能針對 Unqiue Key 模型的 Merge-on-Write 表以及 Duplicate Key 模型生效， 預計在 2.1.1 版本中會增加對 Unique Key 模型 Merge-on-Read 表和 Aggregate Key 模型的支持。</span></p></blockquote><h3><span>Local Shuffle</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在部分場景下，數據分佈不均會導致多個 Instance 的查詢執行出現長尾。而為瞭解決單個 BE 節點上多個 Instance 之間的數據傾斜問題，在 Apache Doris 2.1 版本中我們引入了 Local Shuffle 技術，儘可能將數據打散從而加速查詢。例如在某一典型的聚合查詢中，數據在經過聚合之前將會通過一個 Local Shuffle 節點被均勻分佈在不同的 Pipeline Task 中，如下圖所示：</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="Local Shuffle" src="https://cdn.selectdb.com/static/2_1_doris_local_shuffle_7d9b986fe6.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在具備了 Parallel Adaptive Scan 和 Local Shuffle 能力之後，Apache Doris 能夠規避由於分桶數不合理、數據分佈不均帶來的性能問題。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在此我們分別使用 Clickbench（大寬表場景）和 TPC-H（多表 Join 的複雜分析場景） 數據集模擬建表分桶不合理的情況，在 Clickbench 數據集中我們建表 Bucket 數量分別設為 1 和 16 ，在 TPC-H 100G 數據集下我們建表時每個 Partition 的 Bucket 數目分別設為 1 和 16。在開啓 Parallel Adaptive Scan 和 Local Shuffle 之後，整體查詢性能表現比較平穩，即使不合理的數據分佈也能取得優異的性能表現。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="2.1-doris-clickbench-tpch" src="https://cdn.selectdb.com/static/2_1_doris_clickbench_tpch_de608f0f92.png" referrerpolicy="no-referrer"></span></p><blockquote><p style="margin-left:0; margin-right:0"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fquery-acceleration%2Fpipeline-x-execution-engine" target="_blank"><span>https://doris.apache.org/zh-CN/docs/query-acceleration/pipeline-x-execution-engine</span></a></span></p></blockquote><h2><span>ARM 架構深度適配，性能提升 230% </span></h2><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.1 版本中我們針對 ARM 架構進行了深度的適配和指令集優化，可以在 ARM 架構上充分發揮 Apache Doris 的性能優勢。相較於 2.0 版本，2.1 版本在 ClickBench、SSB 100G、TPC-H 100G 以及 TPC-DS 1TB 等多個測試數據集中取得了超過 100% 的性能提升。在此我們以大寬表場景的 ClickBench 以及多表關聯場景的 TPC-H 為例，集羣配置均為 1FE 3BE、BE 節點的服務器配置為 16C 64G 的 ARM 服務器，測試結論如下：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>在大寬表場景中， ClickBench 測試數據集 43 個 SQL 的總查詢耗時從 102.36 秒降低至 30.73 秒，性能提升超過 230%；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在多表關聯場景中， TPC-H 22 個 SQL 的總查詢耗時從 174.8 秒降低至 90.4 秒，性能提升 93%；</span></p></li></ul><h2><span>數據湖分析</span></h2><h3><span>性能提升 </span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 2.1 版本中，我們對數據湖分析方面做了大量改進，包括對 HDFS 和對象存儲的 IO 優化、Parquet/ORC 文件格式的讀取反序列優化、浮點類型解壓優化、謂詞下推執行優化、緩存策略以及掃描任務調度策略的優化，以及針對不同數據源的統計信息準確性的提升及更精準的優化器代價模型。基於以上優化，Apache Doris 在數據湖分析場景下的性能得到大幅度提升。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="Doris 數據湖分析-性能提升" src="https://cdn.selectdb.com/static/2_1_doris_TPC_DS_2a1a2327a3.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在此我們以 TPC-DS 1TB 場景下進行測試，Apache Doris 2.1 版本和 Trino 435 版本的性能測試結果如下：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>在無緩存情況下，Apache Doris 的總體運行耗時間為 717s、Trino 為 1296s，查詢耗時降低了 45%，全部 99 條 SQL 中有 80% 比 Trino 更快 ；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>在開啓文件緩存功能並命中的情況下，Apache Doris 的總體性能可以進一步提升 2.2 倍以上，</span><span><strong><span>較 Trino 有 4 倍以上的性能提升，全部 99 條 SQL 性能均優於 Trino</span></strong></span><span>。</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>與此同時也在 TPC-DS 10TB 場景下對 Apache Doris 2.1 版本與 Spark 3.5.0 以及 3.3.1 版本進行了性能測試，查詢性能分別提升 4.2 倍和 6.1 倍。</span></p><h3><span>多 SQL 方言兼容</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>當用戶從原有 OLAP 系統（如 Clickhouse、Trino、Presto、Hive 等）遷移至 Apache Doris 時，一方面因為 SQL 方言存在差異，需要同步修改大量的業務查詢邏輯進行適配，無法進行平滑遷移。另一方面，當使用 Apache Doris 作為統一數據分析網關時，需要對接原先的 Hive、Spark 等系統、以滿足不同數據源的查詢需求。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>因此在 Apache Doris 2.1 版本中我們引入了多 SQL 方言轉換功能，用戶可以直接使用原先系統的 SQL 方言在 Doris 中進行數據查詢而無需修改業務邏輯。在部署好 SQL 轉換服務後，用戶只需通過會話變量 </span><span><code>sql_dialect</code></span><span>設置當前會話的 SQL 方言類型，即可使用對應的 SQL 方言進行查詢。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>該功能目前為實驗性質功能，當前已經支持 ClickHouse、Presto、Trino、Hive、Spark。在此我們以 Trino 為例，部署完 SQL 轉換服務後，在會話變量中設置 </span><span><code>set sql_dialect = trino</code></span><span> ，即可直接採取 Trino SQL 語法執行查詢。在某些社區用戶的實際線上業務 SQL 兼容性測試中，在全部 3w 多條查詢語句中與 Trino SQL 兼容度高達 99% 以上。也歡迎所有用戶在使用過程中向我們反饋不兼容的 Case，幫助 Apache Doris 更加完善。</span></p><blockquote><p style="margin-left:.8em; margin-right:0"><span>演示 Demo: </span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1cS421A7kA%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV1cS421A7kA/?spm_id_from=333.999.0.0</span></a></span></p><p style="margin-left:0; margin-right:.8em"><span>參考文檔: </span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Flakehouse%2Fsql-dialect" target="_blank"><span>https://doris.apache.org/zh-CN/docs/lakehouse/sql-dialect</span></a></span></p></blockquote><h3><span>高速數據讀取，數據傳輸效率提升 100 倍</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>如今許多大數據系統都採取列式內存數據格式，以 MySQL/JDBC/ODBC 作為與數據庫系統交互的主流協議與標準。在數據輸出至外部系統的過程中，需要將數據從系統特定的列存格式序列化為 MySQL/JDBC/ODBC 協議的行存格式，再反序列化回客戶端的列存格式，這會使數據傳輸速度大幅降低，在面向數據科學或其他形式的大規模數據讀寫時，數據傳輸的效率缺陷愈發明顯。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>作為用於大規模數據處理的列式內存格式，Apache Arrow 提供了高效的數據結構、允許不同系統間更快共享數據。如果源數據庫和目標客戶端都支持 Apache Arrow 作為列式內存格式，使用 Arrow Flight SQL 協議傳輸將無需序列化和反序列化數據，消除數據傳輸中的開銷。同時 Arrow Flight 還可以利用多節點和多核架構，通過完全並行化優化吞吐能力。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="高速數據讀取，數據傳輸效率提升 100 倍" src="https://cdn.selectdb.com/static/2_1_doris_arrow_flight_312b92e568.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在過去如果需要採取 Python 讀取 Apache Doris 中的數據，需要將 Apache Doris 中列存的 Block 序列化為 MySQL 協議的行存 Bytes，然後在 Python 客戶端再反序列化到 Pandas 中，傳輸過程帶來的性能損耗非常大。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.1 版本中，我們提供了基於 Arrow Flight 的 HTTP Data API 高吞吐數據讀寫接口。相比於過去的 MySQL 協議，使用 Arrow Flight SQL 後，我們在 Apache Doris 中先將列存的 Block 轉為同樣列存的 Arrow RecordBatch，這一步轉換效率非常高、且傳輸過程中無需再次序列化和反序列化，而後在 Python 客戶端再將 Arrow RecordBatch 轉到同樣列存的 Pandas DataFrame 中，這一步轉換同樣非常快。通過 Arrow Flight 提供的 Python 客戶端 Pandas/Numpy 等數據科學工具，可以快速從 Apache Doris 中讀取數據並在本地進行分析。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>基於此， Apache Doris 可以與整個 AI 和數據科學生態進行良好的整合，這也是未來的重要發展方向。</span></p><pre><span><span style="color:#000000">conn</span><span style="color:#981a1a">=</span><span style="color:#000000">flight_sql</span>.<span style="color:#000000">connect</span>(<span style="color:#000000">uri</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"grpc://127.0.0.1:9090"</span>, <span style="color:#000000">db_kwargs</span><span style="color:#981a1a">=</span>{</span><span><span style="color:#000000">adbc_driver_manager</span>.<span style="color:#000000">DatabaseOptions</span>.<span style="color:#000000">USERNAME</span>.<span style="color:#000000">value</span>: <span style="color:#aa1111">"user"</span>,</span><span><span style="color:#000000">adbc_driver_manager</span>.<span style="color:#000000">DatabaseOptions</span>.<span style="color:#000000">PASSWORD</span>.<span style="color:#000000">value</span>: <span style="color:#aa1111">"pass"</span>,</span><span>        })</span><span><span style="color:#000000">cursor</span><span style="color:#981a1a">=</span><span style="color:#000000">conn</span>.<span style="color:#000000">cursor</span>()</span><span><span style="color:#000000">cursor</span>.<span style="color:#000000">execute</span>(<span style="color:#aa1111">"select * from arrow_flight_sql_test order by k0;"</span>)</span><span><span style="color:#000000">print</span>(<span style="color:#000000">cursor</span>.<span style="color:#000000">fetchallarrow</span>().<span style="color:#000000">to_pandas</span>())</span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>針對常見的數據類型，我們通過不同的 MySQL 客戶端進行了對比測試，基於 Arrow Flight SQL 數據傳輸性能相較於 MySQL 協議提升了近百倍。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="Arrow Flight SQL" src="https://cdn.selectdb.com/static/2_1_doris_arrow_flight_sql_228daad843.png" referrerpolicy="no-referrer"></span></p><blockquote><p style="margin-left:0; margin-right:0"><span>演示 Demo：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1mj421Z7b7%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV1mj421Z7b7/?spm_id_from=333.999.0.0</span></a></span></p></blockquote><h3><span>其他</span></h3><ul><li><p style="margin-left:.5rem; margin-right:0"><span>Paimon Catalog：Paimon 版本升級至 0.6.0，優化了 Read Optimized 表的讀取，在 Paimon 數據充分合並的場景下，可以有 10 倍的性能提升；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>Iceberg Catalog：Iceberg 版本升級至 1.4.3，同時解決了 AWS S3 認證的若干兼容性問題；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>Hudi Catalog：Hudi 版本升級至 0.14.1，同時解決了 Hudi Flink Catalog 的若干兼容性問題。</span></p></li></ul><h2><span>多表物化視圖</span></h2><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>作為一種典型的「空間換時間」策略，物化視圖通過預先計算和存儲 SQL 查詢結果，當執行相同查詢時可以直接從物化視圖表中獲取結果，在大幅提升查詢性能的同時、更是減少重複計算帶來的系統資源消耗。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在過去版本中 Apache Doris 提供了強一致的單表物化視圖、保證基表和物化視圖表的原子性，並支持了查詢語句在物化視圖上的智能路由。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>在 Apache Doris 2.1 版本中，我們引入了全新的異步物化視圖，可以基於多表來構建。</span></strong></span><span> 異步物化視圖可以全量或者分區增量構建，也可以手動或者週期性地構建刷新數據。在多表關聯查詢且表數據量較大的場景下，優化器會根據代價模型進行透明改寫、並自動尋找最優物化視圖來響應查詢，</span><span><strong><span>以大幅提升查詢性能</span></strong></span><span>。與此同時，也提供了從外表到內表的物化視圖以及直查物化視圖的能力，基於此特性，</span><span><strong><span>異步物化視圖也可用於數據倉庫分層建模、作業調度和數據加工</span></strong></span><span>。異步物化視圖使用方式如下：</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>表定義：</span></strong></span></p><pre><span><span style="color:#770088">use</span> tpch<span>;</span></span><span><span>​</span></span><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#770088">IF</span><span style="color:#770088">NOT</span><span style="color:#770088">EXISTS</span> orders  <span style="color:#999977">(</span></span><span>    o_orderkey       <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_custkey        <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_orderstatus    <span>char</span><span style="color:#999977">(</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_totalprice     decimalv3<span style="color:#999977">(</span><span style="color:#116644">15</span><span>,</span><span style="color:#116644">2</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_orderdate      <span>date</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_orderpriority  <span>char</span><span style="color:#999977">(</span><span style="color:#116644">15</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_clerk          <span>char</span><span style="color:#999977">(</span><span style="color:#116644">15</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_shippriority   <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    o_comment        <span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">79</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span></span><span><span style="color:#999977">)</span></span><span>    DUPLICATE <span style="color:#770088">KEY</span><span style="color:#999977">(</span>o_orderkey<span>,</span> o_custkey<span style="color:#999977">)</span></span><span><span style="color:#770088">PARTITION</span><span style="color:#770088">BY</span><span style="color:#770088">RANGE</span><span style="color:#999977">(</span>o_orderdate<span style="color:#999977">)(</span></span><span><span style="color:#770088">FROM</span><span style="color:#999977">(</span><span style="color:#aa1111">'2023-10-17'</span><span style="color:#999977">)</span><span style="color:#770088">TO</span><span style="color:#999977">(</span><span style="color:#aa1111">'2023-10-20'</span><span style="color:#999977">)</span><span style="color:#770088">INTERVAL</span><span style="color:#116644">1</span> DAY<span style="color:#999977">)</span></span><span>    DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span>o_orderkey<span style="color:#999977">)</span> BUCKETS <span style="color:#116644">3</span></span><span>    PROPERTIES <span style="color:#999977">(</span><span style="color:#aa1111">"replication_num"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"1"</span><span style="color:#999977">)</span><span>;</span></span><span><span>​</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> orders <span style="color:#770088">values</span></span><span><span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'ok'</span><span>,</span><span style="color:#116644">99.5</span><span>,</span><span style="color:#aa1111">'2023-10-17'</span><span>,</span><span style="color:#aa1111">'a'</span><span>,</span><span style="color:#aa1111">'b'</span><span>,</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'yy'</span><span style="color:#999977">)</span><span>,</span></span><span><span style="color:#999977">(</span><span style="color:#116644">2</span><span>,</span><span style="color:#116644">2</span><span>,</span><span style="color:#aa1111">'ok'</span><span>,</span><span style="color:#116644">109.2</span><span>,</span><span style="color:#aa1111">'2023-10-18'</span><span>,</span><span style="color:#aa1111">'c'</span><span>,</span><span style="color:#aa1111">'d'</span><span>,</span><span style="color:#116644">2</span><span>,</span><span style="color:#aa1111">'mm'</span><span style="color:#999977">)</span><span>,</span></span><span><span style="color:#999977">(</span><span style="color:#116644">3</span><span>,</span><span style="color:#116644">3</span><span>,</span><span style="color:#aa1111">'ok'</span><span>,</span><span style="color:#116644">99.5</span><span>,</span><span style="color:#aa1111">'2023-10-19'</span><span>,</span><span style="color:#aa1111">'a'</span><span>,</span><span style="color:#aa1111">'b'</span><span>,</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'yy'</span><span style="color:#999977">)</span><span>;</span></span><span><span>​</span></span><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#770088">IF</span><span style="color:#770088">NOT</span><span style="color:#770088">EXISTS</span> lineitem <span style="color:#999977">(</span></span><span>    l_orderkey    <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_partkey     <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_suppkey     <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_linenumber  <span>integer</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_quantity    decimalv3<span style="color:#999977">(</span><span style="color:#116644">15</span><span>,</span><span style="color:#116644">2</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_extendedprice  decimalv3<span style="color:#999977">(</span><span style="color:#116644">15</span><span>,</span><span style="color:#116644">2</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_discount    decimalv3<span style="color:#999977">(</span><span style="color:#116644">15</span><span>,</span><span style="color:#116644">2</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_tax         decimalv3<span style="color:#999977">(</span><span style="color:#116644">15</span><span>,</span><span style="color:#116644">2</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_returnflag  <span>char</span><span style="color:#999977">(</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_linestatus  <span>char</span><span style="color:#999977">(</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_shipdate    <span>date</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_commitdate  <span>date</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_receiptdate <span>date</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_shipinstruct <span>char</span><span style="color:#999977">(</span><span style="color:#116644">25</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_shipmode     <span>char</span><span style="color:#999977">(</span><span style="color:#116644">10</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span><span>,</span></span><span>    l_comment      <span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">44</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#221199">null</span></span><span><span style="color:#999977">)</span></span><span>    DUPLICATE <span style="color:#770088">KEY</span><span style="color:#999977">(</span>l_orderkey<span>,</span> l_partkey<span>,</span> l_suppkey<span>,</span> l_linenumber<span style="color:#999977">)</span></span><span><span style="color:#770088">PARTITION</span><span style="color:#770088">BY</span><span style="color:#770088">RANGE</span><span style="color:#999977">(</span>l_shipdate<span style="color:#999977">)</span></span><span><span style="color:#999977">(</span><span style="color:#770088">FROM</span><span style="color:#999977">(</span><span style="color:#aa1111">'2023-10-17'</span><span style="color:#999977">)</span><span style="color:#770088">TO</span><span style="color:#999977">(</span><span style="color:#aa1111">'2023-10-20'</span><span style="color:#999977">)</span><span style="color:#770088">INTERVAL</span><span style="color:#116644">1</span> DAY<span style="color:#999977">)</span></span><span>    DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span>l_orderkey<span style="color:#999977">)</span> BUCKETS <span style="color:#116644">3</span></span><span>    PROPERTIES <span style="color:#999977">(</span><span style="color:#aa1111">"replication_num"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"1"</span><span style="color:#999977">)</span><span>;</span></span><span><span>​</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> lineitem <span style="color:#770088">values</span></span><span><span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">2</span><span>,</span><span style="color:#116644">3</span><span>,</span><span style="color:#116644">4</span><span>,</span><span style="color:#116644">5.5</span><span>,</span><span style="color:#116644">6.5</span><span>,</span><span style="color:#116644">7.5</span><span>,</span><span style="color:#116644">8.5</span><span>,</span><span style="color:#aa1111">'o'</span><span>,</span><span style="color:#aa1111">'k'</span><span>,</span><span style="color:#aa1111">'2023-10-17'</span><span>,</span><span style="color:#aa1111">'2023-10-17'</span><span>,</span><span style="color:#aa1111">'2023-10-17'</span><span>,</span><span style="color:#aa1111">'a'</span><span>,</span><span style="color:#aa1111">'b'</span><span>,</span><span style="color:#aa1111">'yyyyyyyyy'</span><span style="color:#999977">)</span><span>,</span></span><span><span style="color:#999977">(</span><span style="color:#116644">2</span><span>,</span><span style="color:#116644">2</span><span>,</span><span style="color:#116644">3</span><span>,</span><span style="color:#116644">4</span><span>,</span><span style="color:#116644">5.5</span><span>,</span><span style="color:#116644">6.5</span><span>,</span><span style="color:#116644">7.5</span><span>,</span><span style="color:#116644">8.5</span><span>,</span><span style="color:#aa1111">'o'</span><span>,</span><span style="color:#aa1111">'k'</span><span>,</span><span style="color:#aa1111">'2023-10-18'</span><span>,</span><span style="color:#aa1111">'2023-10-18'</span><span>,</span><span style="color:#aa1111">'2023-10-18'</span><span>,</span><span style="color:#aa1111">'a'</span><span>,</span><span style="color:#aa1111">'b'</span><span>,</span><span style="color:#aa1111">'yyyyyyyyy'</span><span style="color:#999977">)</span><span>,</span></span><span><span style="color:#999977">(</span><span style="color:#116644">3</span><span>,</span><span style="color:#116644">2</span><span>,</span><span style="color:#116644">3</span><span>,</span><span style="color:#116644">6</span><span>,</span><span style="color:#116644">7.5</span><span>,</span><span style="color:#116644">8.5</span><span>,</span><span style="color:#116644">9.5</span><span>,</span><span style="color:#116644">10.5</span><span>,</span><span style="color:#aa1111">'k'</span><span>,</span><span style="color:#aa1111">'o'</span><span>,</span><span style="color:#aa1111">'2023-10-19'</span><span>,</span><span style="color:#aa1111">'2023-10-19'</span><span>,</span><span style="color:#aa1111">'2023-10-19'</span><span>,</span><span style="color:#aa1111">'c'</span><span>,</span><span style="color:#aa1111">'d'</span><span>,</span><span style="color:#aa1111">'xxxxxxxxx'</span><span style="color:#999977">)</span><span>;</span></span><span></span><span></span><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#770088">IF</span><span style="color:#770088">NOT</span><span style="color:#770088">EXISTS</span> partsupp <span style="color:#999977">(</span></span><span>  ps_partkey     <span>INTEGER</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span>,</span></span><span>  ps_suppkey     <span>INTEGER</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span>,</span></span><span>  ps_availqty    <span>INTEGER</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span>,</span></span><span>  ps_supplycost  DECIMALV3<span style="color:#999977">(</span><span style="color:#116644">15</span><span>,</span><span style="color:#116644">2</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span>,</span></span><span>  ps_comment     <span>VARCHAR</span><span style="color:#999977">(</span><span style="color:#116644">199</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span></span><span><span style="color:#999977">)</span></span><span>DUPLICATE <span style="color:#770088">KEY</span><span style="color:#999977">(</span>ps_partkey<span>,</span> ps_suppkey<span style="color:#999977">)</span></span><span>DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span>ps_partkey<span style="color:#999977">)</span> BUCKETS <span style="color:#116644">3</span></span><span>PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_num"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"1"</span></span><span><span style="color:#999977">)</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>創建物化視圖:</span></strong></span></p><pre><span><span style="color:#770088">CREATE</span> MATERIALIZED <span style="color:#770088">VIEW</span> mv1 </span><span>        BUILD DEFERRED REFRESH AUTO <span style="color:#770088">ON</span> MANUAL</span><span><span style="color:#770088">partition</span><span style="color:#770088">by</span><span style="color:#999977">(</span>l_shipdate<span style="color:#999977">)</span></span><span>        DISTRIBUTED <span style="color:#770088">BY</span> RANDOM BUCKETS <span style="color:#116644">2</span></span><span>        PROPERTIES <span style="color:#999977">(</span><span style="color:#aa1111">'replication_num'</span><span style="color:#981a1a">=</span><span style="color:#aa1111">'1'</span><span style="color:#999977">)</span></span><span><span style="color:#770088">AS</span></span><span><span style="color:#770088">select</span> l_shipdate<span>,</span> o_orderdate<span>,</span> l_partkey<span>,</span></span><span>            l_suppkey<span>,</span><span style="color:#770088">sum</span><span style="color:#999977">(</span>o_totalprice<span style="color:#999977">)</span><span style="color:#770088">as</span> sum_total</span><span><span style="color:#770088">from</span> lineitem</span><span><span style="color:#770088">left</span><span style="color:#770088">join</span> orders <span style="color:#770088">on</span> lineitem<span style="color:#0055aa">.l_orderkey</span><span style="color:#981a1a">=</span> orders<span style="color:#0055aa">.o_orderkey</span></span><span><span style="color:#770088">and</span> l_shipdate <span style="color:#981a1a">=</span> o_orderdate</span><span><span style="color:#770088">group</span><span style="color:#770088">by</span></span><span>            l_shipdate<span>,</span></span><span>            o_orderdate<span>,</span></span><span>            l_partkey<span>,</span></span><span>            l_suppkey<span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>目前異步物化視圖已經具備以下功能：</span></strong></span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>透明改寫加速：</span></strong></span><span> 支持常見算子的透明改寫，如 Select、Where、Join、Group by、Aggregation 等，可以直接通過建立物化視圖，對現有的查詢進行加速。例如在 BI 報表場景，某些報表查詢延時比較高，就可以通過建立合適的物化視圖進行加速。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>自動刷新：</span></strong></span><span> 物化視圖支持不同刷新策略，如定時刷新和手動刷新，也支持不同的刷新粒度，如全量刷新、分區粒度的增量刷新等。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>外表到內表的物化視圖：</span></strong></span><span> 可以對存放在 Hive、Hudi、Iceberg 等數據湖系統上的數據建立物化視圖，加速對數據湖的訪問，也可以通過物化視圖的方式將數據湖中的數據同步到 Apache Doris 內表中。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>物化視圖直查：</span></strong></span><span> 用戶也可以將物化視圖的構建看做 ETL 的過程，把物化視圖看做是 ETL 加工後的結果數據，由於物化視圖本身也是一個表，所以用戶可以直接查詢物化視圖。</span></p></li></ul><blockquote><p style="margin-left:.8em; margin-right:0"><span>演示 Demo: </span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1s2421T71z%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV1s2421T71z/?spm_id_from=333.999.0.0</span></a></span></p><p style="margin-left:0; margin-right:.8em"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fquery-acceleration%2Fasync-materialized-view%2F" target="_blank"><span>https://doris.apache.org/zh-CN/docs/query-acceleration/async-materialized-view/</span></a></span></p></blockquote><h2><span>存儲能力增強</span></h2><h3><span>自增列 AUTO_INCREMENT </span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>自增列 AUTO_INCREMENT 是 OLTP 數據庫中常見的一項功能，提供了一種方便高效的方式來為新插入的數據行自動分配唯一標識符。由於自增列的可用值分配涉及到全局事務，因此在分佈式 OLAP 數據庫中並不常見。在 Apache Doris 2.1 版本中，我們通過創新性的自增序列預分配策略，提供了高效的自增列實現。基於自增列的唯一性保證，用戶可以利用自增列實現高效的字典編碼和查詢分頁。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>字典編碼：</span></strong></span><span> 在進行 PV/UV 統計或人羣圈選等需要精確去重的查詢時，可以使用自增列對 UserID 或訂單 ID 等字符串值創建字典表，將用戶數據批量或者實時寫入字典表即可生成字典，根據各種維度的條件對對應的 Bitmap 進行聚合運算；</span></p><pre><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#0055aa">`demo`</span>.<span style="color:#0055aa">`dictionary_tbl`</span><span style="color:#999977">(</span></span><span><span style="color:#0055aa">`user_id`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">50</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span>,</span></span><span><span style="color:#0055aa">`aid`</span><span>BIGINT</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">AUTO_INCREMENT</span></span><span><span style="color:#999977">)</span><span style="color:#770088">ENGINE</span><span style="color:#981a1a">=</span>OLAP</span><span><span style="color:#770088">UNIQUE</span><span style="color:#770088">KEY</span><span style="color:#999977">(</span><span style="color:#0055aa">`user_id`</span><span style="color:#999977">)</span></span><span>DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span><span style="color:#0055aa">`user_id`</span><span style="color:#999977">)</span> BUCKETS <span style="color:#116644">32</span></span><span>PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_allocation"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"tag.location.default: 3"</span><span>,</span></span><span><span style="color:#aa1111">"enable_unique_key_merge_on_write"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"true"</span></span><span><span style="color:#999977">)</span><span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>查詢分頁</span></strong></span><span>：在頁面展示數據時，往往需要做分頁展示。傳統的分頁通常使用 SQL 中的 </span><span><code>limit</code></span><span>, </span><span><code>offset</code></span><span> + </span><span><code>order by</code></span><span> 進行查詢。在進行深分頁查詢時，即使查詢數據量較少、數據庫仍需將全部數據讀取至內存進行全量排序，查詢效率比較低下。採取自增列可以為每一行生成唯一標識、查詢時記住上一頁最大唯一標識並用於下一頁的查詢條件，實現更高效的分頁查詢。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>以下表為例，unique_value 是一個唯一值：</span></p><pre><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#0055aa">`demo`</span>.<span style="color:#0055aa">`records_tbl2`</span><span style="color:#999977">(</span></span><span><span style="color:#0055aa">`key`</span><span>int</span><span style="color:#999977">(</span><span style="color:#116644">11</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`name`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">26</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`address`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">41</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`city`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">11</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`nation`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">16</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`region`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">13</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`phone`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">16</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`mktsegment`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">11</span><span style="color:#999977">)</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">""</span><span>,</span></span><span><span style="color:#0055aa">`unique_value`</span><span>BIGINT</span><span style="color:#770088">NOT</span><span style="color:#221199">NULL</span><span style="color:#770088">AUTO_INCREMENT</span></span><span><span style="color:#999977">)</span> DUPLICATE <span style="color:#770088">KEY</span><span style="color:#999977">(</span><span style="color:#0055aa">`key`</span><span>,</span><span style="color:#0055aa">`name`</span><span style="color:#999977">)</span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span> ipv4_test <span style="color:#999977">(</span></span><span><span style="color:#0055aa">`id`</span><span>int</span><span>,</span></span><span><span style="color:#0055aa">`ip_v4`</span> ipv4</span><span><span style="color:#999977">)</span><span style="color:#770088">ENGINE</span><span style="color:#981a1a">=</span>OLAP</span><span>DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span><span style="color:#0055aa">`id`</span><span style="color:#999977">)</span> BUCKETS <span style="color:#116644">4</span></span><span>PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_allocation"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"tag.location.default: 1"</span></span><span><span style="color:#999977">)</span><span>;</span></span><span>DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span><span style="color:#0055aa">`key`</span><span style="color:#999977">)</span> BUCKETS <span style="color:#116644">10</span></span><span>PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_num"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"3"</span></span><span><span style="color:#999977">)</span><span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在分頁展示中，每頁展示 100 條數據，使用如下方式獲取第一頁的數據：</span></p><pre><span><span style="color:#770088">select</span><span style="color:#981a1a">*</span><span style="color:#770088">from</span> records_tbl2 <span style="color:#770088">order</span><span style="color:#770088">by</span> unique_value <span style="color:#770088">limit</span><span style="color:#116644">100</span><span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>通過程序記錄下返回結果中</span><span><code>unique_value</code></span><span>中的最大值，假設為 99，則可用如下方式查詢第二頁的數據：</span></p><pre><span><span style="color:#770088">select</span><span style="color:#981a1a">*</span><span style="color:#770088">from</span> records_tbl2 <span style="color:#770088">where</span> unique_value <span style="color:#981a1a">&gt;</span><span style="color:#116644">99</span><span style="color:#770088">order</span><span style="color:#770088">by</span> unique_value <span style="color:#770088">limit</span><span style="color:#116644">100</span><span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>如果要直接查詢一個靠後頁面的內容，此時不方便直接獲取之前頁面數據中</span><span><code>unique_value</code></span><span>的最大值時，例如要直接獲取第 101 頁的內容，則可以使用如下方式進行查詢</span></p><pre><span><span style="color:#770088">select</span><span style="color:#770088">key</span><span>,</span> name<span>,</span> address<span>,</span> city<span>,</span> nation<span>,</span> region<span>,</span> phone<span>,</span> mktsegment</span><span><span style="color:#770088">from</span> records_tbl2<span>,</span><span style="color:#999977">(</span><span style="color:#770088">select</span> unique_value <span style="color:#770088">as</span> max_value <span style="color:#770088">from</span> records_tbl2 <span style="color:#770088">order</span><span style="color:#770088">by</span> uniuqe_value <span style="color:#770088">limit</span><span style="color:#116644">1</span><span style="color:#770088">offset</span><span style="color:#116644">9999</span><span style="color:#999977">)</span><span style="color:#770088">as</span> previous_data</span><span><span style="color:#770088">where</span> records_tbl2<span style="color:#0055aa">.uniuqe_value</span><span style="color:#981a1a">&gt;</span> previous_data<span style="color:#0055aa">.max_value</span></span><span><span style="color:#770088">order</span><span style="color:#770088">by</span> unique_value <span style="color:#770088">limit</span><span style="color:#116644">100</span><span>;</span></span></pre><blockquote><p style="margin-left:.8em; margin-right:0"><span>演示 Demo：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1VC411h7Gr%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV1VC411h7Gr/?spm_id_from=333.999.0.0</span></a></span></p><p style="margin-left:0; margin-right:.8em"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fadvanced%2Fauto-increment" target="_blank"><span>https://doris.apache.org/zh-CN/docs/advanced/auto-increment</span></a></span></p></blockquote><h3><span>自動分區 Auto Partition</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.1 版本之前一直採取手動分區的形式，用戶需要提前把分區建立好，否則在導入數據過程中會因為找不到對應分區而出錯。而自動分區功能支持了在導入數據過程中自動檢測分區列的數據對應的分區是否存在。如果不存在，則會自動創建分區並正常進行導入。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>自動分區功能使用方式如下：</span></p><pre><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#0055aa">`DAILY_TRADE_VALUE`</span></span><span><span style="color:#999977">(</span></span><span><span style="color:#0055aa">`TRADE_DATE`</span>              datev2 <span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">'交易日期'</span><span>,</span></span><span><span style="color:#0055aa">`TRADE_ID`</span><span>varchar</span><span style="color:#999977">(</span><span style="color:#116644">40</span><span style="color:#999977">)</span><span style="color:#221199">NULL</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">'交易編號'</span><span>,</span></span><span>    ......</span><span><span style="color:#999977">)</span></span><span><span style="color:#770088">UNIQUE</span><span style="color:#770088">KEY</span><span style="color:#999977">(</span><span style="color:#0055aa">`TRADE_DATE`</span><span>,</span><span style="color:#0055aa">`TRADE_ID`</span><span style="color:#999977">)</span></span><span>AUTO <span style="color:#770088">PARTITION</span><span style="color:#770088">BY</span><span style="color:#770088">RANGE</span> date_trunc<span style="color:#999977">(</span><span style="color:#0055aa">`TRADE_DATE`</span><span>,</span><span style="color:#aa1111">'year'</span><span style="color:#999977">)</span></span><span><span style="color:#999977">(</span></span><span><span style="color:#999977">)</span></span><span>DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span><span style="color:#0055aa">`TRADE_DATE`</span><span style="color:#999977">)</span> BUCKETS <span style="color:#116644">10</span></span><span>PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_num"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"1"</span></span><span><span style="color:#999977">)</span><span>;</span></span></pre><blockquote><p style="margin-left:.8em; margin-right:0"><span>注意事項</span></p><ol><li><p style="margin-left:.5rem; margin-right:0"><span>當前自動分區功能僅支持一個分區列，並且分區列必須為 NOT NULL 列；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>自動分區當前已支持 Range 分區和 List 分區，其中 Range 分區函數僅支持 </span><span><code>date_trunc</code></span><span>、分區列僅支持 </span><span><code>DATE</code></span><span> 或者 </span><span><code>DATETIME</code></span><span> 格式；List 分區不支持函數調用，分區列支持 </span><span><code>BOOLEAN、TINYINT、SMALLINT、INT、BIGINT、LARGEINT、DATE、DATETIME、CHAR、VARCHAR</code></span><span> 數據類型，分區值為枚舉值；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>使用 List 分區時，一旦分區列的值當前不存在，自動分區功能都會為其創建一個獨立的新分區。</span></p></li></ol></blockquote><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start">&nbsp;</p><blockquote><p style="margin-left:0; margin-right:0"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fadvanced%2Fpartition%2Fauto-partition%2F" target="_blank"><span>https://doris.apache.org/zh-CN/docs/advanced/partition/auto-partition/</span></a></span></p></blockquote><h3><span>INSERT INTO SELECT 導入性能提升 100%</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><code>INSERT INTO…SELECT</code></span><span> 語句是 ETL 中最高頻使用的操作之一，可以快速完成數據在庫表之間的遷移、轉換以及清洗合併，提升 </span><span><code>INSERT INTO…SELECT</code></span><span> 性能可以更好滿足用戶對數據快速提取和分析的需求。在 Apache Doris 2.0 版本中，我們引入了單副本導入功能（Single Replica Load）來減少多副本的重複寫入和 Compaction 工作，但是導入性能還存在優化的空間。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.1 版本中，為了進一步提升</span><span><code>INSERT INTO…SELECT</code></span><span> 性能，我們實現了 MemTable 前移以進一步減少導入過程中的開銷，能在大多數場景中能在 2.0 版本的基礎上取得 100% 的導入性能提升。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="INSERT INTO SELECT 導入性能提升 100%" src="https://cdn.selectdb.com/static/2_1_doris_INSERT_INTO_SELECT_023366bc04.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>MemTable 前移和非前移的流程對比如上圖所示，Sink 節點不再發送編碼後的 Block，而是在本地處理完 MemTable 將生成的 Segment 數據發給下游節點，減少了數據多次編碼的開銷，同時使內存反壓更準確和及時。此外，我們使用了 Streaming RPC 來替代了 Ping-pong RPC ，減少了數據傳輸過程中的等待。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在此我們對 2.1 版本開啓 MemTable 前移後的導入性能進行了測試，測試環境如下：1 FE+3 BE、每個節點 16C 64G、3 塊高性能雲盤（保證磁盤 I/O 不成為瓶頸）</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>可以看到在單副本場景下，2.1 版本開啓 MemTable 前移後、導入耗時降低至 2.0 版本的 36%，三副本場景下導入耗時降低至 2.0 版本的 54%，整體導入性能提升超過 100%。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="2.1-insert-into-table.png" src="https://cdn.selectdb.com/static/2_1_insert_into_table_68699e4d2c.png" referrerpolicy="no-referrer"></span></p><blockquote><p style="margin-left:0; margin-right:0"><span>備註：MemTable 前移在 2.1 版本中默認開啓，用戶無需修改原有的導入命令即可獲得大幅性能提升。如果在使用過程中遇到問題、希望回退到原有的導入方式，可以在 MySQL 連接中設置環境變量 </span><span><code>enable_memtable_on_sink_node=false</code></span><span> 來關閉 MemTable 前移。</span></p></blockquote><h3><span>高頻實時導入/服務端攢批 Group Commit</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在數據導入過程中，不同批次導入的數據都會寫入內存表中，隨後在磁盤中上形成一個個 RowSet 文件，每個 Rowset 文件對應一次數據導入版本。後台 Compacttion 進程會自動對多個版本的 RowSet 文件進行合併，將多個 RowSet 小文件合併成 RowSet 大文件以優化查詢性能以及存儲空間，而每一次的 Compaction 進程都會產生對 CPU、內存以及磁盤 IO 資源的消耗。在實際數據寫入場景中，寫入越實時高頻、生成 RowSet 版本數越高、Compaction 所消耗的資源就越大。為了避免高頻寫入帶來的過多資源消耗甚至 OOM，Apache Doris 引入了反壓機制，即在版本過多的情況下會返回 -235 ，並對數據的版本數量進行控制。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="高頻實時導入/服務端攢批 Group Commit" src="https://cdn.selectdb.com/static/2_1_doris_group_commit_6aef2c3146.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>從 Apache Doris 2.1 版本開始，我們引入了服務端攢批 Group Commit，大幅強化了高併發、高頻實時寫入的能力。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>顧名思義， Group Commit 會把用戶側的多次寫入在 BE 端進行積攢後批量提交。對於用戶而言，無需控制寫入程序的頻率，Doris 會自動把用戶提交的多次寫入在內部合併為一個版本，從而可以大幅提升用戶側的寫入頻次。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="高頻實時導入/服務端攢批 Group Commit" src="https://cdn.selectdb.com/static/2_1_doris_group_commit_2_fb66f95a0f.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>當前 Group Commit 已經支持同步模式 </span><span><code>sync_mode</code></span><span> 和異步模式 </span><span><code>async_mode</code></span><span>。同步模式下會將多個導入在一個事務提交，事務提交後導入返回，在導入完成後數據立即可見。異步模式下數據會先寫入 WAL，Apache Doris 會根據負載和表的</span><span><code>group_commit_interval</code></span><span>屬性異步提交數據，提交之後數據可見。為了防止 WAL 佔用較大的磁盤空間，單次導入數據量較大時，會自動切換為</span><span><code>sync_mode</code></span><span>。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>我們分別採取 JDBC 和 Stream Load 兩種方式對高併發寫入場景下 Group Commit（異步模式 </span><span><code>async_mode</code></span><span>）的寫入性能進行了測試，測試報告如下：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>JDBC 寫入</span></strong></span><span>：</span></p><pre><code>&lt;ul style="margin-left:0; margin-right:0"&gt;
	&lt;li&gt;
	&lt;p style="margin-left:.5rem; margin-right:0"&gt;&lt;span&gt;集羣配置為 1FE 1BE，數據集為 TPC-H SF10 Lineitem 表，總共約 22GB、1.8 億行；&lt;/span&gt;
	&lt;/li&gt;
	&lt;li&gt;
	&lt;p style="margin-left:.5rem; margin-right:0"&gt;&lt;span&gt;經測試，在併發數 20、單次 Insert 數據行數 100 行下，導入效率達到 10.69w 行/秒、導入吞吐達 11.46 MB/秒， BE 節點的 CPU 使用率穩定保持在 10%-20%；&lt;/span&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p style="margin-left:.5rem; margin-right:0"&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Stream Load 寫入&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;：&lt;/span&gt;

&lt;ul style="margin-left:0; margin-right:0"&gt;
	&lt;li&gt;
	&lt;p style="margin-left:.5rem; margin-right:0"&gt;&lt;span&gt;集羣配置為 1FE 3BE，數據集為 httplogs、總共 31GB、2.47 億行。在未開啓 Group Commit 和，開啓 Group Commit 的異步模式時，通過設置不同的單併發數據量和併發數，對比數據的寫入性能。&lt;/span&gt;
	&lt;/li&gt;
	&lt;li&gt;
	&lt;p style="margin-left:.5rem; margin-right:0"&gt;&lt;span&gt;經測試，在併發數 10、單次導入數據量 1 MB 下，未開啓 Group Commit 時會提示 -235 錯誤，開啓後可穩定運行且導入效率達 81w 行/秒、導入吞吐達 104 MB/秒；在併發數 10、單次導入數據量 10MB 下，開啓 Group Commit 後耗時降低至原先的 55%、導入吞吐提升 79%；&lt;/span&gt;
	&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
</code></pre></li></ul><blockquote><p style="margin-left:.8em; margin-right:0"><span>演示 Demo：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1um411o7Ha%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV1um411o7Ha/?spm_id_from=333.999.0.0</span></a></span></p><p style="margin-left:0; margin-right:.8em"><span>參考文檔和完整測試報告：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fdata-operate%2Fimport%2Fimport-way%2Fgroup-commit-manual%2F" target="_blank"><span>https://doris.apache.org/zh-CN/docs/data-operate/import/import-way/group-commit-manual/</span></a></span></p></blockquote><h2><span>半結構化數據分析</span></h2><h3><span>Variant 數據類型</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>過去 Apache Doris 在應對複雜半結構化數據的存儲和分析處理時，一般有兩種方式：</span></p><ol><li><p style="margin-left:.5rem; margin-right:0"><span>一種方式是用戶提前預定好表結構，加工成寬表，在數據進入前將數據解析好，這種方案的優點是寫入性能好，查詢也不需要解析，但是使用不夠靈活、對錶結構發起變更增加運維、研發的成本。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>使用 Doris 中的 JSON 類型、或是存成 JSON String，將原始 JSON 數據不經過加工直接入庫， 查詢的時候，用解析函數處理。優點是不需要額外的數據加工、預定義表結構拍平嵌套結構，運維、研發方便，但存在解析性能以及數據讀取效率低下的問題。</span></p></li></ol><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>為瞭解決上述半結構化數據的挑戰，在 Apache Doris 2.1 版本中我們引入全新的數據類型</span><span><code>VARIANT</code></span><span>，支持存儲半結構化數據、允許存儲包含不同數據類型（如整數、字符串、布爾值等）的複雜數據結構，無需在表結構中提前定義具體的列，其存儲和查詢與傳統的 String、JSONB 等行存類型發生了本質的改變，期望其作為半結構化數據首選數據類型，給用戶帶來更加高效的數據處理機制。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>Variant 類型特別適用於處理結構可能隨時會發生變化的複雜嵌套結構。在寫入過程中，Variant 類型可以自動根據列的結構和類型推斷列信息，並將其合併到現有表的 Schema 中，將 JSON 鍵及其對應的值靈活存儲為動態子列。同時，一個表可以同時包含靈活的 Variant 對象列和預先定義類型的更嚴格的靜態列，從而在數據存儲、查詢上提供了更大的靈活性。除此之外，Variant 類型能夠與 Doris 核心特性融合，利用列式存儲、向量化引擎、優化器等技術，為用戶帶來極高性價比的查詢性能及存儲性能。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>使用方式如下：</span></strong></span></p><pre><span><span style="color:#aa5500">-- 無索引</span></span><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#770088">IF</span><span style="color:#770088">NOT</span><span style="color:#770088">EXISTS</span> $<span style="color:#999977">{</span><span style="color:#770088">table_name</span><span style="color:#999977">}</span><span style="color:#999977">(</span></span><span>    k <span>BIGINT</span><span>,</span></span><span>    v VARIANT</span><span><span style="color:#999977">)</span></span><span>table_properties<span>;</span></span><span><span>​</span></span><span><span style="color:#aa5500">-- 在 v 列創建索引，可選指定分詞方式，默認不分詞</span></span><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#770088">IF</span><span style="color:#770088">NOT</span><span style="color:#770088">EXISTS</span> $<span style="color:#999977">{</span><span style="color:#770088">table_name</span><span style="color:#999977">}</span><span style="color:#999977">(</span></span><span>    k <span>BIGINT</span><span>,</span></span><span>    v VARIANT<span>,</span></span><span><span style="color:#770088">INDEX</span> idx_var<span style="color:#999977">(</span>v<span style="color:#999977">)</span><span style="color:#770088">USING</span> INVERTED <span style="color:#999977">[</span>PROPERTIES<span style="color:#999977">(</span><span style="color:#aa1111">"parser"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"english|unicode|chinese"</span><span style="color:#999977">)]</span><span style="color:#999977">[</span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">'your comment'</span><span style="color:#999977">]</span></span><span><span style="color:#999977">)</span></span><span>table_properties<span>;</span></span><span><span>​</span></span><span><span style="color:#aa5500">-- 查詢，使用`[]`形式訪問子列</span></span><span><span style="color:#770088">SELECT</span> v<span style="color:#999977">[</span><span style="color:#aa1111">"properties"</span><span style="color:#999977">][</span><span style="color:#aa1111">"title"</span><span style="color:#999977">]</span><span style="color:#770088">from</span> $<span style="color:#999977">{</span><span style="color:#770088">table_name</span><span style="color:#999977">}</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>相比 JSON 類型的優勢</span></strong></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 中 JSON 類型是以二進制 JSONB 格式進行存儲，整行 JSON 以行存的形式存儲到 Segment 文件中。而 VARIANT 類型在寫入的時候進行類型推斷，將寫入的 JSON 列存化，查詢不需要進行解析。此外 Variant 類型針對稀疏場景的 JSON 進行優化，只提取頻繁出現的列，稀疏的列會以單獨的格式進行存儲。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>為了驗證引入 Variant 數據類型後在存儲以及查詢上所帶來的優勢，我們基於 ClickBench 測試數據集進行了存儲空間和查詢性能的測試。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在存儲空間方面，相同數據採取 Variant 類型，所佔用的存儲空間跟預定義的靜態列的存儲空間持平，相比於 JSON 類型則減少了約 65%。在一些低基數場景，由於列存的優勢，存儲資源的成本效應會更加明顯。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="2.1-comparied-to-Json.png" src="https://cdn.selectdb.com/static/2_1_comparied_to_Json_de6f7612dc.png" referrerpolicy="no-referrer"></span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在查詢性能方面，如下表可知，Variant 類型與預定義靜態列的查詢性能差異在 10% 左右；</span><span><strong><span>而對於 JSON 類型來説，Variant 類型的熱查詢速度相比於 JSON 類型提升了 8 倍以上，冷查詢有着數量級的提升。</span></strong></span><span>（由於 I/O 原因，JSONB 類型的冷查詢大部分超時）。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><img alt="2.1-comparied-to-Json-2.png" src="https://cdn.selectdb.com/static/2_1_comparied_to_Json_2_edcac40ac1.png" referrerpolicy="no-referrer"></span></p><blockquote><p style="margin-left:.8em; margin-right:0"><span><strong><span>注意事項：</span></strong></span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>目前 Variant 暫不支持 Aggregate 模型，也不支持將 Variant 類型作為 Unique 或 Duplicate 模型的主鍵及排序鍵；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>推薦使用 RANDOM 模式或者開啓 Group Commit 導入，寫入性能更高效；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>日期、Decimal 等非標準 JSON 類型儘可能提取出來作為靜態字段，性能更好；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>二維及其以上的數組以及數組嵌套對象，列存化會被存成 JSONB 編碼，性能不如原生數組；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>查詢過濾、聚合需要帶 Cast，存儲層會根據存儲類型和 Cast 目標類型來提示（hint）存儲引擎謂詞下推，加速查詢。</span></p></li></ul></blockquote><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start">&nbsp;</p><blockquote><p style="margin-left:.8em; margin-right:0"><span>演示 Demo: </span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV13u4m1g7ra%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV13u4m1g7ra/?spm_id_from=333.999.0.0</span></a></span></p><p style="margin-left:0; margin-right:.8em"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fsql-manual%2Fsql-reference%2FData-Types%2FVARIANT" target="_blank"><span>https://doris.apache.org/zh-CN/docs/sql-manual/sql-reference/Data-Types/VARIANT</span></a></span></p></blockquote><h3><span>IP 數據類型 </span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在網絡流量監控的場景中，IP 地址是一個常見的字段，大量的統計分析基於 IP 地址進行。在 Apache Doris 2.1 版本中，將原生支持 IPv4 和 IPv6 數據類型，用高效的二進制形式存儲 IP 數據。相比於使用明文的 IP String，內存和存儲空間可節省 60% 左右。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>同時基於 IP 類型，我們增加了常用的 20 多個 IP 處理函數，如：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>IPV4_NUM_TO_STRING：將類型為 Int16、Int32、Int64 且大端表示的 IPv4 的地址，返回相應 IPv4 的字符串表現形式；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>IPV4_CIDR_TO_RANGE：接收一個 IPv4 和一個包含 CIDR 的 Int16 值，返回一個結構體，其中包含兩個 IPv4 字段分別表示子網的較低範圍（min）和較高範圍（max）；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>INET_ATON：獲取包含 IPv4 地址的字符串，格式為 A.B.C.D（點分隔的十進制數字）</span></p></li></ul><blockquote><p style="margin-left:0; margin-right:0"><span>參考文檔： </span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fsql-manual%2Fsql-reference%2FData-Types%2FIPV6" target="_blank"><span>https://doris.apache.org/zh-CN/docs/sql-manual/sql-reference/Data-Types/IPV6</span></a></span></p></blockquote><h3><span>複雜數據類型分析函數完善</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.1 版本中我們豐富了行轉列和 IN 能支持的數據類型。如：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span><code>explode_map</code></span><span>：支持 MAP 類型數據行轉列（僅在新優化器中實現）</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>支持 Map 類型 Explode 行轉列，將 Map 字段的 N 個 Key Value 對展開成 N 行，每行的 Map 字段替換成 Key 和 Value 兩個字段。</span><span><code>explode_map</code></span><span> 需要和 Lateral View 一起使用，可以接多個 Lateral View, 結果則是每個 </span><span><code>explode_map</code></span><span> 之後的行數以笛卡爾積的形式展示。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>具體使用如下:</span></p><pre><span><span style="color:#aa5500">-- 建表語句</span></span><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#0055aa">`sdu`</span><span style="color:#999977">(</span></span><span><span style="color:#0055aa">`id`</span><span>INT</span><span style="color:#221199">NULL</span><span>,</span></span><span><span style="color:#0055aa">`name`</span><span>TEXT</span><span style="color:#221199">NULL</span><span>,</span></span><span><span style="color:#0055aa">`score`</span> MAP<span style="color:#981a1a">&lt;</span><span>TEXT</span><span>,</span><span>INT</span><span style="color:#981a1a">&gt;</span><span style="color:#221199">NULL</span></span><span><span style="color:#999977">)</span><span style="color:#770088">ENGINE</span><span style="color:#981a1a">=</span>OLAP</span><span>DUPLICATE <span style="color:#770088">KEY</span><span style="color:#999977">(</span><span style="color:#0055aa">`id`</span><span style="color:#999977">)</span></span><span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">'OLAP'</span></span><span>DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span><span style="color:#0055aa">`id`</span><span style="color:#999977">)</span> BUCKETS <span style="color:#116644">1</span></span><span>PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_allocation"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"tag.location.default: 1"</span></span><span><span style="color:#999977">)</span><span>;</span></span><span><span>​</span></span><span><span style="color:#aa5500">-- insert 數據</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> sdu <span style="color:#770088">values</span><span style="color:#999977">(</span><span style="color:#116644">0</span><span>,</span><span style="color:#aa1111">"zhangsan"</span><span>,</span><span style="color:#999977">{</span><span style="color:#aa1111">"Chinese"</span><span>:</span><span style="color:#aa1111">"80"</span><span>,</span><span style="color:#aa1111">"Math"</span><span>:</span><span style="color:#aa1111">"60"</span><span>,</span><span style="color:#aa1111">"English"</span><span>:</span><span style="color:#aa1111">"90"</span><span style="color:#999977">})</span><span>;</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> sdu <span style="color:#770088">values</span><span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">"lisi"</span><span>,</span><span style="color:#999977">{</span><span style="color:#aa1111">"null"</span><span>:</span><span style="color:#221199">null</span><span style="color:#999977">})</span><span>;</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> sdu <span style="color:#770088">values</span><span style="color:#999977">(</span><span style="color:#116644">2</span><span>,</span><span style="color:#aa1111">"wangwu"</span><span>,</span><span style="color:#999977">{</span><span style="color:#aa1111">"Chinese"</span><span>:</span><span style="color:#aa1111">"88"</span><span>,</span><span style="color:#aa1111">"Math"</span><span>:</span><span style="color:#aa1111">"90"</span><span>,</span><span style="color:#aa1111">"English"</span><span>:</span><span style="color:#aa1111">"96"</span><span style="color:#999977">})</span><span>;</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> sdu <span style="color:#770088">values</span><span style="color:#999977">(</span><span style="color:#116644">3</span><span>,</span><span style="color:#aa1111">"lisi2"</span><span>,</span><span style="color:#999977">{</span><span style="color:#221199">null</span><span>:</span><span style="color:#221199">null</span><span style="color:#999977">})</span><span>;</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> sdu <span style="color:#770088">values</span><span style="color:#999977">(</span><span style="color:#116644">4</span><span>,</span><span style="color:#aa1111">"amory"</span><span>,</span><span style="color:#221199">NULL</span><span style="color:#999977">)</span><span>;</span></span><span><span>​</span></span><span>mysql<span style="color:#981a1a">&gt;</span><span style="color:#770088">select</span> name<span>,</span> course_0<span>,</span> score_0 <span style="color:#770088">from</span> sdu lateral <span style="color:#770088">view</span> explode_map<span style="color:#999977">(</span>score<span style="color:#999977">)</span> tmp <span style="color:#770088">as</span> course_0<span>,</span>score_0<span>;</span></span><span><span style="color:#981a1a">+----------+----------+---------+</span></span><span><span style="color:#981a1a">|</span> name     <span style="color:#981a1a">|</span> course_0 <span style="color:#981a1a">|</span> score_0 <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------+----------+---------+</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> lisi     <span style="color:#981a1a">|</span><span style="color:#221199">null</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> lisi2    <span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------+----------+---------+</span></span><span><span>​</span></span><span>mysql<span style="color:#981a1a">&gt;</span><span style="color:#770088">select</span> name<span>,</span> course_0<span>,</span> score_0<span>,</span> course_1<span>,</span> score_1 <span style="color:#770088">from</span> sdu lateral <span style="color:#770088">view</span> explode_map<span style="color:#999977">(</span>score<span style="color:#999977">)</span> tmp <span style="color:#770088">as</span> course_0<span>,</span>score_0 lateral <span style="color:#770088">view</span> explode_map<span style="color:#999977">(</span>score<span style="color:#999977">)</span> tmp1 <span style="color:#770088">as</span> course_1<span>,</span>score_1<span>;</span></span><span><span style="color:#981a1a">+----------+----------+---------+----------+---------+</span></span><span><span style="color:#981a1a">|</span> name     <span style="color:#981a1a">|</span> course_0 <span style="color:#981a1a">|</span> score_0 <span style="color:#981a1a">|</span> course_1 <span style="color:#981a1a">|</span> score_1 <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------+----------+---------+----------+---------+</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> lisi     <span style="color:#981a1a">|</span><span style="color:#221199">null</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">null</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> lisi2    <span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------+----------+---------+----------+---------+</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><code>explode_map_outer</code></span><span> 和 </span><span><code>explode_outer</code></span><span> 的目的一致，可以將當前 MAP 類型的列中是 NULL 的數據行展示出來。</span></p><pre><span>mysql<span style="color:#981a1a">&gt;</span><span style="color:#770088">select</span> name<span>,</span> course_0<span>,</span> score_0 <span style="color:#770088">from</span> sdu lateral <span style="color:#770088">view</span> explode_map_outer<span style="color:#999977">(</span>score<span style="color:#999977">)</span> tmp <span style="color:#770088">as</span> course_0<span>,</span>score_0<span>;</span></span><span><span style="color:#981a1a">+----------+----------+---------+</span></span><span><span style="color:#981a1a">|</span> name     <span style="color:#981a1a">|</span> course_0 <span style="color:#981a1a">|</span> score_0 <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------+----------+---------+</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">80</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">60</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> zhangsan <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> lisi     <span style="color:#981a1a">|</span><span style="color:#221199">null</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Chinese  <span style="color:#981a1a">|</span><span style="color:#116644">88</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> Math     <span style="color:#981a1a">|</span><span style="color:#116644">90</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> wangwu   <span style="color:#981a1a">|</span> English  <span style="color:#981a1a">|</span><span style="color:#116644">96</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> lisi2    <span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> amory    <span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------+----------+---------+</span></span></pre><ul><li><p style="margin-left:.5rem; margin-right:0"><span>增加 IN 謂詞支持 Struct 類型數據的能力（僅在新優化器中實現）</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>IN 謂詞的左參數支持 </span><span><code>struct() function</code></span><span> 構建的 Struct 類型的數據，也支持 Select 某表中某一列是 Struct 類型的數據，右邊的參數支持一個由 </span><span><code>struct() function</code></span><span> 構建的 Struct 類型的數據的數組。IN 謂詞支持 Struct 類型可以有效替換 Where 條件中如果需要大量的 or 連詞連接的表達式，如： </span><span><code>(a = 1 and b = '2') or (a = 1 and b = '3') or (...)</code></span><span> 可以通過 IN 實現為 </span><span><code>struct(a,b) in (struct(1, '2'), struct(1, '3'), ...)</code></span></p><pre><span>mysql<span style="color:#981a1a">&gt;</span><span style="color:#770088">select</span> struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">"2"</span><span style="color:#999977">)</span><span style="color:#770088">in</span><span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">3</span><span style="color:#999977">)</span><span>,</span> struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">"2"</span><span style="color:#999977">)</span><span>,</span> struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span>,</span><span style="color:#221199">null</span><span style="color:#999977">)</span><span>;</span></span><span><span style="color:#981a1a">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><span><span style="color:#981a1a">|</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'2'</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)</span><span style="color:#770088">IN</span><span style="color:#999977">(</span><span style="color:#221199">NULL</span><span>,</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'2'</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)</span><span>,</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)</span><span>,</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">3</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">))</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><span><span style="color:#981a1a">|</span><span style="color:#116644">1</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><span>mysql<span style="color:#981a1a">&gt;</span><span style="color:#770088">select</span> struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">"2"</span><span style="color:#999977">)</span><span style="color:#770088">not</span><span style="color:#770088">in</span><span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">3</span><span style="color:#999977">)</span><span>,</span> struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">"2"</span><span style="color:#999977">)</span><span>,</span> struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span>,</span><span style="color:#221199">null</span><span style="color:#999977">)</span><span>;</span></span><span><span style="color:#981a1a">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><span><span style="color:#981a1a">|</span><span style="color:#999977">(</span><span style="color:#770088">not</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'2'</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)</span><span style="color:#770088">IN</span><span style="color:#999977">(</span><span style="color:#221199">NULL</span><span>,</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#aa1111">'2'</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)</span><span>,</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)</span><span>,</span> cast<span style="color:#999977">(</span>struct<span style="color:#999977">(</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">3</span><span style="color:#999977">)</span><span style="color:#770088">as</span> STRUCT<span style="color:#981a1a">&lt;</span>col1<span>:</span><span>TINYINT</span><span>,</span>col2<span>:</span><span>TEXT</span><span style="color:#981a1a">&gt;</span><span style="color:#999977">)))</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><span><span style="color:#981a1a">|</span><span style="color:#116644">0</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span></pre><ul><li><p style="margin-left:.5rem; margin-right:0"><span><code>MAP_AGG</code></span><span>： 接收 expr1 作為鍵，expr2 作為對應的值，返回一個 MAP </span></p></li></ul><blockquote><p style="margin-left:0; margin-right:0"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fsql-manual%2Fsql-functions%2Faggregate-functions%2Fmap-agg%2F" target="_blank"><span>https://doris.apache.org/zh-CN/docs/sql-manual/sql-functions/aggregate-functions/map-agg/</span></a></span></p></blockquote><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start">&nbsp;</p><h2><span>負載管理</span></h2><h3><span>資源硬隔離</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在 Apache Doris 2.0 版本我們引入了 Workload Group，可以實現對 CPU 資源的軟限制。Workload Group 軟限的優點是可以提升資源的利用率，但同時也會帶來查詢延遲的不確定性，這對那些期望查詢性能穩定性的用戶來説是難以接受的。因此在 Apache Doris 2.1 版本中我們對 Workload Group 實現了 CPU 硬限，即無論當前物理機的整體 CPU 是否空閒，配置了硬限的 Group 最大 CPU 用量不能超過配置的值。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>這意味着不管單機的資源是否充足，該 Workload Group 的最大可用 CPU 資源都是固定的，只要用戶的查詢負載不發生大的變化，那麼查詢性能就會相對穩定。由於影響一個查詢性能穩定性的因素很多，除了 CPU 之外，內存、IO 以及軟件層面的資源競爭也都會產生影響，因此當集羣的負載在空閒和滿載之間切換時，即使配置了 CPU 的硬限，查詢性能的穩定性也會產生波動，但是預期的表現應該是優於軟限制。</span></p><blockquote><p style="margin-left:.8em; margin-right:0"><span><strong><span>注意事項</span></strong></span></p><ol><li><p style="margin-left:.5rem; margin-right:0"><span>Doris 2.0 版本的 CPU 隔離是基於優先級隊列實現的，而在 2.1 版本中 Apache Doris 是基於 CGroup 實現了 CPU 資源的隔離，因此從 2.0 版本升級到 2.1 版本時，需要在使用前完成 CGroup 的配置，詳細注意事項參考官網文檔。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>目前 Workload Group 支持的工作負載類型包括查詢間的隔離以及導入與查詢之間的隔離，需要注意的是如果期望對導入負載進行徹底的限制，那麼需要開啓 MemTable 前移。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>用戶需要通過開關指定當前集羣的 CPU 限制模式是軟限還是硬限，暫不支持兩種模式同時運行，兩種模式的切換可以參考官網文檔，後續我們也會根據用戶的實際需求決定是否要同時支持這兩種模式。</span></p></li></ol></blockquote><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start">&nbsp;</p><blockquote><p style="margin-left:.8em; margin-right:0"><span>演示 Demo：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1Fz421X7XE%2F%3Fspm_id_from%3D333.999.0.0" target="_blank"><span>https://www.bilibili.com/video/BV1Fz421X7XE/?spm_id_from=333.999.0.0</span></a></span></p><p style="margin-left:0; margin-right:.8em"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fadmin-manual%2Fworkload-group%2F" target="_blank"><span>https://doris.apache.org/zh-CN/docs/admin-manual/workload-group/</span></a></span></p></blockquote><h3><span>TopSQL</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>當集羣出現預期外的大查詢導致集羣整體負載上升、查詢可用性下降時，用戶難以快速找到這些大查詢並進行相應的降級操作。因此在 Apache Doris 2.1 版本中我們支持了運行時查看 SQL 資源用量的功能，具體指標如下：</span></p><pre><span>mysql <span style="color:#999977">[(</span>none<span style="color:#999977">)]</span><span style="color:#981a1a">&gt;</span><span style="color:#770088">desc</span><span style="color:#770088">function</span> active_queries<span style="color:#999977">()</span><span>;</span></span><span><span style="color:#981a1a">+------------------------+--------+------+-------+---------+-------+</span></span><span><span style="color:#981a1a">|</span><span style="color:#770088">Field</span><span style="color:#981a1a">|</span> Type   <span style="color:#981a1a">|</span><span style="color:#221199">Null</span><span style="color:#981a1a">|</span><span style="color:#770088">Key</span><span style="color:#981a1a">|</span><span style="color:#770088">Default</span><span style="color:#981a1a">|</span> Extra <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+------------------------+--------+------+-------+---------+-------+</span></span><span><span style="color:#981a1a">|</span> BeHost                 <span style="color:#981a1a">|</span><span>TEXT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> BePort                 <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> QueryId                <span style="color:#981a1a">|</span><span>TEXT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> StartTime              <span style="color:#981a1a">|</span><span>TEXT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> QueryTimeMs            <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> WorkloadGroupId        <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> QueryCpuTimeMs         <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> ScanRows               <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> ScanBytes              <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> BePeakMemoryBytes      <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> CurrentUsedMemoryBytes <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> ShuffleSendBytes       <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> ShuffleSendRows        <span style="color:#981a1a">|</span><span>BIGINT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span><span style="color:#770088">Database</span><span style="color:#981a1a">|</span><span>TEXT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span> FrontendInstance       <span style="color:#981a1a">|</span><span>TEXT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span><span style="color:#770088">Sql</span><span style="color:#981a1a">|</span><span>TEXT</span><span style="color:#981a1a">|</span><span style="color:#770088">No</span><span style="color:#981a1a">|</span><span style="color:#221199">false</span><span style="color:#981a1a">|</span><span style="color:#221199">NULL</span><span style="color:#981a1a">|</span> NONE  <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+------------------------+--------+------+-------+---------+-------+</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><code>active_queries()</code></span><span> 函數記錄了查詢在各個 BE 上運行時的審計信息，該函數可以當做普通的 Doris 表來看待，支持查詢、謂詞過濾、排序和 Join 等操作。常用的指標包括 SQL 的運行時間、CPU 時間、單 BE 的峯值內存、Scan 的數據量以及 Shuffle 的數據量，也可以從 BE 的粒度做上卷，查看 SQL 全局的資源用量。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>需要注意的是這裏只顯示運行時的 SQL，查詢結束的 SQL 不會在這裏顯示，而是寫入審計日誌中（目前主要是 fe.audit.log）。常用的 SQL 如下：</span></p><pre><span>查看集羣中目前運行時間最久的 n 個 sql</span><span><span style="color:#770088">select</span> QueryId<span>,</span><span style="color:#770088">max</span><span style="color:#999977">(</span>QueryTimeMs<span style="color:#999977">)</span><span style="color:#770088">as</span> query_time <span style="color:#770088">from</span> active_queries<span style="color:#999977">()</span><span style="color:#770088">group</span><span style="color:#770088">by</span> QueryId <span style="color:#770088">order</span><span style="color:#770088">by</span> query_time <span style="color:#770088">desc</span><span style="color:#770088">limit</span><span style="color:#116644">10</span><span>;</span></span><span><span>​</span></span><span>查看目前集羣中 CPU 耗時最長的 n 個 sql</span><span><span style="color:#770088">select</span> QueryId<span>,</span><span style="color:#770088">sum</span><span style="color:#999977">(</span>QueryCpuTimeMs<span style="color:#999977">)</span><span style="color:#770088">as</span> cpu_time <span style="color:#770088">from</span> active_queries<span style="color:#999977">()</span><span style="color:#770088">group</span><span style="color:#770088">by</span> QueryId <span style="color:#770088">order</span><span style="color:#770088">by</span> cpu_time <span style="color:#770088">desc</span><span style="color:#770088">limit</span><span style="color:#116644">10</span></span><span><span>​</span></span><span>查看目前集羣中 scan 行數最多的 n 個 sql 以及他們的運行時間</span><span><span style="color:#770088">select</span> t1<span style="color:#0055aa">.QueryId</span><span>,</span>t1<span style="color:#0055aa">.scan_rows</span><span>,</span> t2<span style="color:#0055aa">.query_time</span><span style="color:#770088">from</span></span><span><span style="color:#999977">(</span><span style="color:#770088">select</span> QueryId<span>,</span><span style="color:#770088">sum</span><span style="color:#999977">(</span>ScanRows<span style="color:#999977">)</span><span style="color:#770088">as</span> scan_rows <span style="color:#770088">from</span> active_queries<span style="color:#999977">()</span><span style="color:#770088">group</span><span style="color:#770088">by</span> QueryId <span style="color:#770088">order</span><span style="color:#770088">by</span> scan_rows <span style="color:#770088">desc</span><span style="color:#770088">limit</span><span style="color:#116644">10</span><span style="color:#999977">)</span> t1 </span><span><span style="color:#770088">left</span><span style="color:#770088">join</span><span style="color:#999977">(</span><span style="color:#770088">select</span> QueryId<span>,</span><span style="color:#770088">max</span><span style="color:#999977">(</span>QueryTimeMs<span style="color:#999977">)</span><span style="color:#770088">as</span> query_time <span style="color:#770088">from</span> active_queries<span style="color:#999977">()</span><span style="color:#770088">group</span><span style="color:#770088">by</span> QueryId<span style="color:#999977">)</span> t2 <span style="color:#770088">on</span> t1<span style="color:#0055aa">.QueryId</span><span style="color:#981a1a">=</span> t2<span style="color:#0055aa">.QueryId</span></span><span></span><span>查看目前各個 BE 的負載情況，按照 CPU 時間/scan 行數/shuffle 字節數降序排列</span><span><span style="color:#770088">select</span> BeHost<span>,</span><span style="color:#770088">sum</span><span style="color:#999977">(</span>QueryCpuTimeMs<span style="color:#999977">)</span><span style="color:#770088">as</span> query_cpu_time<span>,</span><span style="color:#770088">sum</span><span style="color:#999977">(</span>ScanRows<span style="color:#999977">)</span><span style="color:#770088">as</span> scan_rows<span>,</span><span style="color:#770088">sum</span><span style="color:#999977">(</span>ShuffleSendBytes<span style="color:#999977">)</span><span style="color:#770088">as</span> shuffle_bytes <span style="color:#770088">from</span> active_queries<span style="color:#999977">()</span><span style="color:#770088">group</span><span style="color:#770088">by</span> BeHost <span style="color:#770088">order</span><span style="color:#770088">by</span> query_cpu_time <span style="color:#770088">desc</span><span>,</span>scan_rows <span style="color:#770088">desc</span><span>,</span>shuffle_bytes <span style="color:#770088">desc</span><span style="color:#770088">limit</span><span style="color:#116644">10</span></span><span><span>​</span></span><span>查看單 BE 峯值內存最高的 N 個 sql</span><span><span style="color:#770088">select</span> QueryId<span>,</span><span style="color:#770088">max</span><span style="color:#999977">(</span>BePeakMemoryBytes<span style="color:#999977">)</span><span style="color:#770088">as</span> be_peak_mem <span style="color:#770088">from</span> active_queries<span style="color:#999977">()</span><span style="color:#770088">group</span><span style="color:#770088">by</span> QueryId <span style="color:#770088">order</span><span style="color:#770088">by</span> be_peak_mem <span style="color:#770088">desc</span><span style="color:#770088">limit</span><span style="color:#116644">10</span><span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>目前主要展示的負載類型包括 Select 和</span><span><code>Insert Into……Select</code></span><span>，預計在 2.1 版本之上的三位迭代版本中會支持 Stream Load 和 Broker Load 的資源用量展示。</span></p><blockquote><p style="margin-left:0; margin-right:0"><span>參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fsql-manual%2Fsql-functions%2Ftable-functions%2Factive_queries%2F" target="_blank"><span>https://doris.apache.org/zh-CN/docs/sql-manual/sql-functions/table-functions/active_queries/</span></a></span></p></blockquote><h2><span>其他</span></h2><h3><span>Decimal256 </span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>為了更好的滿足金融類或者財務類客戶以及一些高端製造業客戶對於數字類型進行精確計算的需求，2.1 新版本中提供了更高精度的 Decimal 數據類型，最高支持 76 位有效數字（該類型處於 Experimental 狀態，需要手工開啓配置項 set enable_decimal256=true 才能使用）。</span></p><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>示例：</span></p><pre><span><span style="color:#770088">CREATE</span><span style="color:#770088">TABLE</span><span style="color:#0055aa">`test_arithmetic_expressions_256`</span><span style="color:#999977">(</span></span><span>      k1 <span>decimal</span><span style="color:#999977">(</span><span style="color:#116644">76</span><span>,</span><span style="color:#116644">30</span><span style="color:#999977">)</span><span>,</span></span><span>      k2 <span>decimal</span><span style="color:#999977">(</span><span style="color:#116644">76</span><span>,</span><span style="color:#116644">30</span><span style="color:#999977">)</span></span><span><span style="color:#999977">)</span></span><span>    DISTRIBUTED <span style="color:#770088">BY</span><span style="color:#770088">HASH</span><span style="color:#999977">(</span>k1<span style="color:#999977">)</span></span><span>    PROPERTIES <span style="color:#999977">(</span></span><span><span style="color:#aa1111">"replication_num"</span><span style="color:#981a1a">=</span><span style="color:#aa1111">"1"</span></span><span><span style="color:#999977">)</span><span>;</span></span><span><span>​</span></span><span><span style="color:#770088">insert</span><span style="color:#770088">into</span> test_arithmetic_expressions_256 <span style="color:#770088">values</span></span><span><span style="color:#999977">(</span><span style="color:#116644">1.000000000000000000000000000001</span><span>,</span><span style="color:#116644">9999999999999999999999999999999999999999999998.999999999999999999999999999998</span><span style="color:#999977">)</span><span>,</span></span><span><span style="color:#999977">(</span><span style="color:#116644">2.100000000000000000000000000001</span><span>,</span><span style="color:#116644">4999999999999999999999999999999999999999999999.899999999999999999999999999998</span><span style="color:#999977">)</span><span>,</span></span><span><span style="color:#999977">(</span><span style="color:#116644">3.666666666666666666666666666666</span><span>,</span><span style="color:#116644">3333333333333333333333333333333333333333333333.333333333333333333333333333333</span><span style="color:#999977">)</span><span>;</span></span></pre><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>查詢語句及結果：</span></p><pre><span><span style="color:#770088">select</span> k1<span>,</span> k2<span>,</span> k1 <span style="color:#981a1a">+</span> k2 a <span style="color:#770088">from</span> test_arithmetic_expressions_256 <span style="color:#770088">order</span><span style="color:#770088">by</span><span style="color:#116644">1</span><span>,</span><span style="color:#116644">2</span><span>;</span></span><span><span style="color:#981a1a">+----------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+</span></span><span><span style="color:#981a1a">|</span> k1                               <span style="color:#981a1a">|</span> k2                                                                            <span style="color:#981a1a">|</span> a                                                                             <span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+</span></span><span><span style="color:#981a1a">|</span><span style="color:#116644">1.000000000000000000000000000001</span><span style="color:#981a1a">|</span><span style="color:#116644">9999999999999999999999999999999999999999999998.999999999999999999999999999998</span><span style="color:#981a1a">|</span><span style="color:#116644">9999999999999999999999999999999999999999999999.999999999999999999999999999999</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span><span style="color:#116644">2.100000000000000000000000000001</span><span style="color:#981a1a">|</span><span style="color:#116644">4999999999999999999999999999999999999999999999.899999999999999999999999999998</span><span style="color:#981a1a">|</span><span style="color:#116644">5000000000000000000000000000000000000000000001.999999999999999999999999999999</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">|</span><span style="color:#116644">3.666666666666666666666666666666</span><span style="color:#981a1a">|</span><span style="color:#116644">3333333333333333333333333333333333333333333333.333333333333333333333333333333</span><span style="color:#981a1a">|</span><span style="color:#116644">3333333333333333333333333333333333333333333336.999999999999999999999999999999</span><span style="color:#981a1a">|</span></span><span><span style="color:#981a1a">+----------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+</span></span><span><span style="color:#116644">3</span> rows <span style="color:#770088">in</span><span style="color:#770088">set</span><span style="color:#999977">(</span><span style="color:#116644">0.09</span> sec<span style="color:#999977">)</span></span></pre><blockquote><p style="margin-left:0; margin-right:0"><span><strong><span>注意事項</span></strong></span><span> :Decimal256 類型對於計算 CPU 的消耗更高，因此在性能上會有一些損耗。</span></p></blockquote><h3><span>任務調度 Job Scheduler</span></h3><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>同社區用戶多次交流中，我們發現許多場景下用戶使用 Apache Doris 時都存在定時調度的需求，例如：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>週期性的 Backup；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>過期數據定時清理；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>週期性的導入任務，如定時通過 Catalog 的方式去進行增量或全量數據同步；</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>定期 ETL，如部分用戶定期從寬表中 Load 數據至指定表、從明細表中定時拉取數據存至聚合表、ODS 層表定時打寬並寫入原有寬表更新；</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>儘管諸如 Airflow、DolphinScheduler 等可供選擇的外部調度系統非常多，但仍面臨一致性的問題——在極端情況下，外部調度系統觸發 Doris 導入任務並執行成功，因意外情況忽然宕機時，外部調度系統無法正確獲取執行結果，會認為此次調度失敗，導致觸發調度系統的容錯機制，通常是重試或者直接失敗。而無論採用哪種策略，最終都會導致以下幾個情況發生：</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>資源浪費</span></strong></span><span>：由於調度系統誤認為任務失敗，可能會重新調度執行已經成功的任務，導致不必要的資源消耗。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>數據重複或丟失</span></strong></span><span>：如果調度系統選擇重試導入任務，可能導致數據重複導入，造成數據冗餘和不一致。另一方面，如果調度系統直接標記任務為失敗，可能導致實際已成功導入的數據被忽略或丟失。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>時間延誤</span></strong></span><span>：由於調度系統的容錯機制被觸發，可能需要進行額外的任務調度和重試，導致整體數據處理時間延長，影響業務效率和響應速度。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>系統穩定性下降</span></strong></span><span>：頻繁的重試或直接失敗可能導致調度系統和 Doris 的負載增加，進而影響系統的穩定性和性能。</span></p></li></ul><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>因此我們在 Apache Doris 2.1 版本中引入了 Job Scheduler 功能並具備了自行任務調度的能力。Doris Job Scheduler 是根據既定計劃運行的任務，用於在特定時間或指定時間間隔觸發預定義的操作，從而幫助我們自動執行一些任務。從功能上來講，它類似於操作系統上的定時任務（如：Linux 中的 cron、Windows 中的計劃任務），但 Doris 的 Job 調度可以精確到秒級。對於導入場景，我們能夠做到完全的一致性保障。除此之外，Doris 內置的 Jon Scheduler 還具有以下特點：</span></p><ol><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>高效調度</span></strong></span><span>：Job Scheduler 可以在指定的時間間隔內安排任務和事件，確保數據處理的高效性。採用時間輪算法保證事件能夠精準做到秒級觸發。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>靈活調度</span></strong></span><span>：Job Scheduler 提供了多種調度選項，如按，分、小時、天或周的間隔進行調度，同時支持一次性調度以及循環（週期）事件調度，並且週期調度也可以指定開始時間、結束時間。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>事件池和高性能處理隊列</span></strong></span><span>：Job Scheduler 採用 Disruptor 實現高性能的生產消費者模型，最大可能的避免任務執行過載。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>調度記錄可追溯</span></strong></span><span>：Job Scheduler 會存儲最新的 Task 執行記錄（可配置），通過簡單的命令即可查看任務執行記錄，確保過程可追溯。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><strong><span>高可用</span></strong></span><span>：依託於 Doris 自身的高可用機制，Job 可以很輕鬆的做到自恢復，高可用。</span></p></li></ol><p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>在此我們創建一個定時調度任務作為示例：</span></p><pre><span>// 從  <span style="color:#116644">2023</span><span style="color:#981a1a">-</span><span style="color:#116644">11</span><span style="color:#981a1a">-</span><span style="color:#116644">17</span> 起每天定時執行 <span style="color:#770088">insert</span>語句直到 <span style="color:#116644">2038</span> 年結束</span><span><span style="color:#770088">CREATE</span></span><span>JOB e_daily</span><span><span style="color:#770088">ON</span><span style="color:#770088">SCHEDULE</span></span><span><span style="color:#770088">EVERY</span><span style="color:#116644">1</span> DAY </span><span><span style="color:#770088">STARTS</span><span style="color:#aa1111">'2023-11-17 23:59:00'</span></span><span><span style="color:#770088">ENDS</span><span style="color:#aa1111">'2038-01-19 03:14:07'</span></span><span><span style="color:#770088">COMMENT</span><span style="color:#aa1111">'Saves total number of sessions'</span></span><span><span style="color:#770088">DO</span></span><span><span style="color:#770088">INSERT</span><span style="color:#770088">INTO</span> site_activity<span style="color:#0055aa">.totals</span><span style="color:#999977">(</span><span>time</span><span>,</span> total<span style="color:#999977">)</span></span><span><span style="color:#770088">SELECT</span><span style="color:#770088">CURRENT_TIMESTAMP</span><span>,</span><span style="color:#770088">COUNT</span><span style="color:#999977">(</span><span style="color:#981a1a">*</span><span style="color:#999977">)</span></span><span><span style="color:#770088">FROM</span> site_activity<span style="color:#0055aa">.sessions</span><span style="color:#770088">where</span> create_time <span style="color:#981a1a">&gt;=</span>  days_add<span style="color:#999977">(</span>now<span style="color:#999977">()</span><span>,</span><span style="color:#981a1a">-</span><span style="color:#116644">1</span><span style="color:#999977">)</span><span>;</span></span></pre><blockquote><p style="margin-left:0; margin-right:0"><span>注意：當前 Job Scheduler 僅支持 Insert 內表，參考文檔：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fzh-CN%2Fdocs%2Fsql-manual%2Fsql-reference%2FData-Definition-" target="_blank"><span>https://doris.apache.org/zh-CN/docs/sql-manual/sql-reference/Data-Definition-Statements/Create/CREATE-JOB</span></a></span></p></blockquote><h2><span>Behavior Changed</span></h2><ul><li><p style="margin-left:.5rem; margin-right:0"><span>Unique Key 模型默認開啓 Merge On Write 寫時合併，新創建的 Unique Key 模型的表將自動設置 </span><span><code>enable_unique_key_merge_on_write=true</code></span><span>。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>倒排索引 Invert Index 經過一年多時間的打磨，已實現了對原本的位圖索引 Bitmap Index 功能和場景的全覆蓋，且功能上和性能上都大幅優於原本的位圖索引 Bitmap Index，因此從 Apache Doris 2.1 版本起，我們將默認停止對位圖索引 Bitmap Index 的支持，已經創建的位圖索引保持不變將繼續生效，不允許創建新的位圖索引，在未來我們將會移除位圖索引的相關代碼。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span><code>cpu_resource_limit</code></span><span>不再支持，其本身是限制 BE 上 Scanner 線程數目的功能，而 Workload Group 也能支持設置 BE Scanner 線程數目，所以已設置的 </span><span><code>cpu_resource_limit</code></span><span>將失效。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>Segment Compaction 主要應對單批次大數據量的導入，可以在同一批次數據中進行多個 Segment 的 Compaction 操作，在 2.1 版本開始 Segment Compaction 將默認開啓，</span><span><code>enable_segcompaction</code></span><span> 默認值設置為 True。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>Audit Log 插件</span></p><ul><li><p style="margin-left:.5rem; margin-right:0"><span>從 2.1 版本開始，Apache Doris 開始內置 Audit Log 審計日誌插件，用戶只需通過設置全局變量 </span><span><code>enable_audit_plugin</code></span><span> 開啓或關閉審計日誌功能。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>對於之前已經安裝過審計日誌插件的用戶，升級後可以繼續使用原有插件，也可以通過 uninstall 命令卸載原有插件後，使用新的插件。但注意，切換插件後，審計日誌表也將切換到新的表中。</span></p></li><li><p style="margin-left:.5rem; margin-right:0"><span>具體可參閲：</span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoris.apache.org%2Fdocs%2Fecosystem%2Faudit-plugin%2F" target="_blank"><span>https://doris.apache.org/docs/ecosystem/audit-plugin/</span></a></span></p></li></ul></li></ul></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 09:54:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282597/apache-doris-2-1-0-released</guid>
            <link>https://www.oschina.net/news/282597/apache-doris-2-1-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[無魚 1.2.1 已經發布，項目工時系統]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p>無魚 1.2.1 已經發布，項目工時系統</p><p>此版本更新內容包括：</p><p>工時系統標準版 v1.2.1 已經發布， 此版本更新內容包括：</p><h2>變更內容</h2><p>1、修復了請假/倒休的 bug （1.2.0） 修改了請假/倒休後，再進行取消後的錯誤問題。</p><p>2、修復項目管理的路徑訪問問題</p><p>3、修改了某些情況下填報記錄無法打開的問題（羣友反饋）</p><h2>使用方法</h2><p>建議使用 compose 方式部署。 <a href="https://gitee.com/link?target=https%3A%2F%2Fdoc.wuyusoft.com%2Fcost%2F5.install.html" target="_blank">部署方式</a></p><p>詳情查看：<a href="https://gitee.com/wy-soft/wyproject/releases/1.2.1">https://gitee.com/wy-soft/wyproject/releases/1.2.1</a></p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 08:50:37 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282585</guid>
            <link>https://www.oschina.net/news/282585</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[KeePassXC 2.7.7 發佈]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">KeePassXC&nbsp;&nbsp;是由 KeePass 密碼管理器的一個分支發展而來的，相比原版 KeePass，KeePassXC 除了適配 Windows，還適配了 Linux 和 macOS。</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">通過&nbsp;KeePassXC&nbsp;可以存儲和管理個人的敏感信息。保存在 KeePassXC 上的信息全部都會進行離線加密，藉助於雲存儲服務可以實現跨平台同步。</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">KeePassXC 2.7.7 現已發佈，本次更新內容如下：</p><p style="text-align:start"><strong>Changes</strong></p><ul><li>支持&nbsp;USB Hotplug for Hardware Key interface&nbsp; [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10092" target="_blank">#10092</a>&nbsp;]</li><li>支持 1PUX 和 Bitwarden 導入 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9815" target="_blank">#9815</a>&nbsp;]</li><li>Browser：添加對 PassKeys 的支持 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F8825" target="_blank">#8825</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9987" target="_blank">#9987</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10318" target="_blank">#10318</a>&nbsp;]</li><li>Build System：移至 vcpkg 清單模式 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10088" target="_blank">#10088</a>&nbsp;]</li></ul><p style="text-align:start"><strong>Fixes</strong></p><ul><li>修復多個 TOTP 問題 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9874" target="_blank">#9874</a>&nbsp;]</li><li>修復編輯器不再可見時保存時 focus loss 的問題 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10075" target="_blank">#10075</a>&nbsp;]</li><li>修復從歷史記錄中刪除條目時的視覺效果 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9947" target="_blank">#9947</a>&nbsp;]</li><li>修復執行搜索時未選擇第一個條目的問題 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9868" target="_blank">#9868</a>&nbsp;]</li><li>防止條目拖放時出現滾動條[&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9747" target="_blank">#9747</a>&nbsp;]</li><li>防止密碼生成器的「Also choose from」字段中出現重複字符 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9803" target="_blank">#9803</a>&nbsp;]</li><li>安全性：防止逐字節和附件推斷側信道攻擊[&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10266" target="_blank">#10266</a>&nbsp;]</li><li>Browser：修復返回憑據時的錯誤[&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9136" target="_blank">#9136</a>&nbsp;]</li><li>Browser：修復從瀏覽器打開數據庫時的崩潰問題[&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9939" target="_blank">#9939</a>&nbsp;]</li><li>Browser：修復對引用 URL 字段的支持 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F8788" target="_blank">#8788</a>&nbsp;]</li><li>MacOS：修復更改 highlight/accent color 時的崩潰[&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10348" target="_blank">#10348</a>&nbsp;]</li><li>MacOS：修復 TouchID 外觀取決於 lid open/closed 的問題 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10092" target="_blank">#10092</a>&nbsp;]</li><li>Windows：修復使用 MSI 安裝程序終止 KeePassXC 進程的問題 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F9822" target="_blank">#9822</a>&nbsp;]</li><li>FdoSecrets：修復啓用時數據庫合併崩潰的問題 [&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Fpull%2F10136" target="_blank">#10136</a>&nbsp;]</li></ul><p>更新説明：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fkeepassxreboot%2Fkeepassxc%2Freleases%2Ftag%2F2.7.7" target="_blank">https://github.com/keepassxreboot/keepassxc/releases/tag/2.7.7</a></p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 08:19:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282576/keepassxc-2-7-7-released</guid>
            <link>https://www.oschina.net/news/282576/keepassxc-2-7-7-released</link>
            <author>
                <![CDATA[來源: OSCHINA]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[凌夕文件管理系統 v1.0.0-beta 發佈 - 音視頻、文檔在線轉碼服務]]>
            </title>
            <description>
                <![CDATA[<div class="content"><div><h4>軟件簡介</h4></div><div><div><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">凌夕文件管理系統（lfs）是基於 SpringBoot3.x+Mybatis+Mybatis-Plus+VUE3+Element Plus 開發的文件管理系統， 支持單文件上傳、分片上傳，視頻上傳完成後，可以根據視頻轉碼配置轉成對應的視頻格式（mp4、m3u8），文檔上傳完成後，會轉成 pdf 文件， 支持 word、excel、ppt、wps、text、rtf 文件轉成 pdf。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">支持音視頻、圖片、文檔在線預覽、下載、重命名、移動文件夾、刪除等操作，支持文件分類查看。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">後端 git 地址：<a href="https://gitee.com/lxinet/lfs">https://gitee.com/lxinet/lfs</a></p><p style="margin-left:0; margin-right:0">前端 git 地址：<a href="https://gitee.com/lxinet/lfs-vue">https://gitee.com/lxinet/lfs-vue</a></p><h3>用戶手冊</h3><h4><span><span><span><strong><strong><span><span><strong>新建文件夾</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>在文件管理頁面，點擊【新建文件夾】，就可以在當前文件夾下新建一個文件夾了，默認文件夾名稱為「新建文件夾」，默認會全選，可以重新修改名稱，按回車後，就完成文件夾創建。</span></span></p><p><img height="410" src="https://oscimg.oschina.net/oscnet/up-c2b3f32933b2aee1f5a2a41530b72072688.png" width="1000" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>移動文件</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>在文件管理頁面，可以選擇文件移動到其他文件夾下。</span></span></p><p><img height="296" src="https://oscimg.oschina.net/oscnet/up-763e729a202a6f69ed4bd39fbb417fccc12.png" width="1000" referrerpolicy="no-referrer"></p><p><img height="557" src="https://oscimg.oschina.net/oscnet/up-95bc25ea9a93be68472d24ae15914aad4e8.png" width="800" referrerpolicy="no-referrer"></p><p><span><span><span><strong><strong><span><span><strong>上傳文件</strong></span></span></strong></strong></span></span></span></p><p style="margin-left:0.0000pt; text-align:left"><span><span>文件可以在線上傳，上傳使用分片上傳方式，如果上傳重複文件，可以直接秒傳，秒傳是根據文件 md5 進行判斷。</span></span></p><p style="margin-left:0.0000pt; text-align:left"><span><span>在文件管理頁面，點擊【上傳文件】按鈕，就會彈出上傳文件的彈窗。</span></span></p><p><img height="392" src="https://oscimg.oschina.net/oscnet/up-b1b95439cb7e590d099a5626dd333b55ed8.png" width="1000" referrerpolicy="no-referrer"></p><p style="margin-left:0.0000pt; text-align:left"><span><span>可以拖拽文件到窗口或者點擊窗口選擇文件進行文件上傳，上傳過程中可以實時查看上傳進度。</span></span></p><p><img height="328" src="https://oscimg.oschina.net/oscnet/up-4d03637e43333c483745a6bda7949f31e9c.png" width="800" referrerpolicy="no-referrer"></p><p style="margin-left:0.0000pt; text-align:left"><span><span>上傳完成後，可以點擊右邊的【查看】按鈕，查看上傳文件的詳情頁。</span></span></p><p><img height="408" src="https://oscimg.oschina.net/oscnet/up-e5f7f164b6693ea630dd10025281d5d884a.png" width="800" referrerpolicy="no-referrer"></p><p style="margin-left:0.0000pt; text-align:left"><span><span>文件上傳完成後，會自動發起轉碼，文檔會轉成 pdf 文件，視頻會根據轉碼配置進行轉碼。</span></span></p><p><img height="548" src="https://oscimg.oschina.net/oscnet/up-d3670b909e8bf7cb300fb92d2adbe75113e.png" width="800" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>文檔預覽</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:.0001pt; margin-right:0; text-align:justify"><span><span><span><span>文檔上傳後，會自動轉成 pdf 文件，可以在線預覽，可以在文件詳情頁面，點擊【轉碼預覽】按鈕，就可以在線查看 pdf 文件內容。</span></span></span></span></p><p><img height="408" src="https://oscimg.oschina.net/oscnet/up-6663a4d8ea70bb3e50b9226e10cb3e7ce1b.png" width="800" referrerpolicy="no-referrer"></p><p><img height="544" src="https://oscimg.oschina.net/oscnet/up-b77710abd5259fb82d771d86967baadb584.png" width="800" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>視頻預覽</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>視頻上傳完成後，會根據轉碼配置自動轉碼，在視頻詳情頁面，可以查看原文件和轉碼文件。</span></span></p><p style="margin-left:0.0000pt; text-align:left"><span><span>點擊【原文件預覽】按鈕，就可以預覽原文件。</span></span></p><p><img height="550" src="https://oscimg.oschina.net/oscnet/up-1eff3c6f2c87c03f6bc4450d924c56f92af.png" width="800" referrerpolicy="no-referrer"></p><p><img height="459" src="https://oscimg.oschina.net/oscnet/up-b98261e3eae1c1dd2c45a63405e468ff7fb.png" width="800" referrerpolicy="no-referrer"></p><p style="margin-left:0.0000pt; text-align:left"><span><span>點擊底下的轉碼列表右邊的預覽，就可以查看當前轉碼後的文件的視頻。</span></span></p><p><img height="550" src="https://oscimg.oschina.net/oscnet/up-99363b6fa8481c02cce2d5fe09746dfa04f.png" width="800" referrerpolicy="no-referrer"></p><p><img height="458" src="https://oscimg.oschina.net/oscnet/up-1f84b96d6f44b3d7888a9c29653e46ea724.png" width="800" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>轉碼配置</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>轉碼配置是針對視頻文件轉碼進行配置的，視頻上傳後會根據開啓的轉碼配置進行轉碼，可以在轉碼配置頁面進行添加、修改、刪除、開啓/關閉轉碼。</span></span></p><p><img height="276" src="https://oscimg.oschina.net/oscnet/up-18eb5e1ff93eeb21af5d29681f50c9a3617.png" width="1000" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>新增轉碼配置</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>點擊【新增】按鈕，系統會彈出新增轉碼配置界面，填寫信息後點擊【保存】按鈕，即可添加新的轉碼配置。</span></span></p><p><img height="427" src="https://oscimg.oschina.net/oscnet/up-198b9db6daa3e4fefbf83f6ead771593cef.png" width="1000" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>修改轉碼</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>在轉碼配置管理頁面，點擊每個轉碼配置右邊的編輯，即可進入編輯頁面，修改內容完成後，點擊【保存】按鈕，即可完成修改。</span></span></p><p><img height="395" src="https://oscimg.oschina.net/oscnet/up-7c98b434dc65e950917e3cd72c21f9d874f.png" width="1000" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>刪除轉碼配置</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>在轉碼配置管理頁面，點擊每個轉碼配置右邊的刪除，點擊確定後，就可以刪除指定的轉碼配置。</span></span></p><p><img height="409" src="https://oscimg.oschina.net/oscnet/up-9e208823da14305cba5884021bef4c361c3.png" width="1000" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>開啓轉碼配置</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>在轉碼配置管理頁面，點擊每個轉碼配置狀態，就可以切換開啓</span></span><span><span>/</span></span><span><span>關閉轉碼配置。</span></span></p><p><img height="250" src="https://oscimg.oschina.net/oscnet/up-1d66d57bbe66c967a8a048e85ddab0faf35.png" width="1000" referrerpolicy="no-referrer"></p><h4><span><span><span><strong><strong><span><span><strong>轉碼進度</strong></span></span></strong></strong></span></span></span></h4><p style="margin-left:0.0000pt; text-align:left"><span><span>在轉碼進度頁面可以實時查看轉碼進度，也可以對文件進行重新轉碼。</span></span></p><p><img height="283" src="https://oscimg.oschina.net/oscnet/up-3a41b586d0e603478b03372628a91b3477e.png" width="1000" referrerpolicy="no-referrer"></p><p style="margin-left:0.0000pt; text-align:left"><span><span>點擊右邊的【重新轉碼】按鈕，就可以對文件重新轉碼。</span></span></p><p><img height="295" src="https://oscimg.oschina.net/oscnet/up-9879f4bfa8661840df0f33f7a28d679595f.png" width="1000" referrerpolicy="no-referrer"></p><h1>環境支持</h1><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">數據庫：mysql</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">緩存：redis</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">文件服務器：nginx</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">部署前需修改 application.yml 文件中的 mysql 和 redis 信息，需要部署 nginx 服務作為文件服務器，nginx 配置可查看 「本地存儲」 章節內容</p><h1>開發框架</h1><h2>後端</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">springboot3.x+mybatis+mybatis-plus</p><h2>前端</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">vue3+element-plus+vite</p><h1>系統配置</h1><h2>文件大小限制</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">默認支持 2G 文件上傳，如果需要調整，修改 application.yml 中的以下 2 個參數：</p><div><pre><span><span style="color:#93a1a1"><span style="color:#6f42c1">spring</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">servlet</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">multipart</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#單個文件最大限制</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">max-file-size</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span style="color:#032f62">2048MB</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#總上傳文件總大小</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">max-request-size</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span style="color:#032f62">2048MB</span></span></span></pre><div><h2>視頻水印</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">視頻水印只支持圖片水印，要開啓視頻水印，需要先將視頻水印圖片放在項目目錄下。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">水印文件固定路徑：/resources/static/watermark.png</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">可以開啓、關閉水印，可以設置水印位置，具體可以看以下水印的配置信息。</p><div><pre><span><span style="color:#93a1a1"><span style="color:#6f42c1">config</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">video</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#視頻水印，水印圖片固定在位置：/resources/static/watermark.png</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">watermark</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#開啓/關閉水印，true 開啓，false 關閉</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">enable</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#cb4b16"><span style="color:#005cc5">true</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#水印位置 TOP_LEFT 左上角，TOP_RIGHT 右上角，BOTTOM_LEFT 左下角，BOTTOM_RIGHT 右下角</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">location</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span style="color:#032f62">TOP_LEFT</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#x、y 為對應 4 個角的距離，不能為負數，負數可能會報錯</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">offset-x</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>100</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">offset-y</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>100</span></span></span></pre><div><h2>文檔水印</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">文檔水印只有在轉成 pdf 後才可以添加水印，文檔只能添加文字水印，可以配置當前時間。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">可以開啓、關閉水印，可以設置水印位置，具體可以看以下水印的配置信息。</p><div><pre><span><span style="color:#93a1a1"><span style="color:#6f42c1">config</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">document</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">watermark</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#開啓/關閉水印，true 開啓，false 關閉</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">enable</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#cb4b16"><span style="color:#005cc5">true</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#開啓水印加上當前時間</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">time-enable</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#cb4b16"><span style="color:#005cc5">true</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#時間格式，yyyy 年、MM 月、dd 日、HH 小時、mm 分鐘、ss 秒</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">time-format</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span style="color:#032f62">yyyy-MM-dd</span><span style="color:#032f62">HH🇲🇲ss</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#水印內容，如果開啓時間，會在內容後面加上時間</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">content</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span style="color:#032f62">凌夕文件管理系統</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#文字大小</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">font-size</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>12</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#行距</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">row-space</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>100</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#列距</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">col-space</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>150</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#透明度</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">alpha</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>0.1</span></span></span></pre><div><h2>文件存儲</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">文件存儲支持本地文件存儲和 minio 存儲（還未完善，如果有需要，可以繼續完善該功能），在 application.yml 中可以設置存儲類型</p><div><pre><span><span style="color:#93a1a1"><span>config</span></span><span>:</span></span><span><span style="color:#93a1a1">file-server</span><span>:</span></span><span><span style="color:#586e75">#文件服務，<span style="color:#d73a49">local</span>/minio，<span style="color:#d73a49">local</span>本地文件服務，minio minio 服務</span></span><span><span style="color:#93a1a1"><span>type</span></span><span>:</span><span style="color:#2aa198"><span style="color:#d73a49">local</span></span></span></pre><div><h3>本地存儲</h3><h4>存儲目錄和訪問配置</h4><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">本地存儲需要配置本地存儲文件路徑（絕對路徑）和本地文件預覽地址，需要使用 nginx 配置 file-dir 的訪問服務，preview-url 為 nginx 配置的域名和端口。</p><div><pre><span><span style="color:#93a1a1"><span style="color:#005cc5">config</span></span><span>:</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">file-server</span></span><span>:</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">local</span></span><span>:</span></span><span><span style="color:#586e75">#本地文件上傳路徑</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">file-dir</span></span><span>:</span><span style="color:#2aa198">/Users/zcx/develop/lfs/uploadFile</span></span><span><span style="color:#586e75">#本地文件預覽地址</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">preview-url</span></span><span>:</span><span style="color:#2aa198"><span style="color:#005cc5">http</span>:<span style="color:#6a737d">//127.0.0.1:8918</span></span></span></pre><div><h4>nginx 配置</h4><div><pre><span><span style="color:#859900"><span style="color:#22863a">server</span></span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">listen</span></span><span style="color:#2aa198"><span>8918</span></span><span style="color:#93a1a1">;</span></span><span><span style="color:#859900"><span style="color:#005cc5">server_name</span></span><span style="color:#2aa198">localhost</span><span style="color:#93a1a1">;</span></span><span><span style="color:#859900"><span style="color:#005cc5">location</span></span><span style="color:#93a1a1"><span>~</span></span><span></span><span style="color:#dc322f"><span>.*\\.ts</span></span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">root</span></span><span style="color:#93a1a1">/Users/zcx/develop/lfs/uploadFile</span><span style="color:#93a1a1">;</span></span><span><span style="color:#93a1a1">}</span></span><span><span style="color:#859900"><span style="color:#005cc5">location</span></span><span style="color:#93a1a1"><span>~</span></span><span></span><span style="color:#dc322f"><span>.*/thum/.*</span></span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">root</span></span><span style="color:#93a1a1">/Users/zcx/develop/lfs/uploadFile</span><span style="color:#93a1a1">;</span></span><span><span style="color:#93a1a1">}</span></span><span><span style="color:#859900"><span style="color:#005cc5">location</span></span><span style="color:#93a1a1">/</span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">root</span></span><span style="color:#93a1a1">/Users/zcx/develop/lfs/uploadFile</span><span style="color:#93a1a1">;</span></span><span><span style="color:#859900"><span style="color:#005cc5">index</span></span><span style="color:#2aa198">index.html</span><span style="color:#2aa198">index.htm</span><span style="color:#93a1a1">;</span></span><span></span><span><span style="color:#859900"><span style="color:#005cc5">if</span></span><span style="color:#2aa198">(</span><span style="color:#268bd2"><span style="color:#032f62">$arg_oper</span></span><span style="color:#93a1a1">=</span><span style="color:#2aa198"><span style="color:#032f62">"down"</span>)</span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">add_header</span></span><span style="color:#2aa198">Content-Disposition</span><span style="color:#2aa198"><span style="color:#032f62">"attachment</span></span><span style="color:#93a1a1"><span style="color:#032f62">;</span></span><span style="color:#859900"><span style="color:#032f62">filename=</span></span><span style="color:#268bd2"><span style="color:#032f62"><span style="color:#032f62">$arg_filename</span></span></span><span style="color:#2aa198"><span style="color:#032f62">"</span></span><span style="color:#93a1a1">;</span></span><span><span style="color:#93a1a1">}</span></span><span><span style="color:#859900"><span style="color:#005cc5">secure_link</span></span><span style="color:#268bd2"><span style="color:#032f62">$arg_secret</span></span><span style="color:#2aa198">,</span><span style="color:#268bd2"><span style="color:#032f62">$arg_expire</span></span><span style="color:#93a1a1">;</span></span><span><span style="color:#859900"><span style="color:#005cc5">secure_link_md5</span></span><span style="color:#2aa198">e9eaa184ac1b4068829edb4f3ea978f4</span><span style="color:#268bd2"><span style="color:#032f62">$uri</span><span style="color:#032f62">$arg_expire</span></span><span style="color:#93a1a1">;</span></span><span><span style="color:#859900"><span style="color:#005cc5">if</span></span><span style="color:#2aa198">(</span><span style="color:#268bd2"><span style="color:#032f62">$secure_link</span></span><span style="color:#93a1a1">=</span><span style="color:#2aa198"><span style="color:#032f62">""</span>)</span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">return</span></span><span style="color:#2aa198"><span>403</span></span><span style="color:#93a1a1">;</span></span><span><span style="color:#93a1a1">}</span></span><span><span style="color:#859900"><span style="color:#005cc5">if</span></span><span style="color:#2aa198">(</span><span style="color:#268bd2"><span style="color:#032f62">$secure_link</span></span><span style="color:#93a1a1">=</span><span style="color:#2aa198"><span style="color:#032f62">"0"</span>)</span><span style="color:#93a1a1">{</span></span><span><span style="color:#859900"><span style="color:#005cc5">return</span></span><span style="color:#2aa198"><span>403</span></span><span style="color:#93a1a1">;</span></span><span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h4>防盜鏈配置</h4><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">防盜鏈需要配置密鑰和有效期時間，需要 nginx 配置配合，nginx 配置可以查看上節 nginx 配置，配置的密鑰需要和 nginx 中的密鑰一致。</p><div><pre><span><span style="color:#93a1a1"><span style="color:#6f42c1">config</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">file-server</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">local</span></span><span><span style="color:#6f42c1">:</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d">#密鑰</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">secret</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span style="color:#032f62">e9eaa184ac1b4068829edb4f3ea978f4</span></span></span><span><span style="color:#586e75"><span style="color:#6a737d"># 防盜鏈 st 有效時長（秒）</span></span></span><span><span style="color:#93a1a1"><span style="color:#6f42c1">st-effective-time</span></span><span><span style="color:#6f42c1">:</span></span><span style="color:#2aa198"><span>86400</span></span></span></pre><div><h3>minio 存儲（未完善）</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">需要配置 minio 服務相關信息，如下：</p><div><pre><span><span style="color:#93a1a1"><span style="color:#005cc5">config</span></span><span>:</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">file-server</span></span><span>:</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">minio</span></span><span>:</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">access-key</span></span><span>:</span><span style="color:#2aa198">HgiCBQslp8LDfNyWuTOj</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">secret-key</span></span><span>:</span><span style="color:#2aa198"><span>65</span>Quqe4SR881xrs9je9A4vjRNtoWmkYvtT78mL9b</span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">url</span></span><span>:</span><span style="color:#2aa198"><span style="color:#005cc5">http</span>:<span style="color:#6a737d">//127.0.0.1:9000</span></span></span><span><span style="color:#93a1a1"><span style="color:#005cc5">bucket-name</span></span><span>:</span><span style="color:#2aa198">test</span></span></pre><div><h1>文件上傳</h1><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">目前未限制文件上傳格式，如果有需要，可以增加限制。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">每個上傳 ID 只能上傳一個文件，如果上傳多個文件用同一個上傳 ID，會導致上傳失敗。</p><h2>本地文件存儲</h2><ul><li>原文件：{config.file-server.local.file-dir}/files/{uuid + 後綴}</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">如：/Users/zcx/develop/lfs/uploadFile/files/0cc01a75-399a-446c-8b26-902e95178856.mp4</p><ul><li>視頻轉碼文件：{config.file-server.local.file-dir}/trans/video/{uuid + 後綴}</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">如：/Users/zcx/develop/lfs/uploadFile/trans/video/8ab4b994-a4a8-42f6-8b1d-55e6abbb123c.mp4</p><ul><li>文檔轉碼文件：{config.file-server.local.file-dir}/trans/document/{uuid + 後綴}</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">如：/Users/zcx/develop/lfs/uploadFile/trans/document/8ab4b994-a4a8-42f6-8b1d-55e6abbb123c.mp4</p><ul><li>視頻 hls 文件：</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">{config.file-server.local.file-dir}/trans/hls/uuid/video.m3u8</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">{config.file-server.local.file-dir}/trans/hls/uuid/video_{分片編號}.ts</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">如：/Users/zcx/develop/lfs/uploadFile/trans/hls/65498aa0-5b0e-4959-9127-fc1f57cc98d4/video.m3u8</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">/Users/zcx/develop/lfs/uploadFile/trans/hls/65498aa0-5b0e-4959-9127-fc1f57cc98d4/video_0.ts</p><blockquote><p style="margin-left:0; margin-right:0; text-align:left">注：一個視頻 hls 文件會有 m3u8 和 ts 兩種文件格式，m3u8 文件一個，ts 文件若干個，每個 ts 文件有 10 秒視頻，ts 文件編號從 0 開始</p></blockquote><ul><li>視頻封面文件：{config.file-server.local.file-dir}/thum/ 原文件 md5 值 / 截取圖片所在秒數.jpg</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">如：/Users/zcx/develop/lfs/uploadFile/thum/db94fba515e9c0dc7cb20dbf06bc410c/1.jpg</p><h2>文件分片上傳流程</h2><h3>正常流程</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left"><img alt="" src="https://gitee.com/lxinet/lfs/raw/master/imgs/upload_file_flow.jpeg" referrerpolicy="no-referrer"></p><h3>秒傳</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left"><img alt="" src="https://gitee.com/lxinet/lfs/raw/master/imgs/fast_upload_file_flow.jpeg" referrerpolicy="no-referrer"></p><h1>接口</h1><h2>獲取 token</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/getToken</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>appId：YbcKSAlou6UREvkwJmTx</li><li>appSecret：95NmdotNX939f4gk7vTd3cHkMd8LhBcSzPn50G8c</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span style="color:#032f62">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiIiLCJpYXQiOjE3MDY1MDgwOTYsImV4cCI6MTcwNjUyMjQ5NiwiYXBwSWQiOiJMZ2lDQlFzbHA4TERmTnlXdWpNbyJ9.2sAq09kEpV7teYwqIa6CxRwzAQSVrv2TeMYy5A9NS_8"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>上傳初始化（秒傳）</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/uploadInit</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>dirId：文件夾 id</li><li>fileName：文件名</li><li>md5：文件 md5</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><ul><li>正常上傳：</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"upload"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//上傳 id，秒傳時，不返回上傳 id</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"uploadId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"a0dacab1-7a04-4c5c-b751-46cea30ee974"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//是否跳過上傳，如果為</span></span><span style="color:#cb4b16"><span style="color:#6a737d">true</span></span><span><span style="color:#6a737d">，説明秒傳，不需要再調用上傳文件接口，並且會返回文件 id（fileId），如果為</span></span><span style="color:#cb4b16"><span style="color:#6a737d">false</span></span><span><span style="color:#6a737d">，走正常上傳流程</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"skip"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#cb4b16"><span style="color:#005cc5">false</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//文件 id</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">},</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//服務當前使用的上傳服務，local 本地文件服務，minio</span></span><span style="color:#93a1a1"><span style="color:#6a737d"></span></span><span><span style="color:#6a737d">minio 服務</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileServerType"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"local"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><ul><li>秒傳：</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"upload"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//上傳 id，秒傳時，不返回上傳 id</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"uploadId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">""</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//是否跳過上傳，如果為</span></span><span style="color:#cb4b16"><span style="color:#6a737d">true</span></span><span><span style="color:#6a737d">，説明秒傳，不需要再調用上傳文件接口，並且會返回文件 id（fileId），如果為</span></span><span style="color:#cb4b16"><span style="color:#6a737d">false</span></span><span><span style="color:#6a737d">，走正常上傳流程</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"skip"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#cb4b16"><span style="color:#005cc5">true</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span><span style="color:#6a737d">//文件 id</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1747524994864275458</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">},</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileServerType"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"local"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>上傳文件 / 分片</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/upload</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>file: 文件</li><li>chunkNumber: 當前分片編號</li><li>chunkTotal: 總分片數</li><li>fileName: 文件名</li><li>uploadId: 上傳 id，初始化接口獲取到的上傳 id</li><li>dirId：文件夾 id</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><ul><li>上傳分片</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span style="color:#032f62">"分片上傳完成"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span>0</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><ul><li>合併完成</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span style="color:#032f62">"合併完成"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#2aa198"><span style="color:#032f62">"1745604715384700930"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>創建文件夾</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/dirAdd</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>dirId：上級文件夾 id</li><li>name：文件夾名稱</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>文件 / 文件夾重命名</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/rename</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>id：文件 id</li><li>name：文件 / 文件夾新名字</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>獲取文件列表（分頁）</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/list</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：GET</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>dirId：所在文件夾 id</li><li>pageNo：當前第幾頁，默認 1</li><li>pageSize：每頁數量，默認 10</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"records"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">[</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1750762969215533058"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"name"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"新建文件夾"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"isDir"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"dirId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"0"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileSize"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"0"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"duration"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"0"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"transStatus"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"createTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"2024-01-26 06:09:54"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"thumUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">""</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileType"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">},</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1747889182539296769"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"name"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"6c26d76632e5b05779e3f2bc91e8aedf.m4v"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"isDir"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"dirId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"0"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileSize"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"60221473"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"suffix"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">".m4v"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"md5"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"a67c7577e464acf66a802a2dddf2ee39"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"duration"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"31"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"transStatus"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"createTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"2024-01-18 07:50:29"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/files/515f4fa8-0f1e-47b3-9f04-b922c9ab0371.m4v"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileTransUrls"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">[</span></span><span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/trans/hls/a62aaf96-07d4-42fd-b5e2-bc86cc61e73d/video.m3u8"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">],</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"thumUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/thum/a67c7577e464acf66a802a2dddf2ee39/1.jpg"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1"></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">],</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"total"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"32"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"size"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"10"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"current"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"pages"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"4"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">參數説明：</p><ul><li>id：文件 ID</li><li>name：文件名</li><li>isDir：是否文件名，0 是文件，1 是文件夾</li><li>dirId：所在文件夾 id</li><li>fileSize：文件大小（B）</li><li>suffix：文件後綴</li><li>md5：文件 md5</li><li>duration：視頻為時長（秒），文檔為轉 pdf 後的頁數，其他文件為 0</li><li>transStatus：轉碼狀態，0 正在轉碼，1 轉碼成功，2 部分轉碼成功，3 轉碼失敗，4 不需要轉碼，5 不支持轉碼，6 取消轉碼</li><li>createTime：上傳時間，格式：yyyy-MM-dd HH🇲🇲ss</li><li>fileUrl：原文件地址</li><li>fileTransUrls：轉碼後的文件列表（根據開啓的轉碼模板數量而定）</li><li>thumUrl：文件封面地址</li></ul><h2>獲取文件詳情</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/detail/</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：GET</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1759776044321124353"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"name"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"文件管理系統.pptx"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"isDir"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"dirId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"0"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileSize"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"2659028"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"suffix"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">".pptx"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"md5"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"269059d792de04d14ce3354d76b9d617"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"duration"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"25"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"transStatus"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"createTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"2024-02-20 03:04:38"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"previewUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/trans/document/39f8d3fa-fcea-4a1b-aefc-f916eca0d559.pdf?st=gy7dPuGlh2Io4mIQ-eCPQQ&amp;e=1709703848"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"progressList"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">[</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1759776044639891458"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileTransId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1759776224541978625"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"progress"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>100.0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"format"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"pdf"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"transStatus"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"startTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1708398278757"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"endTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1708398321706"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"previewUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/trans/document/39f8d3fa-fcea-4a1b-aefc-f916eca0d559.pdf?st=gy7dPuGlh2Io4mIQ-eCPQQ&amp;e=1709703848"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileSize"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"34518359"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">],</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"thumUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/thum/269059d792de04d14ce3354d76b9d617/1.jpg?st=esCMdzh-HZeqA29W1fFUIA&amp;e=1709703848"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileType"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>3</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"pdfWatermark"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"凌夕文件管理系統 2024-03-06 13:39:08"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">參數説明：</p><ul><li>id：文件 ID</li><li>name：文件名</li><li>isDir：是否文件夾，0 不是，1 是文件夾</li><li>dirId：文件所在文件夾 id，最上層目錄，為 0</li><li>fileSize：文件大小（B）</li><li>suffix：文件後綴</li><li>md5：文件 md5</li><li>duration：視頻為時長（秒），文檔為轉 pdf 後的頁數，其他文件為 0</li><li>transStatus：轉碼狀態，0 正在轉碼，1 轉碼成功，2 部分轉碼成功，3 轉碼失敗，4 不需要轉碼，5 不支持轉碼，6 取消轉碼</li><li>createTime：上傳時間，格式：yyyy-MM-dd HH🇲🇲ss</li><li>thumUrl：文件封面地址</li><li>fileType：文件大的類型，1 為視頻，2 為文檔</li><li>previewUrl：文件預覽地址</li><li>pdfWatermark：pdf 文件預覽的水印內容，用 element-plus 實現頁面水印</li><li>progressList：轉碼進度列表，轉碼中和部分轉碼成功才會有該值，其他情況不會有該值，如果是視頻，可能會多個進度，文檔就一個進度，如果多個進度，當前轉碼進度需要取平均值 
                                      <ul><li>id：轉碼進度 id</li><li>fileTransId：轉碼後文件 id</li><li>progress：轉碼進度</li><li>format：轉碼格式</li><li>transStatus：轉碼狀態，0 正在轉碼，1 轉碼成功，2 部分轉碼成功，3 轉碼失敗，4 不需要轉碼，5 不支持轉碼，6 取消轉碼</li><li>startTime：開始轉碼時間（時間戳，毫秒）</li><li>endTime：結束轉碼時間（時間戳，毫秒）</li><li>previewUrl：轉碼後的文件預覽地址</li><li>fileSize：轉碼後的文件大小（B）</li></ul></li></ul><h2>刪除文件 / 文件夾</h2><blockquote><p style="margin-left:0; margin-right:0; text-align:left">如果刪除文件夾，文件夾下的文件和文件夾都會被刪除</p></blockquote><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/delete</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：GET</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>id：文件 / 文件夾 id</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>獲取轉碼模板列表</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/transTemplate/list</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：GET</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：無</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">[</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1746778020070301697</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"name"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"普清"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"status"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"width"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"height"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1080</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"format"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"m3u8"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"frameRate"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>20</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"bitRate"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>2000</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"codec"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"h264"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"audioCodec"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"aac"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"audioChannel"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>2</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"audioBitRate"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>112</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"audioSampleRate"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>8000</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"createTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"2024-01-15 06:15:08"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">]</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">參數説明：</p><ul><li>id：模板 ID</li><li>name：模板名稱</li><li>status：狀態，是否開啓轉碼，0 關閉，1 開啓</li><li>width：分辨率（寬）</li><li>height：分辨率（高）</li><li>format：轉碼輸出格式</li><li>frameRate：視頻幀率</li><li>codec：視頻編解碼器</li><li>bitRate：視頻比特率（碼率）</li><li>audioBitRate：音頻比特率（碼率）</li><li>audioSampleRate：音頻採樣率</li><li>audioChannel：音頻聲道</li><li>audioCodec：音頻編解碼器</li></ul><h2>新增 / 更新轉碼模板</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/transTemplate/save</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>id：模板 ID，新增時不要傳該參數，是否有 id 參數是區分新增、更新操作</li><li>name：模板名稱</li><li>width：分辨率（寬），如：1920</li><li>height：分辨率（高），如：1080</li><li>format：轉碼輸出格式，可選：mp4、m3u8</li><li>frameRate：視頻幀率，可選：15、20、25、30、40、50、60</li><li>codec：視頻編解碼器，可選：H264</li><li>bitRate：視頻比特率（碼率），可選：500、800、1200、2000、3000、5000、8000</li><li>audioBitRate：音頻比特率（碼率），可選：16、32、48、64、80、96、112、128、160、192、224、256、320、384、448、512</li><li>audioSampleRate：音頻採樣率，可選：8000、11025、12000、16000、22050、24000、32000、44100、48000、64000、88200、96000</li><li>audioChannel：音頻聲道，可選：1、2</li><li>audioCodec：音頻編解碼器，可選：aac</li><li>waterMarkId：水印模板 id</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>關閉 / 開啓轉碼模板</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/transTemplate/updateStatus</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>id：模板 ID，新增時不要傳該參數，是否有 id 參數是區分新增、更新操作</li><li>status：狀態，是否開啓轉碼，0 關閉，1 開啓</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><ul><li>成功</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><ul><li>失敗</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1007</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"視頻轉碼模板不存在"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>刪除轉碼模板</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/transTemplate/delete</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>id：模板 ID</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><ul><li>成功</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>文件上傳成功後縮略圖列表</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">文件上傳後，如果馬上調用該接口，可能返回的列表是空的，因為生成縮略圖需要時間，可能需要幾秒鐘，所以在顯示縮略圖列表選擇頁面，如果獲取到的數據是空的，最好重試幾次，直到獲取到數據、或者超時給用戶提示。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/thumList</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：GET</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>md5：文件 md5</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><ul><li>成功</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">[</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1747079912013021186</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileUrl"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"http://127.0.0.1:8918/thum/db94fba515e9c0dc7cb20dbf06bc410c/1.jpg"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"duration"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">]</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>更新文件縮略圖</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/updateFileThum</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>fileId：文件 id</li><li>thumId：縮略圖 id</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>手動轉碼</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/file/manualTranscode</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：POST</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>fileId：文件 id</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><ul><li>成功</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><ul><li>失敗</li></ul><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1012</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"該文件不支持轉碼"</span></span></span><span><span style="color:#93a1a1">}</span></span></pre><div><h2>轉碼列表</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">地址：/transProgress/list</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求方式：GET</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">header 參數：token</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">請求參數：</p><ul><li>pageNo：當前第幾頁，默認 1</li><li>pageSize：每頁數量，默認 10</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">響應數據：</p><div><pre><span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"code"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"msg"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"操作成功"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"data"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"records"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#93a1a1">[</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">{</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"id"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1749360770384216065"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1749360770249998339"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileTransId"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1749360775123779586"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"progress"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>100.0</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"format"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"pdf"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"transStatus"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span>1</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"startTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1705915083869"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"endTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1705915085036"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"fileName"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"常用軟件.xlsx"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"createTime"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"2024-01-22 09:18:03"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1"></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">],</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"total"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"26"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"size"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"10"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"current"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"1"</span></span><span style="color:#93a1a1">,</span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1"><span style="color:#6f42c1">"pages"</span></span><span style="color:#93a1a1">:</span><span style="color:#93a1a1"></span><span style="color:#2aa198"><span style="color:#032f62">"3"</span></span></span><span><span style="color:#93a1a1"></span><span style="color:#93a1a1">}</span></span><span><span style="color:#93a1a1">}</span></span></pre><div><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">參數説明：</p><ul><li>id：轉碼 ID</li><li>fileId：文件 id</li><li>fileName：文件名</li><li>fileTransId：轉碼後的文件 id</li><li>progress：轉碼進度，0-100</li><li>format：轉碼輸出格式</li><li>transStatus：轉碼狀態，0 正在轉碼，1 轉碼成功，3 轉碼失敗</li><li>startTime：開始轉碼時間（時間戳）</li><li>endTime：完成轉碼時間（時間戳），進行中為 0，如要計算進行中轉碼時長，使用當前時間進行計算</li><li>createTime：創建轉碼時間，創建轉碼時，不一定馬上開始轉碼了，開始轉碼時間要看 startTime</li></ul><h1>轉碼配置</h1><h2>模板名稱</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">設置模板名稱 name</p><h2>視頻</h2><h3>分辨率</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">分辨率可以設置寬和高，寬和高至少設置 1 個，另一個可以設置，也可以設置為 0，如果設置為 0，自動根據原視頻寬高計算。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">分辨率設置的是 PAR（圖像縱橫比），默認未指定 sar 或者 dar 時，dar 不會變，sar 會被設置為跟 par 比例一樣，所以轉碼的視頻比例也不會變，寬度根據高度自動計算，即指定的寬度無效。</p><ul><li>PAR 圖像縱橫比：PAR=（每行像素數）/（每列像素數）= 分辨率</li><li>SAR 樣點縱橫比：SAR=（像素的寬）/（像素的高）。像素不一定都是正方形的。</li><li>DAR 顯示縱橫比：一般説的 16:9 和 4:3 指的是 DAR。DAR=（每行像素數像素的寬）/（每列像素數像素的高），即 DAR=PAR*SAR</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">480p = 標清 = 640x480</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">720p = 高清 = 1280×720p</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">1080p = 藍光 = 1920x1080p</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">2K=1440P=2560x1440</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">4K=2160P=3840x2160</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">8K=4320P= 7680×4320</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">高度默認：1080</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">寬度默認：0（自動計算）</p><h3>轉碼格式</h3><ul><li>選項：mp4、m3u8</li><li>默認：mp4</li></ul><h3>視頻幀率</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">視頻幀率是用於測量顯示幀數的量度。所謂的測量單位為每秒顯示幀數 (Frames per Second, 簡：FPS) 或 "赫茲"(Hz)</p><ul><li>選項：15、20、25、30、40、50、60</li><li>默認：30</li></ul><h3>視頻比特率（碼率 kbps）</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">通常也叫碼率是指單位時間內傳送的比特 (bit) 數，單位為 bps (bit per second）</p><ul><li>選項：500、800、1200、2000、3000、5000、8000</li><li>默認：1200</li></ul><h3>編解碼器</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">H264 通常也被稱之為 H264/AVC（或者 H.264/MPEG-4 AVC 或 MPEG-4/H.264 AVC），H264 有高效的視頻壓縮算法來壓縮視頻的佔用空間，提高存儲和傳輸的效率，在獲得有效的壓縮效果的同時，使得壓縮過程引起的失真最小。H264 是目前較為主流的編碼標準。</p><ul><li>選項：h264</li><li>默認：h264</li></ul><h3>封面截圖</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">每個 md5 的視頻文件，會截取 10 張封面用來選擇，截圖規則是分別取第 1、3、5、7 秒、視頻時長 / 2 秒、視頻時長 / 2 + 2 秒、倒數第 7、5、3、1 秒的畫面。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">截圖格式為 jpg 圖片。</p><h2>音頻</h2><h3>編解碼器</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">目前音頻基本都用 AAC 編碼，因為這個編碼目前來説壓縮率高，而且音質損失極底。</p><ul><li>選項：aac</li><li>默認：aac</li></ul><h3>聲道</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">單聲道：是指一個聲音的通道，把來自不同方位的音頻信號混合後統一由錄音器材把它記錄下來，再由一個揚聲器進行重放（沒有左右聲道之分）。早期的收音機都是單聲道的，耳機就一個耳朵。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">雙聲道：是指有兩個聲音的通道，雙聲道是在空間放置兩個互成一定角度的揚聲器，每個揚聲器單獨由一個聲道提供信號。雙聲道是二路輸入，二路輸出，但不一定是立體聲。（左右聲道都只有一路的信號輸入），也稱為雙聲道混和聲。</p><ul><li>選項：1、2</li><li>默認：2</li></ul><h3>音頻碼率（音頻比特率）</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">一般普通音質碼率大致在 80164kbps 左右，HQ 高音質 192320kbps 左右，SQ 無損 800~1500kbps 左右，CD 及其它無壓縮音質數值過萬甚至更高。</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">普通音質轉成無損音質，並不是成了無損音樂，反而體積增大了，這就是所謂假無損。</p><ul><li>選項：16、32、48、64、80、96、112、128、160、192、224、256、320、384、448、512</li><li>默認：128</li></ul><h3>音頻採樣率</h3><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">音頻採樣率是指錄音設備在一秒鐘內對聲音信號的採樣次數，它決定了數字音頻信號的分辨率。採樣率的單位通常是赫茲（Hz）。採樣率越高，理論上能夠捕捉到的聲音細節越多，從而產生的聲音質量也更高。</p><ul><li>選項：8000、11025、12000、16000、22050、24000、32000、44100、48000、64000、88200、96000</li><li>默認：48000</li><li>部分説明：</li></ul><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">8000 Hz：電話所用採樣率，對於人的説話已經足夠</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">11025 Hz：電話所用採樣率</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">22050 Hz：無線電廣播所用採樣率</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">32000 Hz：miniDV 數碼視頻 camcoRDer、DAT (LP mode) 所用採樣率</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">44100 Hz：音頻 CD, 也常用於 MPEG-1 音頻（VCD, SVCD, MP3）所用採樣率</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">48000 Hz：miniDV、數字電視、DVD、DAT、電影和專業音頻所用的數字聲音所用採樣率</p><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left">96000 Hz：DVD-Audio、一些 LPCM DVD 音軌、BD-ROM（藍光盤）音軌、和 HD-DVD （高清晰度 DVD）音軌所用所用採樣率</p><h1>轉碼</h1><h2>轉碼流程</h2><p style="color:#40485b; margin-left:0; margin-right:0; text-align:left"><img alt="" height="693" src="https://gitee.com/lxinet/lfs/raw/master/imgs/trans_flow.jpeg" width="500" referrerpolicy="no-referrer"></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 06:11:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282536</guid>
            <link>https://www.oschina.net/news/282536</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[Docker 25.0.4 發佈]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p><span style="color:#333333">Docker 25.0.4 現已發佈，具體更新內容如下：</span></p><p style="text-align:start"><strong>Bug fixes and enhancements</strong></p><ul><li>恢復 Windows 上默認「nat」網絡中容器的 DNS 名稱。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47490" target="_blank">moby/moby#47490</a></li><li>修復使用<code>--checkpoint</code>時​​​​​​​<code>docker start</code>失敗的問題。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47466" target="_blank">moby/moby#47466</a></li><li>不要對現有的 swarm networks 強制執行新的驗證規則。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47482" target="_blank">moby/moby#47482</a></li><li>恢復內部橋接網絡上主機和容器之間的 IP 連接。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47481" target="_blank">moby/moby#47481</a></li><li>修復 v25.0 中引入的迴歸，該回歸阻止 classic builder 添加在非 Linux 操作系統上創建的帶有 xattrs 的 tar 壓縮包。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47483" target="_blank">moby/moby#47483</a></li><li>containerd <span style="background-color:#ffffff; color:#1f2328">image store</span>：修復鏡像拉取不發出<code>Pulling fs layer</code>狀態的問題。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47484" target="_blank">moby/moby#47484</a></li></ul><p style="text-align:start"><strong>API</strong></p><p style="text-align:start">&nbsp;</p><ul><li>為了保持向後兼容性，在使用較舊的客戶端（API 版本 &lt; v1.44）時，默認情況下使只讀掛載不遞歸。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47393" target="_blank">moby/moby#47393</a></li><li>如果圖像配置中缺少<code>Created</code>字段，<code>GET /images/{id}/json</code>會忽略該<code>Created</code>字段（以前是<code>0001-01-01T00:00:00Z</code>） 。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47451" target="_blank">moby/moby#47451</a></li><li>對於 API 版本 &lt;= 1.43，在<code>GET /images/{id}/json</code>中使用填充<code>0001-01-01T00:00:00Z</code>缺失的<code>Created</code>字段。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47387" target="_blank">moby/moby#47387</a></li><li>修復了導致 API 套接字連接失敗時報告 API 版本協商失敗的迴歸。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47470" target="_blank">moby/moby#47470</a></li><li>當指定了容器範圍的 MAC 地址，但<code>NetworkMode</code><span style="background-color:#ffffff; color:#1f2328">name-or-id</span> 與<code>NetworkSettings.Networks</code>中使用的&nbsp;<span style="background-color:#ffffff; color:#1f2328">name-or-id&nbsp;不一致時，保留&nbsp;container-create API 請求中提供的端點配置。</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47510" target="_blank">moby/moby#47510</a></li></ul><p style="text-align:start"><strong>Packaging updates</strong></p><ul><li>將 Go 運行時升級到&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgo.dev%2Fdoc%2Fdevel%2Frelease%23go1.21.8" target="_blank">1.21.8</a>。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47503" target="_blank">&nbsp;moby/moby#47503</a></li><li>將 RootlessKit 升級到&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Frootless-containers%2Frootlesskit%2Freleases%2Ftag%2Fv2.0.2" target="_blank">v2.0.2</a>。&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Fpull%2F47508" target="_blank">&nbsp;moby/moby#47508</a></li><li>將 Compose 升級到&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdocker%2Fcompose%2Freleases%2Ftag%2Fv2.24.7" target="_blank">v2.24.7</a>。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdocker%2Fdocker-ce-packaging%2Fpull%2F998" target="_blank">docker/docker-ce-packaging#998</a></li><li>將 Buildx 升級到&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdocker%2Fbuildx%2Freleases%2Ftag%2Fv0.13.0" target="_blank">v0.13.0</a>。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fdocker%2Fdocker-ce-packaging%2Fpull%2F997" target="_blank">docker/docker-ce-packaging#997</a></li></ul><p>更新説明：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fmoby%2Fmoby%2Freleases%2Ftag%2Fv25.0.4" target="_blank">https://github.com/moby/moby/releases/tag/v25.0.4</a></p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 05:49:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282533/docker-25-0-4-released</guid>
            <link>https://www.oschina.net/news/282533/docker-25-0-4-released</link>
            <author>
                <![CDATA[來源: OSCHINA]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[基於 mybatis 的 orm：mybatis-mp 1.4.2 發佈 - 多數據源支持]]>
            </title>
            <description>
                <![CDATA[<div class="content"><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>1.4.2 更新：</strong><br><span style="background-color:#ffffff; color:#808080">1：增加 forUpdate no Wait 功能</span><br><span style="background-color:#ffffff; color:#808080">2：增加 Pager 靜態方法</span><br><span style="background-color:#ffffff; color:#808080">3：優化 sql 拼接</span><br><span style="background-color:#ffffff; color:#808080">4：增加動態/多數據源支持（可分組）</span></p><p>&nbsp;</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><strong>mybatis-mp 包含豐富的 api：</strong></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">1：基於註解，映射數據庫；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">2：支持多表 join 和返回；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">3：api 採用 lambda 和 stream 流式設計；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">4：select 自動化以及結果 1 對 1,1 對多，超級方便快捷；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">5：內置分頁以及超強的 sql 優化功能；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">6：穩定且性能極優；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">7：輕量級封裝 mybatis，幾乎沒有侵入；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">8：api 豐富，支持數據庫函數、多表、樂觀鎖、多租戶、邏輯刪除、默認值（可動態值） 等眾多功能；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">9：零學習成本，和寫 sql 一樣方便。</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">10：支持複雜的返回關係映射：例如一對一 ，一對多，多對多；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">11：支持自定義 sql 模板，再也不用擔心框架支持不足；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">12：內置代碼生成器，通過配置，可定製自身規範；</p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">13：全新的框架，全新的設計理念，新的就是好！</p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 05:19:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282527</guid>
            <link>https://www.oschina.net/news/282527</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
        <item>
            <title>
                <![CDATA[🔥🔥🔥 EasyRetry 3.1.0 發佈，Spring Boot3.x 時代已經開啓🎉🎉]]>
            </title>
            <description>
                <![CDATA[<div class="content"><h3><strong>🔥🔥🔥 靈活，可靠和快速的分佈式任務重試和分佈式任務調度平台</strong></h3><p><strong><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.yuque.com%2Ffendouxiaowoniu%2Fnuka7u%2Fue1btbpkosdn16c4" target="_blank"><span style="color:#e74c3c">一文讀懂 AizuDa/EasyRetr</span></a></strong></p><pre><span style="color:#cf8e6d"><span style="color:#6a737d"><span style="color:#6a737d">&gt;</span></span><span><span></span></span></span><span><span><span>✅️ </span></span></span><span><span><span>可重放，可管控、為提高分佈式業務系統一致性的分佈式任務重試平台 </span></span></span><span style="color:#6a737d"><span style="color:#6a737d"></span></span><span style="color:#cf8e6d"><span style="color:#6a737d"><span style="color:#6a737d">&gt;</span></span><span><span></span></span></span><span><span><span>✅️ </span></span></span><span><span><span>支持秒級、可中斷、可編排的高性能分佈式任務調度平台</span></span></span></pre><ul><li><strong>易用性</strong><span><span>&nbsp;</span></span>業務接入成本小。避免依賴研發人員的技術水平，保障穩定性</li><li><strong>靈活性</strong><span><span>&nbsp;</span></span>能夠動態調整配置，啓動 / 停止任務，以及終止運行中的任務</li><li><strong>操作簡單</strong><span><span>&nbsp;</span></span>分鐘上手，支持 WEB 頁面對任務數據 CRUD 操作。</li><li><strong>數據大盤</strong><span><span>&nbsp;</span></span>實時管控系統任務數據</li><li><strong>分佈式重試任務</strong><span><span>&nbsp;</span></span>支持多樣化退避策略、多樣化重試類型、流量管控等</li><li><strong>分佈式調度任務</strong><span><span>&nbsp;</span></span>提供豐富的任務觸發策略、任務編排、任務分片、停止恢復、失敗重試等</li><li><strong>任務數據管理</strong><span><span>&nbsp;</span></span>可以做到數據不丟失、數據一鍵回放</li><li><strong>容器化部署</strong><span><span>&nbsp;</span></span>服務端支持 docker 容器部署</li><li><strong>高性能調度平台</strong><span><span>&nbsp;</span></span>支持服務端節點動態擴容和縮容</li><li><strong>支持多樣化的告警方式</strong><span><span>&nbsp;</span></span>郵箱、企業微信、釘釘、飛書</li></ul><h2>設計思想</h2><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img src="https://www.easyretry.com/img/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E5%9B%BE-v2.4.0.png" referrerpolicy="no-referrer"><span>&nbsp;</span><img height="1353" src="https://oscimg.oschina.net/oscnet/up-0a0e46da4b4a4b74f5d89f2d9da4661a349.png" width="1852" referrerpolicy="no-referrer"><span>&nbsp;</span><img src="https://www.easyretry.com/img/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97-2.0.png" referrerpolicy="no-referrer"></p><h2>開源組件對比</h2><table cellspacing="0" style="-webkit-text-stroke-width:0px; background-color:#ffffff; border-collapse:collapse; border-spacing:1px; border:none; box-sizing:border-box; color:#00323c; display:inline-table; font-family:-apple-system,BlinkMacSystemFont,&quot;Apple Color Emoji&quot;,&quot;Segoe UI Emoji&quot;,&quot;Segoe UI Symbol&quot;,&quot;Segoe UI&quot;,&quot;PingFang SC&quot;,&quot;Hiragino Sans GB&quot;,&quot;Microsoft YaHei&quot;,&quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif; font-size:14px; font-style:normal; font-variant-caps:normal; font-variant-ligatures:normal; font-weight:400; letter-spacing:normal; line-height:inherit; margin:0px 0px 20px; max-width:100%; orphans:2; overflow:auto; text-align:left; text-decoration-color:initial; text-decoration-style:initial; text-decoration-thickness:initial; text-transform:none; white-space:normal; widows:2; width:776px; word-break:keep-all; word-spacing:0px"><tbody><tr><th style="text-align:inherit"><strong>項目</strong></th><th style="text-align:inherit"><strong>Quartz</strong></th><th style="text-align:inherit"><strong>Elastic-Job</strong></th><th style="text-align:inherit"><strong>XXL-JOB</strong></th><th style="text-align:inherit"><strong>Easy Retry</strong></th></tr></tbody><tbody><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">定時調度</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">Cron</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">Cron</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">Cron</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 定時任務 2. 秒級任務 (無需依賴外部中間件) 3. 固定頻率</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">重試任務</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 支持本地 &amp; 遠程重試模式 2. 支持各種常用組件的重試，比如 dubbo/feign 3. 支持多種退避策略 4. 豐富的重試風暴管控手段 ......</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">任務編排</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">可視化任務編排</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">分佈式計算</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">不支持</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">靜態分片</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">廣播</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 廣播執行 2. 集羣執行 3. 靜態分片</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">多語言</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">Java</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. Java 2. 腳本任務</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. Java 2. 腳本任務</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. Java 2. 腳本任務 3. HTTP 任務 4. Kettle</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">可視化</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">無</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">弱</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 歷史記錄 2. 運行日誌（不支持存儲）3. 監控大盤</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 歷史記錄 2. 運行日誌 (支持持久化) 3. 監控大盤 4. 操作記錄 5. 查看日誌堆棧</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">可運維</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">無</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">啓用、禁用任務</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 啓用、禁用任務 2. 手動運行任務 3. 停止任務</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 啓用、禁用任務 2. 手動運行任務 3. 停止任務</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">報警監控</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">無</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">郵件</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">郵件</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">1. 郵件 2. 釘釘 3. 企微 4. 飛書</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">性能</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">每次調度通過 DB 搶鎖，對 DB 壓力大</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">ZooKeeper 是性能瓶頸</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">採用 Master 節點調度，Master 節點壓力大</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">系統採用多 bucket 模式，藉助負載均衡算法，確保每個節點能夠均衡處理任務，同時支持無限水平擴展，輕鬆應對海量任務調度</td></tr><tr><td style="border-color:#dddddd; border-style:solid; border-width:1px">接入成本</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">只依賴 DB 接入成本低</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">需引入 Zookeeper 增加系統複雜性和維護成本</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">只依賴 DB 接入成本低</td><td style="border-color:#dddddd; border-style:solid; border-width:1px">只依賴 DB 接入成本低</td></tr></tbody></table><h2><strong>更新日誌</strong></h2><ol><li>SpringBoot 版本升級至【3.2.2】【<strong>新增</strong>】</li><li>工作流支持任務節點手動停止能力【<strong>新增</strong>】<a href="https://gitee.com/aizuda/easy-retry/issues/I93NJG" target="_blank">issues</a></li><li>工作流支持任務節點手動重試能力【<strong>新增</strong>】<a href="https://gitee.com/aizuda/easy-retry/issues/I93NJ8" target="_blank">issues</a></li><li>支持兩個同級方法重試【<strong>新增</strong>】<a href="https://gitee.com/aizuda/easy-retry/issues/I93NDG" target="_blank">issues</a></li><li>重試支持傳播機制【<strong>新增</strong>】<a href="https://gitee.com/aizuda/easy-retry/issues/I93N8O" target="_blank">issues</a></li><li>管理後台，所有清空按鈕無效，無法刪除歷史數據【<strong>BUG</strong>】<a href="https://gitee.com/aizuda/easy-retry/issues/I917H0" target="_blank">issues</a></li></ol><h2>項目地址</h2><p><strong><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.yuque.com%2Ffendouxiaowoniu%2Fnuka7u%2Fue1btbpkosdn16c4" target="_blank"><span style="color:#e74c3c">一文讀懂 AizuDa/EasyRetry</span></a></strong></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">官網:&nbsp;<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fwww.easyretry.com%2F" target="_blank">https://www.easyretry.com/</a></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">gitee:<a href="https://gitee.com/aizuda/easy-retry.git">https://gitee.com/aizuda/easy-retry.git</a></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left">github：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Faizuda%2Feasy-retry.git" target="_blank">https://github.com/aizuda/easy-retry.git</a></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><u><strong>方便的話給項目一個 star，你的支持是我們前進的動力！</strong></u></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="892" src="https://oscimg.oschina.net/oscnet/up-3a60153289977dbd60779cf10b9f71b4f01.png" width="1911" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="906" src="https://oscimg.oschina.net/oscnet/up-825456c64ad5e79eae06b6b61b421e79dda.png" width="1916" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="907" src="https://oscimg.oschina.net/oscnet/up-db255ba2623b42461a5f328341a2bc89eb8.png" width="1917" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="893" src="https://oscimg.oschina.net/oscnet/up-f10e56f97a6e5417f61bd2bc7a7d2a3a0ae.png" width="1909" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="888" src="https://oscimg.oschina.net/oscnet/up-def7290cfd656e5daa06991c7cdf06ac219.png" width="1678" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="851" src="https://oscimg.oschina.net/oscnet/up-9374238abd0e610a7c92f1f96bd6b03bc2a.png" width="1648" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="635" src="https://oscimg.oschina.net/oscnet/up-8782a31675acf0753f76906b8e8c5727a74.png" width="1622" referrerpolicy="no-referrer"></p><p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img height="899" src="https://oscimg.oschina.net/oscnet/up-37039ba0a34543ccb305b9f63ebbe3e7ddf.png" width="1908" referrerpolicy="no-referrer"></p></div>
                                    ]]>
            </description>
            <pubDate>Mon, 11 Mar 2024 04:38:00 GMT</pubDate>
            <guid isPermaLink="false">https://www.oschina.net/news/282522/easy-retry-3-1-0-released</guid>
            <link>https://www.oschina.net/news/282522/easy-retry-3-1-0-released</link>
            <author>
                <![CDATA[來源: 投稿]]>
            </author>
        </item>
    </channel>
</rss>
